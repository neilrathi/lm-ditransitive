INFO:root:Namespace(cuda=False, save='model.pt')
INFO:root:Loading data
INFO:root:Vocab file not found, creating new vocab file.
INFO:root:Namespace(cuda=False, save='model.pt')
INFO:root:Loading data
INFO:root:Namespace(cuda=False, save='model.pt')
INFO:root:Loading data
INFO:root:Vocab file not found, creating new vocab file.
INFO:root:Vocab size 135
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:Namespace(cuda=False, save='model.pt')
INFO:root:Loading data
INFO:root:Vocab size 135
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:Namespace(cuda=False, save='model.pt')
INFO:root:Loading data
INFO:root:Vocab size 135
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:Namespace(cuda=False, save='model.pt')
INFO:root:Loading data
INFO:root:Vocab size 135
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:Namespace(cuda=False, save='model.pt')
INFO:root:Loading data
INFO:root:Vocab size 135
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:Namespace(cuda=False, save='model.pt')
INFO:root:Loading data
INFO:root:Vocab size 135
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:Namespace(cuda=False, save='model.pt')
INFO:root:Loading data
INFO:root:Vocab size 135
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:Namespace(cuda=False, save='model.pt')
INFO:root:Loading data
INFO:root:Vocab size 135
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:Namespace(cuda=False, save='model.pt')
INFO:root:Loading data
INFO:root:Vocab size 135
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:Namespace(cuda=False, save='model.pt')
INFO:root:Loading data
INFO:root:Vocab size 135
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:Namespace(cuda=False, save='model.pt')
INFO:root:Loading data
INFO:root:Vocab size 135
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:Namespace(cuda=False, save='model.pt')
INFO:root:Loading data
INFO:root:Vocab size 135
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:Namespace(cuda=False, save='model.pt')
INFO:root:Loading data
INFO:root:Vocab size 135
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:| epoch   1 |   200/ 1520 batches | lr 20.00 | ms/batch  8.59 | loss  3.83
INFO:root:| epoch   1 |   400/ 1520 batches | lr 20.00 | ms/batch  7.36 | loss  1.50
INFO:root:| epoch   1 |   600/ 1520 batches | lr 20.00 | ms/batch  7.38 | loss  0.92
INFO:root:| epoch   1 |   800/ 1520 batches | lr 20.00 | ms/batch  9.06 | loss  0.91
INFO:root:| epoch   1 |  1000/ 1520 batches | lr 20.00 | ms/batch  8.65 | loss  0.93
INFO:root:| epoch   1 |  1200/ 1520 batches | lr 20.00 | ms/batch  7.37 | loss  0.84
INFO:root:| epoch   1 |  1400/ 1520 batches | lr 20.00 | ms/batch  7.97 | loss  0.80
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   1 | time: 12.49s | valid loss  2.07 | valid ppl     7.92
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   2 |   200/ 1520 batches | lr 20.00 | ms/batch  7.77 | loss  0.81
INFO:root:| epoch   2 |   400/ 1520 batches | lr 20.00 | ms/batch  6.81 | loss  0.95
INFO:root:| epoch   2 |   600/ 1520 batches | lr 20.00 | ms/batch  8.49 | loss  0.83
INFO:root:| epoch   2 |   800/ 1520 batches | lr 20.00 | ms/batch  9.06 | loss  0.99
INFO:root:| epoch   2 |  1000/ 1520 batches | lr 20.00 | ms/batch  7.78 | loss  0.93
INFO:root:| epoch   2 |  1200/ 1520 batches | lr 20.00 | ms/batch  9.26 | loss  0.84
INFO:root:| epoch   2 |  1400/ 1520 batches | lr 20.00 | ms/batch  7.11 | loss  1.00
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   2 | time: 12.27s | valid loss  2.56 | valid ppl    12.93
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   3 |   200/ 1520 batches | lr 5.00 | ms/batch  7.70 | loss  0.68
INFO:root:| epoch   3 |   400/ 1520 batches | lr 5.00 | ms/batch  8.12 | loss  0.47
INFO:root:| epoch   3 |   600/ 1520 batches | lr 5.00 | ms/batch  7.07 | loss  0.39
INFO:root:| epoch   3 |   800/ 1520 batches | lr 5.00 | ms/batch 10.75 | loss  0.46
INFO:root:| epoch   3 |  1000/ 1520 batches | lr 5.00 | ms/batch  8.71 | loss  0.46
INFO:root:| epoch   3 |  1200/ 1520 batches | lr 5.00 | ms/batch  7.41 | loss  0.39
INFO:root:| epoch   3 |  1400/ 1520 batches | lr 5.00 | ms/batch  7.15 | loss  0.45
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   3 | time: 12.37s | valid loss  1.31 | valid ppl     3.70
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   4 |   200/ 1520 batches | lr 5.00 | ms/batch  8.84 | loss  0.46
INFO:root:| epoch   4 |   400/ 1520 batches | lr 5.00 | ms/batch  7.42 | loss  0.45
INFO:root:| epoch   4 |   600/ 1520 batches | lr 5.00 | ms/batch  7.01 | loss  0.39
INFO:root:| epoch   4 |   800/ 1520 batches | lr 5.00 | ms/batch  6.94 | loss  0.45
INFO:root:| epoch   4 |  1000/ 1520 batches | lr 5.00 | ms/batch  8.92 | loss  0.45
INFO:root:| epoch   4 |  1200/ 1520 batches | lr 5.00 | ms/batch  7.13 | loss  0.39
INFO:root:| epoch   4 |  1400/ 1520 batches | lr 5.00 | ms/batch  7.15 | loss  0.45
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   4 | time: 11.68s | valid loss  1.30 | valid ppl     3.66
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   5 |   200/ 1520 batches | lr 5.00 | ms/batch  7.24 | loss  0.46
INFO:root:| epoch   5 |   400/ 1520 batches | lr 5.00 | ms/batch  7.37 | loss  0.45
INFO:root:| epoch   5 |   600/ 1520 batches | lr 5.00 | ms/batch  7.07 | loss  0.38
INFO:root:| epoch   5 |   800/ 1520 batches | lr 5.00 | ms/batch  7.07 | loss  0.45
INFO:root:| epoch   5 |  1000/ 1520 batches | lr 5.00 | ms/batch  6.98 | loss  0.45
INFO:root:| epoch   5 |  1200/ 1520 batches | lr 5.00 | ms/batch  6.99 | loss  0.38
INFO:root:| epoch   5 |  1400/ 1520 batches | lr 5.00 | ms/batch  7.68 | loss  0.45
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   5 | time: 11.40s | valid loss  1.30 | valid ppl     3.68
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   6 |   200/ 1520 batches | lr 1.25 | ms/batch  7.23 | loss  0.45
INFO:root:| epoch   6 |   400/ 1520 batches | lr 1.25 | ms/batch  7.20 | loss  0.35
INFO:root:| epoch   6 |   600/ 1520 batches | lr 1.25 | ms/batch  8.96 | loss  0.30
INFO:root:| epoch   6 |   800/ 1520 batches | lr 1.25 | ms/batch  7.19 | loss  0.35
INFO:root:| epoch   6 |  1000/ 1520 batches | lr 1.25 | ms/batch  7.17 | loss  0.34
INFO:root:| epoch   6 |  1200/ 1520 batches | lr 1.25 | ms/batch  8.18 | loss  0.30
INFO:root:| epoch   6 |  1400/ 1520 batches | lr 1.25 | ms/batch  7.79 | loss  0.34
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   6 | time: 11.76s | valid loss  1.10 | valid ppl     3.01
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   7 |   200/ 1520 batches | lr 1.25 | ms/batch  7.72 | loss  0.35
INFO:root:| epoch   7 |   400/ 1520 batches | lr 1.25 | ms/batch  7.46 | loss  0.34
INFO:root:| epoch   7 |   600/ 1520 batches | lr 1.25 | ms/batch  7.18 | loss  0.30
INFO:root:| epoch   7 |   800/ 1520 batches | lr 1.25 | ms/batch  7.19 | loss  0.35
INFO:root:| epoch   7 |  1000/ 1520 batches | lr 1.25 | ms/batch  9.12 | loss  0.34
INFO:root:| epoch   7 |  1200/ 1520 batches | lr 1.25 | ms/batch  7.21 | loss  0.30
INFO:root:| epoch   7 |  1400/ 1520 batches | lr 1.25 | ms/batch  7.41 | loss  0.34
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   7 | time: 11.85s | valid loss  1.10 | valid ppl     3.00
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   8 |   200/ 1520 batches | lr 1.25 | ms/batch  8.63 | loss  0.34
INFO:root:| epoch   8 |   400/ 1520 batches | lr 1.25 | ms/batch  7.35 | loss  0.34
INFO:root:| epoch   8 |   600/ 1520 batches | lr 1.25 | ms/batch  7.21 | loss  0.30
INFO:root:| epoch   8 |   800/ 1520 batches | lr 1.25 | ms/batch  7.23 | loss  0.35
INFO:root:| epoch   8 |  1000/ 1520 batches | lr 1.25 | ms/batch  7.23 | loss  0.34
INFO:root:| epoch   8 |  1200/ 1520 batches | lr 1.25 | ms/batch  7.25 | loss  0.30
INFO:root:| epoch   8 |  1400/ 1520 batches | lr 1.25 | ms/batch  7.90 | loss  0.34
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   8 | time: 11.59s | valid loss  1.10 | valid ppl     3.01
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   9 |   200/ 1520 batches | lr 0.31 | ms/batch  7.27 | loss  0.35
INFO:root:| epoch   9 |   400/ 1520 batches | lr 0.31 | ms/batch  7.16 | loss  0.32
INFO:root:| epoch   9 |   600/ 1520 batches | lr 0.31 | ms/batch  8.40 | loss  0.28
INFO:root:| epoch   9 |   800/ 1520 batches | lr 0.31 | ms/batch  8.19 | loss  0.32
INFO:root:| epoch   9 |  1000/ 1520 batches | lr 0.31 | ms/batch  7.49 | loss  0.31
INFO:root:| epoch   9 |  1200/ 1520 batches | lr 0.31 | ms/batch  8.38 | loss  0.28
INFO:root:| epoch   9 |  1400/ 1520 batches | lr 0.31 | ms/batch  8.05 | loss  0.31
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   9 | time: 12.03s | valid loss  1.06 | valid ppl     2.89
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  10 |   200/ 1520 batches | lr 0.31 | ms/batch  7.46 | loss  0.31
INFO:root:| epoch  10 |   400/ 1520 batches | lr 0.31 | ms/batch  7.55 | loss  0.31
INFO:root:| epoch  10 |   600/ 1520 batches | lr 0.31 | ms/batch  7.25 | loss  0.27
INFO:root:| epoch  10 |   800/ 1520 batches | lr 0.31 | ms/batch  7.29 | loss  0.32
INFO:root:| epoch  10 |  1000/ 1520 batches | lr 0.31 | ms/batch  7.28 | loss  0.31
INFO:root:| epoch  10 |  1200/ 1520 batches | lr 0.31 | ms/batch  7.38 | loss  0.28
INFO:root:| epoch  10 |  1400/ 1520 batches | lr 0.31 | ms/batch  7.42 | loss  0.31
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  10 | time: 11.37s | valid loss  1.06 | valid ppl     2.90
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  11 |   200/ 1520 batches | lr 0.08 | ms/batch  8.53 | loss  0.31
INFO:root:| epoch  11 |   400/ 1520 batches | lr 0.08 | ms/batch  8.13 | loss  0.30
INFO:root:| epoch  11 |   600/ 1520 batches | lr 0.08 | ms/batch  7.41 | loss  0.27
INFO:root:| epoch  11 |   800/ 1520 batches | lr 0.08 | ms/batch  8.26 | loss  0.31
INFO:root:| epoch  11 |  1000/ 1520 batches | lr 0.08 | ms/batch  8.47 | loss  0.30
INFO:root:| epoch  11 |  1200/ 1520 batches | lr 0.08 | ms/batch  7.21 | loss  0.27
INFO:root:| epoch  11 |  1400/ 1520 batches | lr 0.08 | ms/batch  7.61 | loss  0.30
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  11 | time: 12.46s | valid loss  1.06 | valid ppl     2.88
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  12 |   200/ 1520 batches | lr 0.08 | ms/batch  7.93 | loss  0.30
INFO:root:| epoch  12 |   400/ 1520 batches | lr 0.08 | ms/batch  7.48 | loss  0.30
INFO:root:| epoch  12 |   600/ 1520 batches | lr 0.08 | ms/batch  9.31 | loss  0.27
INFO:root:| epoch  12 |   800/ 1520 batches | lr 0.08 | ms/batch  7.38 | loss  0.31
INFO:root:| epoch  12 |  1000/ 1520 batches | lr 0.08 | ms/batch  7.40 | loss  0.30
INFO:root:| epoch  12 |  1200/ 1520 batches | lr 0.08 | ms/batch  8.55 | loss  0.27
INFO:root:| epoch  12 |  1400/ 1520 batches | lr 0.08 | ms/batch  7.98 | loss  0.30
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  12 | time: 12.26s | valid loss  1.06 | valid ppl     2.88
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  13 |   200/ 1520 batches | lr 0.02 | ms/batch  7.63 | loss  0.30
INFO:root:| epoch  13 |   400/ 1520 batches | lr 0.02 | ms/batch  9.14 | loss  0.30
INFO:root:| epoch  13 |   600/ 1520 batches | lr 0.02 | ms/batch  7.38 | loss  0.27
INFO:root:| epoch  13 |   800/ 1520 batches | lr 0.02 | ms/batch  8.02 | loss  0.31
INFO:root:| epoch  13 |  1000/ 1520 batches | lr 0.02 | ms/batch  7.17 | loss  0.30
INFO:root:| epoch  13 |  1200/ 1520 batches | lr 0.02 | ms/batch  7.60 | loss  0.27
INFO:root:| epoch  13 |  1400/ 1520 batches | lr 0.02 | ms/batch  7.61 | loss  0.30
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  13 | time: 12.02s | valid loss  1.06 | valid ppl     2.88
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  14 |   200/ 1520 batches | lr 0.02 | ms/batch  7.59 | loss  0.30
INFO:root:| epoch  14 |   400/ 1520 batches | lr 0.02 | ms/batch  7.36 | loss  0.30
INFO:root:| epoch  14 |   600/ 1520 batches | lr 0.02 | ms/batch  7.22 | loss  0.27
INFO:root:| epoch  14 |   800/ 1520 batches | lr 0.02 | ms/batch  9.22 | loss  0.31
INFO:root:| epoch  14 |  1000/ 1520 batches | lr 0.02 | ms/batch  7.48 | loss  0.30
INFO:root:| epoch  14 |  1200/ 1520 batches | lr 0.02 | ms/batch  7.53 | loss  0.27
INFO:root:| epoch  14 |  1400/ 1520 batches | lr 0.02 | ms/batch  8.43 | loss  0.30
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  14 | time: 12.21s | valid loss  1.06 | valid ppl     2.88
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  15 |   200/ 1520 batches | lr 0.02 | ms/batch  7.48 | loss  0.30
INFO:root:| epoch  15 |   400/ 1520 batches | lr 0.02 | ms/batch  7.45 | loss  0.30
INFO:root:| epoch  15 |   600/ 1520 batches | lr 0.02 | ms/batch  7.27 | loss  0.27
INFO:root:| epoch  15 |   800/ 1520 batches | lr 0.02 | ms/batch  7.22 | loss  0.31
INFO:root:| epoch  15 |  1000/ 1520 batches | lr 0.02 | ms/batch  7.53 | loss  0.30
INFO:root:| epoch  15 |  1200/ 1520 batches | lr 0.02 | ms/batch  7.45 | loss  0.27
INFO:root:| epoch  15 |  1400/ 1520 batches | lr 0.02 | ms/batch  7.41 | loss  0.30
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  15 | time: 11.40s | valid loss  1.06 | valid ppl     2.88
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  16 |   200/ 1520 batches | lr 0.00 | ms/batch  7.34 | loss  0.30
INFO:root:| epoch  16 |   400/ 1520 batches | lr 0.00 | ms/batch  8.66 | loss  0.30
INFO:root:| epoch  16 |   600/ 1520 batches | lr 0.00 | ms/batch  8.22 | loss  0.27
INFO:root:| epoch  16 |   800/ 1520 batches | lr 0.00 | ms/batch  7.45 | loss  0.31
INFO:root:| epoch  16 |  1000/ 1520 batches | lr 0.00 | ms/batch  8.67 | loss  0.29
INFO:root:| epoch  16 |  1200/ 1520 batches | lr 0.00 | ms/batch  8.11 | loss  0.27
INFO:root:| epoch  16 |  1400/ 1520 batches | lr 0.00 | ms/batch  7.45 | loss  0.30
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  16 | time: 12.20s | valid loss  1.06 | valid ppl     2.88
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  17 |   200/ 1520 batches | lr 0.00 | ms/batch  9.61 | loss  0.30
INFO:root:| epoch  17 |   400/ 1520 batches | lr 0.00 | ms/batch  7.53 | loss  0.30
INFO:root:| epoch  17 |   600/ 1520 batches | lr 0.00 | ms/batch  7.77 | loss  0.27
INFO:root:| epoch  17 |   800/ 1520 batches | lr 0.00 | ms/batch  7.58 | loss  0.31
INFO:root:| epoch  17 |  1000/ 1520 batches | lr 0.00 | ms/batch  7.74 | loss  0.30
INFO:root:| epoch  17 |  1200/ 1520 batches | lr 0.00 | ms/batch  7.28 | loss  0.27
INFO:root:| epoch  17 |  1400/ 1520 batches | lr 0.00 | ms/batch  8.94 | loss  0.30
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  17 | time: 12.46s | valid loss  1.06 | valid ppl     2.88
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  18 |   200/ 1520 batches | lr 0.00 | ms/batch  7.72 | loss  0.30
INFO:root:| epoch  18 |   400/ 1520 batches | lr 0.00 | ms/batch  7.40 | loss  0.30
INFO:root:| epoch  18 |   600/ 1520 batches | lr 0.00 | ms/batch  9.37 | loss  0.27
INFO:root:| epoch  18 |   800/ 1520 batches | lr 0.00 | ms/batch  7.37 | loss  0.31
INFO:root:| epoch  18 |  1000/ 1520 batches | lr 0.00 | ms/batch  7.26 | loss  0.30
INFO:root:| epoch  18 |  1200/ 1520 batches | lr 0.00 | ms/batch  7.39 | loss  0.27
INFO:root:| epoch  18 |  1400/ 1520 batches | lr 0.00 | ms/batch  7.47 | loss  0.30
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  18 | time: 11.85s | valid loss  1.06 | valid ppl     2.88
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  19 |   200/ 1520 batches | lr 0.00 | ms/batch  8.22 | loss  0.30
INFO:root:| epoch  19 |   400/ 1520 batches | lr 0.00 | ms/batch  7.52 | loss  0.30
INFO:root:| epoch  19 |   600/ 1520 batches | lr 0.00 | ms/batch  7.45 | loss  0.27
INFO:root:| epoch  19 |   800/ 1520 batches | lr 0.00 | ms/batch  7.36 | loss  0.31
INFO:root:| epoch  19 |  1000/ 1520 batches | lr 0.00 | ms/batch  9.29 | loss  0.29
INFO:root:| epoch  19 |  1200/ 1520 batches | lr 0.00 | ms/batch  7.56 | loss  0.27
INFO:root:| epoch  19 |  1400/ 1520 batches | lr 0.00 | ms/batch  7.43 | loss  0.30
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  19 | time: 12.34s | valid loss  1.06 | valid ppl     2.88
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  20 |   200/ 1520 batches | lr 0.00 | ms/batch  7.82 | loss  0.30
INFO:root:| epoch  20 |   400/ 1520 batches | lr 0.00 | ms/batch  7.36 | loss  0.30
INFO:root:| epoch  20 |   600/ 1520 batches | lr 0.00 | ms/batch  8.49 | loss  0.27
INFO:root:| epoch  20 |   800/ 1520 batches | lr 0.00 | ms/batch  8.17 | loss  0.31
INFO:root:| epoch  20 |  1000/ 1520 batches | lr 0.00 | ms/batch  7.42 | loss  0.29
INFO:root:| epoch  20 |  1200/ 1520 batches | lr 0.00 | ms/batch  7.45 | loss  0.27
INFO:root:| epoch  20 |  1400/ 1520 batches | lr 0.00 | ms/batch  7.28 | loss  0.30
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  20 | time: 11.85s | valid loss  1.06 | valid ppl     2.88
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  21 |   200/ 1520 batches | lr 0.00 | ms/batch  7.32 | loss  0.30
INFO:root:| epoch  21 |   400/ 1520 batches | lr 0.00 | ms/batch  7.48 | loss  0.30
INFO:root:| epoch  21 |   600/ 1520 batches | lr 0.00 | ms/batch  9.37 | loss  0.27
INFO:root:| epoch  21 |   800/ 1520 batches | lr 0.00 | ms/batch  7.38 | loss  0.31
INFO:root:| epoch  21 |  1000/ 1520 batches | lr 0.00 | ms/batch  7.40 | loss  0.29
INFO:root:| epoch  21 |  1200/ 1520 batches | lr 0.00 | ms/batch  9.30 | loss  0.27
INFO:root:| epoch  21 |  1400/ 1520 batches | lr 0.00 | ms/batch  7.40 | loss  0.30
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  21 | time: 12.18s | valid loss  1.06 | valid ppl     2.88
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  22 |   200/ 1520 batches | lr 0.00 | ms/batch  8.91 | loss  0.30
INFO:root:| epoch  22 |   400/ 1520 batches | lr 0.00 | ms/batch  8.27 | loss  0.30
INFO:root:| epoch  22 |   600/ 1520 batches | lr 0.00 | ms/batch  7.43 | loss  0.27
INFO:root:| epoch  22 |   800/ 1520 batches | lr 0.00 | ms/batch  7.38 | loss  0.31
INFO:root:| epoch  22 |  1000/ 1520 batches | lr 0.00 | ms/batch  7.55 | loss  0.29
INFO:root:| epoch  22 |  1200/ 1520 batches | lr 0.00 | ms/batch  8.29 | loss  0.27
INFO:root:| epoch  22 |  1400/ 1520 batches | lr 0.00 | ms/batch  7.70 | loss  0.30
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  22 | time: 12.51s | valid loss  1.06 | valid ppl     2.88
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  23 |   200/ 1520 batches | lr 0.00 | ms/batch  7.90 | loss  0.30
INFO:root:| epoch  23 |   400/ 1520 batches | lr 0.00 | ms/batch  8.21 | loss  0.30
INFO:root:| epoch  23 |   600/ 1520 batches | lr 0.00 | ms/batch  9.13 | loss  0.27
INFO:root:| epoch  23 |   800/ 1520 batches | lr 0.00 | ms/batch  7.60 | loss  0.31
INFO:root:| epoch  23 |  1000/ 1520 batches | lr 0.00 | ms/batch  7.44 | loss  0.29
INFO:root:| epoch  23 |  1200/ 1520 batches | lr 0.00 | ms/batch  7.53 | loss  0.27
INFO:root:| epoch  23 |  1400/ 1520 batches | lr 0.00 | ms/batch  7.44 | loss  0.30
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  23 | time: 12.10s | valid loss  1.06 | valid ppl     2.88
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  24 |   200/ 1520 batches | lr 0.00 | ms/batch  7.44 | loss  0.30
INFO:root:| epoch  24 |   400/ 1520 batches | lr 0.00 | ms/batch  7.28 | loss  0.30
INFO:root:| epoch  24 |   600/ 1520 batches | lr 0.00 | ms/batch  7.35 | loss  0.27
INFO:root:| epoch  24 |   800/ 1520 batches | lr 0.00 | ms/batch  7.46 | loss  0.31
INFO:root:| epoch  24 |  1000/ 1520 batches | lr 0.00 | ms/batch  7.48 | loss  0.29
INFO:root:| epoch  24 |  1200/ 1520 batches | lr 0.00 | ms/batch  9.42 | loss  0.27
INFO:root:| epoch  24 |  1400/ 1520 batches | lr 0.00 | ms/batch  7.39 | loss  0.30
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  24 | time: 12.02s | valid loss  1.06 | valid ppl     2.88
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  25 |   200/ 1520 batches | lr 0.00 | ms/batch  9.35 | loss  0.30
INFO:root:| epoch  25 |   400/ 1520 batches | lr 0.00 | ms/batch  7.46 | loss  0.30
INFO:root:| epoch  25 |   600/ 1520 batches | lr 0.00 | ms/batch  7.40 | loss  0.27
INFO:root:| epoch  25 |   800/ 1520 batches | lr 0.00 | ms/batch  7.54 | loss  0.31
INFO:root:| epoch  25 |  1000/ 1520 batches | lr 0.00 | ms/batch  7.43 | loss  0.29
INFO:root:| epoch  25 |  1200/ 1520 batches | lr 0.00 | ms/batch  7.39 | loss  0.27
INFO:root:| epoch  25 |  1400/ 1520 batches | lr 0.00 | ms/batch  7.37 | loss  0.30
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  25 | time: 11.83s | valid loss  1.06 | valid ppl     2.88
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  26 |   200/ 1520 batches | lr 0.00 | ms/batch  7.47 | loss  0.30
INFO:root:| epoch  26 |   400/ 1520 batches | lr 0.00 | ms/batch  7.40 | loss  0.30
INFO:root:| epoch  26 |   600/ 1520 batches | lr 0.00 | ms/batch  7.47 | loss  0.27
INFO:root:| epoch  26 |   800/ 1520 batches | lr 0.00 | ms/batch  9.43 | loss  0.31
INFO:root:| epoch  26 |  1000/ 1520 batches | lr 0.00 | ms/batch  7.42 | loss  0.30
INFO:root:| epoch  26 |  1200/ 1520 batches | lr 0.00 | ms/batch  7.51 | loss  0.27
INFO:root:| epoch  26 |  1400/ 1520 batches | lr 0.00 | ms/batch  9.29 | loss  0.30
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  26 | time: 12.37s | valid loss  1.06 | valid ppl     2.88
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  27 |   200/ 1520 batches | lr 0.00 | ms/batch  7.59 | loss  0.30
INFO:root:| epoch  27 |   400/ 1520 batches | lr 0.00 | ms/batch  8.88 | loss  0.30
INFO:root:| epoch  27 |   600/ 1520 batches | lr 0.00 | ms/batch  7.83 | loss  0.27
INFO:root:| epoch  27 |   800/ 1520 batches | lr 0.00 | ms/batch  7.36 | loss  0.31
INFO:root:| epoch  27 |  1000/ 1520 batches | lr 0.00 | ms/batch  7.46 | loss  0.29
INFO:root:| epoch  27 |  1200/ 1520 batches | lr 0.00 | ms/batch  7.70 | loss  0.27
INFO:root:| epoch  27 |  1400/ 1520 batches | lr 0.00 | ms/batch  7.40 | loss  0.30
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  27 | time: 11.91s | valid loss  1.06 | valid ppl     2.88
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  28 |   200/ 1520 batches | lr 0.00 | ms/batch  7.26 | loss  0.30
INFO:root:| epoch  28 |   400/ 1520 batches | lr 0.00 | ms/batch  9.43 | loss  0.30
INFO:root:| epoch  28 |   600/ 1520 batches | lr 0.00 | ms/batch  7.48 | loss  0.27
INFO:root:| epoch  28 |   800/ 1520 batches | lr 0.00 | ms/batch 14.80 | loss  0.31
INFO:root:| epoch  28 |  1000/ 1520 batches | lr 0.00 | ms/batch 12.99 | loss  0.29
INFO:root:| epoch  28 |  1200/ 1520 batches | lr 0.00 | ms/batch 10.24 | loss  0.27
INFO:root:| epoch  28 |  1400/ 1520 batches | lr 0.00 | ms/batch 10.44 | loss  0.30
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  28 | time: 15.59s | valid loss  1.06 | valid ppl     2.88
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  29 |   200/ 1520 batches | lr 0.00 | ms/batch  8.29 | loss  0.30
INFO:root:| epoch  29 |   400/ 1520 batches | lr 0.00 | ms/batch  8.48 | loss  0.30
INFO:root:| epoch  29 |   600/ 1520 batches | lr 0.00 | ms/batch  7.57 | loss  0.27
INFO:root:| epoch  29 |   800/ 1520 batches | lr 0.00 | ms/batch  8.01 | loss  0.31
INFO:root:| epoch  29 |  1000/ 1520 batches | lr 0.00 | ms/batch  9.00 | loss  0.29
INFO:root:| epoch  29 |  1200/ 1520 batches | lr 0.00 | ms/batch  7.51 | loss  0.27
INFO:root:| epoch  29 |  1400/ 1520 batches | lr 0.00 | ms/batch  7.84 | loss  0.30
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  29 | time: 12.69s | valid loss  1.06 | valid ppl     2.88
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  30 |   200/ 1520 batches | lr 0.00 | ms/batch  7.54 | loss  0.30
INFO:root:| epoch  30 |   400/ 1520 batches | lr 0.00 | ms/batch  7.38 | loss  0.30
INFO:root:| epoch  30 |   600/ 1520 batches | lr 0.00 | ms/batch  7.35 | loss  0.27
INFO:root:| epoch  30 |   800/ 1520 batches | lr 0.00 | ms/batch  7.20 | loss  0.31
INFO:root:| epoch  30 |  1000/ 1520 batches | lr 0.00 | ms/batch  7.42 | loss  0.29
INFO:root:| epoch  30 |  1200/ 1520 batches | lr 0.00 | ms/batch  7.44 | loss  0.27
INFO:root:| epoch  30 |  1400/ 1520 batches | lr 0.00 | ms/batch  7.37 | loss  0.30
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  30 | time: 11.39s | valid loss  1.06 | valid ppl     2.88
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  31 |   200/ 1520 batches | lr 0.00 | ms/batch  7.45 | loss  0.30
INFO:root:| epoch  31 |   400/ 1520 batches | lr 0.00 | ms/batch  9.00 | loss  0.30
INFO:root:| epoch  31 |   600/ 1520 batches | lr 0.00 | ms/batch  7.89 | loss  0.27
INFO:root:| epoch  31 |   800/ 1520 batches | lr 0.00 | ms/batch  7.46 | loss  0.31
INFO:root:| epoch  31 |  1000/ 1520 batches | lr 0.00 | ms/batch  9.07 | loss  0.29
INFO:root:| epoch  31 |  1200/ 1520 batches | lr 0.00 | ms/batch  8.19 | loss  0.27
INFO:root:| epoch  31 |  1400/ 1520 batches | lr 0.00 | ms/batch  7.46 | loss  0.30
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  31 | time: 12.43s | valid loss  1.06 | valid ppl     2.88
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  32 |   200/ 1520 batches | lr 0.00 | ms/batch  8.98 | loss  0.30
INFO:root:| epoch  32 |   400/ 1520 batches | lr 0.00 | ms/batch  7.36 | loss  0.30
INFO:root:| epoch  32 |   600/ 1520 batches | lr 0.00 | ms/batch  7.48 | loss  0.27
INFO:root:| epoch  32 |   800/ 1520 batches | lr 0.00 | ms/batch  7.38 | loss  0.31
INFO:root:| epoch  32 |  1000/ 1520 batches | lr 0.00 | ms/batch  7.46 | loss  0.29
INFO:root:| epoch  32 |  1200/ 1520 batches | lr 0.00 | ms/batch  7.42 | loss  0.27
INFO:root:| epoch  32 |  1400/ 1520 batches | lr 0.00 | ms/batch  7.45 | loss  0.30
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  32 | time: 12.15s | valid loss  1.06 | valid ppl     2.88
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  33 |   200/ 1520 batches | lr 0.00 | ms/batch  7.41 | loss  0.30
INFO:root:| epoch  33 |   400/ 1520 batches | lr 0.00 | ms/batch  7.44 | loss  0.30
INFO:root:| epoch  33 |   600/ 1520 batches | lr 0.00 | ms/batch 10.63 | loss  0.27
INFO:root:| epoch  33 |   800/ 1520 batches | lr 0.00 | ms/batch  7.53 | loss  0.31
INFO:root:| epoch  33 |  1000/ 1520 batches | lr 0.00 | ms/batch  7.44 | loss  0.29
INFO:root:| epoch  33 |  1200/ 1520 batches | lr 0.00 | ms/batch  7.45 | loss  0.27
INFO:root:| epoch  33 |  1400/ 1520 batches | lr 0.00 | ms/batch  7.44 | loss  0.30
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  33 | time: 12.11s | valid loss  1.06 | valid ppl     2.88
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  34 |   200/ 1520 batches | lr 0.00 | ms/batch  7.34 | loss  0.30
INFO:root:| epoch  34 |   400/ 1520 batches | lr 0.00 | ms/batch  7.48 | loss  0.30
INFO:root:| epoch  34 |   600/ 1520 batches | lr 0.00 | ms/batch  7.53 | loss  0.27
INFO:root:| epoch  34 |   800/ 1520 batches | lr 0.00 | ms/batch  7.37 | loss  0.31
INFO:root:| epoch  34 |  1000/ 1520 batches | lr 0.00 | ms/batch  8.96 | loss  0.29
INFO:root:| epoch  34 |  1200/ 1520 batches | lr 0.00 | ms/batch  7.94 | loss  0.27
INFO:root:| epoch  34 |  1400/ 1520 batches | lr 0.00 | ms/batch  7.46 | loss  0.30
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  34 | time: 11.97s | valid loss  1.06 | valid ppl     2.88
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  35 |   200/ 1520 batches | lr 0.00 | ms/batch  8.93 | loss  0.30
INFO:root:| epoch  35 |   400/ 1520 batches | lr 0.00 | ms/batch  7.40 | loss  0.30
INFO:root:| epoch  35 |   600/ 1520 batches | lr 0.00 | ms/batch  7.38 | loss  0.27
INFO:root:| epoch  35 |   800/ 1520 batches | lr 0.00 | ms/batch  7.40 | loss  0.31
INFO:root:| epoch  35 |  1000/ 1520 batches | lr 0.00 | ms/batch  7.47 | loss  0.29
INFO:root:| epoch  35 |  1200/ 1520 batches | lr 0.00 | ms/batch  7.40 | loss  0.27
INFO:root:| epoch  35 |  1400/ 1520 batches | lr 0.00 | ms/batch  7.43 | loss  0.30
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  35 | time: 11.74s | valid loss  1.06 | valid ppl     2.88
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  36 |   200/ 1520 batches | lr 0.00 | ms/batch  7.52 | loss  0.30
INFO:root:| epoch  36 |   400/ 1520 batches | lr 0.00 | ms/batch  8.17 | loss  0.30
INFO:root:| epoch  36 |   600/ 1520 batches | lr 0.00 | ms/batch  8.75 | loss  0.27
INFO:root:| epoch  36 |   800/ 1520 batches | lr 0.00 | ms/batch  7.40 | loss  0.31
INFO:root:| epoch  36 |  1000/ 1520 batches | lr 0.00 | ms/batch  8.54 | loss  0.29
INFO:root:| epoch  36 |  1200/ 1520 batches | lr 0.00 | ms/batch  8.79 | loss  0.27
INFO:root:| epoch  36 |  1400/ 1520 batches | lr 0.00 | ms/batch  7.46 | loss  0.30
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  36 | time: 12.38s | valid loss  1.06 | valid ppl     2.88
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  37 |   200/ 1520 batches | lr 0.00 | ms/batch  7.42 | loss  0.30
INFO:root:| epoch  37 |   400/ 1520 batches | lr 0.00 | ms/batch  7.42 | loss  0.30
INFO:root:| epoch  37 |   600/ 1520 batches | lr 0.00 | ms/batch  7.17 | loss  0.27
INFO:root:| epoch  37 |   800/ 1520 batches | lr 0.00 | ms/batch  7.24 | loss  0.31
INFO:root:| epoch  37 |  1000/ 1520 batches | lr 0.00 | ms/batch  7.45 | loss  0.29
INFO:root:| epoch  37 |  1200/ 1520 batches | lr 0.00 | ms/batch  7.41 | loss  0.27
INFO:root:| epoch  37 |  1400/ 1520 batches | lr 0.00 | ms/batch  7.38 | loss  0.30
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  37 | time: 11.35s | valid loss  1.06 | valid ppl     2.88
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  38 |   200/ 1520 batches | lr 0.00 | ms/batch  8.42 | loss  0.30
INFO:root:| epoch  38 |   400/ 1520 batches | lr 0.00 | ms/batch  8.46 | loss  0.30
INFO:root:| epoch  38 |   600/ 1520 batches | lr 0.00 | ms/batch  7.50 | loss  0.27
INFO:root:| epoch  38 |   800/ 1520 batches | lr 0.00 | ms/batch  8.10 | loss  0.31
INFO:root:| epoch  38 |  1000/ 1520 batches | lr 0.00 | ms/batch  8.56 | loss  0.29
INFO:root:| epoch  38 |  1200/ 1520 batches | lr 0.00 | ms/batch  7.43 | loss  0.27
INFO:root:| epoch  38 |  1400/ 1520 batches | lr 0.00 | ms/batch  7.54 | loss  0.30
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  38 | time: 12.25s | valid loss  1.06 | valid ppl     2.88
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  39 |   200/ 1520 batches | lr 0.00 | ms/batch  7.55 | loss  0.30
INFO:root:| epoch  39 |   400/ 1520 batches | lr 0.00 | ms/batch  7.40 | loss  0.30
INFO:root:| epoch  39 |   600/ 1520 batches | lr 0.00 | ms/batch  7.29 | loss  0.27
INFO:root:| epoch  39 |   800/ 1520 batches | lr 0.00 | ms/batch  9.43 | loss  0.31
INFO:root:| epoch  39 |  1000/ 1520 batches | lr 0.00 | ms/batch  7.43 | loss  0.29
INFO:root:| epoch  39 |  1200/ 1520 batches | lr 0.00 | ms/batch  7.51 | loss  0.27
INFO:root:| epoch  39 |  1400/ 1520 batches | lr 0.00 | ms/batch  9.51 | loss  0.30
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  39 | time: 12.29s | valid loss  1.06 | valid ppl     2.88
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  40 |   200/ 1520 batches | lr 0.00 | ms/batch  7.48 | loss  0.30
INFO:root:| epoch  40 |   400/ 1520 batches | lr 0.00 | ms/batch  8.68 | loss  0.30
INFO:root:| epoch  40 |   600/ 1520 batches | lr 0.00 | ms/batch  8.23 | loss  0.27
INFO:root:| epoch  40 |   800/ 1520 batches | lr 0.00 | ms/batch  7.41 | loss  0.31
INFO:root:| epoch  40 |  1000/ 1520 batches | lr 0.00 | ms/batch  7.43 | loss  0.29
INFO:root:| epoch  40 |  1200/ 1520 batches | lr 0.00 | ms/batch  7.21 | loss  0.27
INFO:root:| epoch  40 |  1400/ 1520 batches | lr 0.00 | ms/batch  7.42 | loss  0.30
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  40 | time: 11.83s | valid loss  1.06 | valid ppl     2.88
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:Namespace(cuda=False, save='model.pt')
INFO:root:Loading data
INFO:root:Vocab size 135
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:| epoch   1 |   200/ 1520 batches | lr 20.00 | ms/batch  8.02 | loss  3.83
INFO:root:| epoch   1 |   400/ 1520 batches | lr 20.00 | ms/batch  7.21 | loss  1.50
INFO:root:| epoch   1 |   600/ 1520 batches | lr 20.00 | ms/batch  7.15 | loss  0.92
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:Exiting from training early
INFO:root:Namespace(cuda=False, save='model.pt')
INFO:root:Loading data
INFO:root:Vocab size 135
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:| epoch   1 |   200/ 1520 batches | lr 20.00 | ms/batch  7.48 | loss  3.83
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:Exiting from training early
INFO:root:Namespace(cuda=False, train=False, save='model.pt')
INFO:root:Namespace(cuda=False, train=True, test=False, save='model.pt')
INFO:root:Loading data
INFO:root:Vocab file not found, creating new vocab file.
INFO:root:Namespace(cuda=False, train=True, test=False, save='model.pt')
INFO:root:Loading data
INFO:root:Vocab file not found, creating new vocab file.
INFO:root:Vocab size 712
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:Namespace(cuda=False, train=True, test=False, save='model.pt')
INFO:root:Loading data
INFO:root:Vocab size 712
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:| epoch   1 |   200/ 1520 batches | lr 20.00 | ms/batch  8.34 | loss  5.55
INFO:root:| epoch   1 |   400/ 1520 batches | lr 20.00 | ms/batch  9.04 | loss  3.38
INFO:root:| epoch   1 |   600/ 1520 batches | lr 20.00 | ms/batch  7.64 | loss  2.99
INFO:root:| epoch   1 |   800/ 1520 batches | lr 20.00 | ms/batch  7.40 | loss  2.70
INFO:root:| epoch   1 |  1000/ 1520 batches | lr 20.00 | ms/batch  7.79 | loss  2.60
INFO:root:| epoch   1 |  1200/ 1520 batches | lr 20.00 | ms/batch  9.46 | loss  2.39
INFO:root:| epoch   1 |  1400/ 1520 batches | lr 20.00 | ms/batch  8.64 | loss  2.38
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   1 | time: 13.13s | valid loss  3.76 | valid ppl    42.80
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   2 |   200/ 1520 batches | lr 20.00 | ms/batch 10.49 | loss  2.28
INFO:root:| epoch   2 |   400/ 1520 batches | lr 20.00 | ms/batch  7.69 | loss  2.24
INFO:root:| epoch   2 |   600/ 1520 batches | lr 20.00 | ms/batch  7.48 | loss  2.19
INFO:root:| epoch   2 |   800/ 1520 batches | lr 20.00 | ms/batch  9.05 | loss  2.20
INFO:root:| epoch   2 |  1000/ 1520 batches | lr 20.00 | ms/batch 10.24 | loss  2.21
INFO:root:| epoch   2 |  1200/ 1520 batches | lr 20.00 | ms/batch  7.36 | loss  2.25
INFO:root:| epoch   2 |  1400/ 1520 batches | lr 20.00 | ms/batch  7.33 | loss  2.18
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   2 | time: 13.26s | valid loss  3.79 | valid ppl    44.41
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   3 |   200/ 1520 batches | lr 5.00 | ms/batch  7.79 | loss  2.18
INFO:root:| epoch   3 |   400/ 1520 batches | lr 5.00 | ms/batch  7.27 | loss  2.00
INFO:root:| epoch   3 |   600/ 1520 batches | lr 5.00 | ms/batch  7.20 | loss  1.93
INFO:root:| epoch   3 |   800/ 1520 batches | lr 5.00 | ms/batch  7.16 | loss  1.98
INFO:root:| epoch   3 |  1000/ 1520 batches | lr 5.00 | ms/batch  7.31 | loss  1.97
INFO:root:| epoch   3 |  1200/ 1520 batches | lr 5.00 | ms/batch  7.40 | loss  1.88
INFO:root:| epoch   3 |  1400/ 1520 batches | lr 5.00 | ms/batch  8.37 | loss  1.89
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   3 | time: 11.58s | valid loss  3.24 | valid ppl    25.48
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   4 |   200/ 1520 batches | lr 5.00 | ms/batch  7.83 | loss  1.97
INFO:root:| epoch   4 |   400/ 1520 batches | lr 5.00 | ms/batch  7.38 | loss  1.94
INFO:root:| epoch   4 |   600/ 1520 batches | lr 5.00 | ms/batch  7.25 | loss  1.84
INFO:root:| epoch   4 |   800/ 1520 batches | lr 5.00 | ms/batch  8.19 | loss  1.91
INFO:root:| epoch   4 |  1000/ 1520 batches | lr 5.00 | ms/batch  8.24 | loss  1.92
INFO:root:| epoch   4 |  1200/ 1520 batches | lr 5.00 | ms/batch  7.20 | loss  1.93
INFO:root:| epoch   4 |  1400/ 1520 batches | lr 5.00 | ms/batch  7.81 | loss  1.86
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   4 | time: 12.07s | valid loss  3.25 | valid ppl    25.75
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   5 |   200/ 1520 batches | lr 1.25 | ms/batch  7.23 | loss  2.16
INFO:root:| epoch   5 |   400/ 1520 batches | lr 1.25 | ms/batch  7.11 | loss  2.00
INFO:root:| epoch   5 |   600/ 1520 batches | lr 1.25 | ms/batch  7.13 | loss  2.04
INFO:root:| epoch   5 |   800/ 1520 batches | lr 1.25 | ms/batch  7.10 | loss  1.97
INFO:root:| epoch   5 |  1000/ 1520 batches | lr 1.25 | ms/batch  7.15 | loss  1.99
INFO:root:| epoch   5 |  1200/ 1520 batches | lr 1.25 | ms/batch  7.23 | loss  2.01
INFO:root:| epoch   5 |  1400/ 1520 batches | lr 1.25 | ms/batch  7.26 | loss  1.91
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   5 | time: 11.05s | valid loss  3.15 | valid ppl    23.25
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   6 |   200/ 1520 batches | lr 1.25 | ms/batch  7.22 | loss  2.08
INFO:root:| epoch   6 |   400/ 1520 batches | lr 1.25 | ms/batch  7.21 | loss  1.97
INFO:root:| epoch   6 |   600/ 1520 batches | lr 1.25 | ms/batch  9.04 | loss  2.00
INFO:root:| epoch   6 |   800/ 1520 batches | lr 1.25 | ms/batch  7.24 | loss  1.93
INFO:root:| epoch   6 |  1000/ 1520 batches | lr 1.25 | ms/batch  7.17 | loss  1.95
INFO:root:| epoch   6 |  1200/ 1520 batches | lr 1.25 | ms/batch  8.85 | loss  1.95
INFO:root:| epoch   6 |  1400/ 1520 batches | lr 1.25 | ms/batch  7.49 | loss  1.84
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   6 | time: 11.86s | valid loss  3.18 | valid ppl    24.04
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   7 |   200/ 1520 batches | lr 0.31 | ms/batch  7.33 | loss  2.13
INFO:root:| epoch   7 |   400/ 1520 batches | lr 0.31 | ms/batch  8.93 | loss  2.07
INFO:root:| epoch   7 |   600/ 1520 batches | lr 0.31 | ms/batch  7.28 | loss  2.02
INFO:root:| epoch   7 |   800/ 1520 batches | lr 0.31 | ms/batch  7.19 | loss  1.93
INFO:root:| epoch   7 |  1000/ 1520 batches | lr 0.31 | ms/batch  7.22 | loss  1.96
INFO:root:| epoch   7 |  1200/ 1520 batches | lr 0.31 | ms/batch  7.16 | loss  1.95
INFO:root:| epoch   7 |  1400/ 1520 batches | lr 0.31 | ms/batch  7.16 | loss  1.84
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   7 | time: 11.70s | valid loss  3.13 | valid ppl    22.91
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   8 |   200/ 1520 batches | lr 0.31 | ms/batch  8.06 | loss  2.05
INFO:root:| epoch   8 |   400/ 1520 batches | lr 0.31 | ms/batch  7.14 | loss  1.97
INFO:root:| epoch   8 |   600/ 1520 batches | lr 0.31 | ms/batch  7.17 | loss  1.97
INFO:root:| epoch   8 |   800/ 1520 batches | lr 0.31 | ms/batch  7.16 | loss  1.90
INFO:root:| epoch   8 |  1000/ 1520 batches | lr 0.31 | ms/batch  7.16 | loss  1.93
INFO:root:| epoch   8 |  1200/ 1520 batches | lr 0.31 | ms/batch  7.16 | loss  1.89
INFO:root:| epoch   8 |  1400/ 1520 batches | lr 0.31 | ms/batch  7.19 | loss  1.81
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   8 | time: 11.22s | valid loss  3.13 | valid ppl    22.96
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   9 |   200/ 1520 batches | lr 0.08 | ms/batch  7.32 | loss  2.11
INFO:root:| epoch   9 |   400/ 1520 batches | lr 0.08 | ms/batch  7.15 | loss  1.99
INFO:root:| epoch   9 |   600/ 1520 batches | lr 0.08 | ms/batch  7.17 | loss  1.99
INFO:root:| epoch   9 |   800/ 1520 batches | lr 0.08 | ms/batch  7.17 | loss  1.88
INFO:root:| epoch   9 |  1000/ 1520 batches | lr 0.08 | ms/batch  7.50 | loss  1.92
INFO:root:| epoch   9 |  1200/ 1520 batches | lr 0.08 | ms/batch  7.50 | loss  1.90
INFO:root:| epoch   9 |  1400/ 1520 batches | lr 0.08 | ms/batch  8.79 | loss  1.82
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   9 | time: 11.54s | valid loss  3.05 | valid ppl    21.08
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  10 |   200/ 1520 batches | lr 0.08 | ms/batch  7.21 | loss  2.03
INFO:root:| epoch  10 |   400/ 1520 batches | lr 0.08 | ms/batch  8.94 | loss  1.96
INFO:root:| epoch  10 |   600/ 1520 batches | lr 0.08 | ms/batch  7.34 | loss  1.98
INFO:root:| epoch  10 |   800/ 1520 batches | lr 0.08 | ms/batch  7.18 | loss  1.88
INFO:root:| epoch  10 |  1000/ 1520 batches | lr 0.08 | ms/batch  7.16 | loss  1.92
INFO:root:| epoch  10 |  1200/ 1520 batches | lr 0.08 | ms/batch  7.19 | loss  1.89
INFO:root:| epoch  10 |  1400/ 1520 batches | lr 0.08 | ms/batch  7.15 | loss  1.82
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  10 | time: 11.44s | valid loss  3.04 | valid ppl    20.94
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:Namespace(cuda=False, train=True, test=False, save='model.pt')
INFO:root:Loading data
INFO:root:Vocab size 712
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:| epoch   1 |   200/ 1520 batches | lr 20.00 | ms/batch  9.21 | loss  5.55
INFO:root:| epoch   1 |   400/ 1520 batches | lr 20.00 | ms/batch  7.13 | loss  3.38
INFO:root:| epoch   1 |   600/ 1520 batches | lr 20.00 | ms/batch  7.23 | loss  2.99
INFO:root:| epoch   1 |   800/ 1520 batches | lr 20.00 | ms/batch  7.20 | loss  2.70
INFO:root:| epoch   1 |  1000/ 1520 batches | lr 20.00 | ms/batch  8.31 | loss  2.60
INFO:root:| epoch   1 |  1200/ 1520 batches | lr 20.00 | ms/batch  9.07 | loss  2.39
INFO:root:| epoch   1 |  1400/ 1520 batches | lr 20.00 | ms/batch  9.14 | loss  2.38
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   1 | time: 12.51s | valid loss  3.76 | valid ppl    42.80
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   2 |   200/ 1520 batches | lr 20.00 | ms/batch  7.25 | loss  2.28
INFO:root:| epoch   2 |   400/ 1520 batches | lr 20.00 | ms/batch  7.17 | loss  2.24
INFO:root:| epoch   2 |   600/ 1520 batches | lr 20.00 | ms/batch  9.07 | loss  2.19
INFO:root:| epoch   2 |   800/ 1520 batches | lr 20.00 | ms/batch  7.31 | loss  2.20
INFO:root:| epoch   2 |  1000/ 1520 batches | lr 20.00 | ms/batch  7.35 | loss  2.21
INFO:root:| epoch   2 |  1200/ 1520 batches | lr 20.00 | ms/batch  7.57 | loss  2.25
INFO:root:| epoch   2 |  1400/ 1520 batches | lr 20.00 | ms/batch  7.21 | loss  2.18
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   2 | time: 11.60s | valid loss  3.79 | valid ppl    44.41
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   3 |   200/ 1520 batches | lr 5.00 | ms/batch  7.27 | loss  2.18
INFO:root:| epoch   3 |   400/ 1520 batches | lr 5.00 | ms/batch  7.24 | loss  2.00
INFO:root:| epoch   3 |   600/ 1520 batches | lr 5.00 | ms/batch  7.23 | loss  1.93
INFO:root:| epoch   3 |   800/ 1520 batches | lr 5.00 | ms/batch  7.13 | loss  1.98
INFO:root:| epoch   3 |  1000/ 1520 batches | lr 5.00 | ms/batch  7.15 | loss  1.97
INFO:root:| epoch   3 |  1200/ 1520 batches | lr 5.00 | ms/batch  7.28 | loss  1.88
INFO:root:| epoch   3 |  1400/ 1520 batches | lr 5.00 | ms/batch  7.27 | loss  1.89
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   3 | time: 11.13s | valid loss  3.24 | valid ppl    25.48
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   4 |   200/ 1520 batches | lr 5.00 | ms/batch  8.54 | loss  1.97
INFO:root:| epoch   4 |   400/ 1520 batches | lr 5.00 | ms/batch  7.83 | loss  1.94
INFO:root:| epoch   4 |   600/ 1520 batches | lr 5.00 | ms/batch  7.16 | loss  1.84
INFO:root:| epoch   4 |   800/ 1520 batches | lr 5.00 | ms/batch  7.16 | loss  1.91
INFO:root:| epoch   4 |  1000/ 1520 batches | lr 5.00 | ms/batch  7.22 | loss  1.92
INFO:root:| epoch   4 |  1200/ 1520 batches | lr 5.00 | ms/batch  7.17 | loss  1.93
INFO:root:| epoch   4 |  1400/ 1520 batches | lr 5.00 | ms/batch  7.17 | loss  1.86
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   4 | time: 11.46s | valid loss  3.25 | valid ppl    25.75
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   5 |   200/ 1520 batches | lr 1.25 | ms/batch  7.28 | loss  2.16
INFO:root:| epoch   5 |   400/ 1520 batches | lr 1.25 | ms/batch  7.14 | loss  2.00
INFO:root:| epoch   5 |   600/ 1520 batches | lr 1.25 | ms/batch  7.14 | loss  2.04
INFO:root:| epoch   5 |   800/ 1520 batches | lr 1.25 | ms/batch  7.20 | loss  1.97
INFO:root:| epoch   5 |  1000/ 1520 batches | lr 1.25 | ms/batch  7.13 | loss  1.99
INFO:root:| epoch   5 |  1200/ 1520 batches | lr 1.25 | ms/batch  7.18 | loss  2.01
INFO:root:| epoch   5 |  1400/ 1520 batches | lr 1.25 | ms/batch  8.01 | loss  1.91
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   5 | time: 11.52s | valid loss  3.15 | valid ppl    23.25
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   6 |   200/ 1520 batches | lr 1.25 | ms/batch  7.31 | loss  2.08
INFO:root:| epoch   6 |   400/ 1520 batches | lr 1.25 | ms/batch  7.14 | loss  1.97
INFO:root:| epoch   6 |   600/ 1520 batches | lr 1.25 | ms/batch  8.98 | loss  2.00
INFO:root:| epoch   6 |   800/ 1520 batches | lr 1.25 | ms/batch  7.13 | loss  1.93
INFO:root:| epoch   6 |  1000/ 1520 batches | lr 1.25 | ms/batch  7.15 | loss  1.95
INFO:root:| epoch   6 |  1200/ 1520 batches | lr 1.25 | ms/batch  7.18 | loss  1.95
INFO:root:| epoch   6 |  1400/ 1520 batches | lr 1.25 | ms/batch  7.14 | loss  1.84
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   6 | time: 11.41s | valid loss  3.18 | valid ppl    24.04
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   7 |   200/ 1520 batches | lr 0.31 | ms/batch  7.18 | loss  2.13
INFO:root:| epoch   7 |   400/ 1520 batches | lr 0.31 | ms/batch  7.14 | loss  2.07
INFO:root:| epoch   7 |   600/ 1520 batches | lr 0.31 | ms/batch  7.12 | loss  2.02
INFO:root:| epoch   7 |   800/ 1520 batches | lr 0.31 | ms/batch  7.13 | loss  1.93
INFO:root:| epoch   7 |  1000/ 1520 batches | lr 0.31 | ms/batch  7.17 | loss  1.96
INFO:root:| epoch   7 |  1200/ 1520 batches | lr 0.31 | ms/batch  9.05 | loss  1.95
INFO:root:| epoch   7 |  1400/ 1520 batches | lr 0.31 | ms/batch  7.13 | loss  1.84
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   7 | time: 11.40s | valid loss  3.13 | valid ppl    22.91
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   8 |   200/ 1520 batches | lr 0.31 | ms/batch  7.28 | loss  2.05
INFO:root:| epoch   8 |   400/ 1520 batches | lr 0.31 | ms/batch  7.12 | loss  1.97
INFO:root:| epoch   8 |   600/ 1520 batches | lr 0.31 | ms/batch  7.19 | loss  1.97
INFO:root:| epoch   8 |   800/ 1520 batches | lr 0.31 | ms/batch  7.17 | loss  1.90
INFO:root:| epoch   8 |  1000/ 1520 batches | lr 0.31 | ms/batch  7.12 | loss  1.93
INFO:root:| epoch   8 |  1200/ 1520 batches | lr 0.31 | ms/batch  7.17 | loss  1.89
INFO:root:| epoch   8 |  1400/ 1520 batches | lr 0.31 | ms/batch  7.69 | loss  1.81
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   8 | time: 11.42s | valid loss  3.13 | valid ppl    22.96
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   9 |   200/ 1520 batches | lr 0.08 | ms/batch  7.25 | loss  2.11
INFO:root:| epoch   9 |   400/ 1520 batches | lr 0.08 | ms/batch  7.13 | loss  1.99
INFO:root:| epoch   9 |   600/ 1520 batches | lr 0.08 | ms/batch  8.98 | loss  1.99
INFO:root:| epoch   9 |   800/ 1520 batches | lr 0.08 | ms/batch  7.14 | loss  1.88
INFO:root:| epoch   9 |  1000/ 1520 batches | lr 0.08 | ms/batch  7.14 | loss  1.92
INFO:root:| epoch   9 |  1200/ 1520 batches | lr 0.08 | ms/batch  8.35 | loss  1.90
INFO:root:| epoch   9 |  1400/ 1520 batches | lr 0.08 | ms/batch  7.65 | loss  1.82
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   9 | time: 11.73s | valid loss  3.05 | valid ppl    21.08
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  10 |   200/ 1520 batches | lr 0.08 | ms/batch  7.24 | loss  2.03
INFO:root:| epoch  10 |   400/ 1520 batches | lr 0.08 | ms/batch  7.17 | loss  1.96
INFO:root:| epoch  10 |   600/ 1520 batches | lr 0.08 | ms/batch  7.65 | loss  1.98
INFO:root:| epoch  10 |   800/ 1520 batches | lr 0.08 | ms/batch  7.88 | loss  1.88
INFO:root:| epoch  10 |  1000/ 1520 batches | lr 0.08 | ms/batch  7.23 | loss  1.92
INFO:root:| epoch  10 |  1200/ 1520 batches | lr 0.08 | ms/batch  8.80 | loss  1.89
INFO:root:| epoch  10 |  1400/ 1520 batches | lr 0.08 | ms/batch  7.94 | loss  1.82
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  10 | time: 11.79s | valid loss  3.04 | valid ppl    20.94
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:=========================================================================================
INFO:root:| End of training | test loss  2.50 | test ppl    12.23
INFO:root:=========================================================================================
INFO:root:Namespace(cuda=False, train=False, test=True, save='model.pt')
INFO:root:Namespace(cuda=False, train=False, test=True, save='model.pt')
INFO:root:Namespace(cuda=False, train=False, test=True, save='model.pt')
INFO:root:Namespace(cuda=False, train=False, test=True, save='model.pt')
INFO:root:Namespace(cuda=False, train=False, test=True, save='model.pt')
INFO:root:Namespace(cuda=False, train=False, test=True, save='model.pt')
INFO:root:Namespace(cuda=False, train=False, test=True, save='model.pt')
INFO:root:Namespace(cuda=False, train=False, test=True, save='model.pt')
INFO:root:Namespace(cuda=False, train=False, test=True, save='model.pt')
INFO:root:Namespace(cuda=False, train=False, test=True, save='model.pt')
INFO:root:Namespace(cuda=False, train=True, test=False, save='model.pt')
INFO:root:Loading data
INFO:root:Vocab size 712
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:| epoch   1 |   200/ 1710 batches | lr 20.00 | ms/batch  9.60 | loss  2.83
INFO:root:| epoch   1 |   400/ 1710 batches | lr 20.00 | ms/batch  8.91 | loss  1.19
INFO:root:| epoch   1 |   600/ 1710 batches | lr 20.00 | ms/batch  7.39 | loss  0.69
INFO:root:| epoch   1 |   800/ 1710 batches | lr 20.00 | ms/batch  7.41 | loss  0.76
INFO:root:| epoch   1 |  1000/ 1710 batches | lr 20.00 | ms/batch  7.40 | loss  0.71
INFO:root:| epoch   1 |  1200/ 1710 batches | lr 20.00 | ms/batch  7.91 | loss  0.72
INFO:root:| epoch   1 |  1400/ 1710 batches | lr 20.00 | ms/batch  9.82 | loss  0.82
INFO:root:| epoch   1 |  1600/ 1710 batches | lr 20.00 | ms/batch  9.39 | loss  0.76
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   1 | time: 14.57s | valid loss  1.78 | valid ppl     5.96
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   2 |   200/ 1710 batches | lr 20.00 | ms/batch  7.58 | loss  0.75
INFO:root:| epoch   2 |   400/ 1710 batches | lr 20.00 | ms/batch  7.81 | loss  0.76
INFO:root:| epoch   2 |   600/ 1710 batches | lr 20.00 | ms/batch  8.02 | loss  0.72
INFO:root:| epoch   2 |   800/ 1710 batches | lr 20.00 | ms/batch  9.93 | loss  0.76
INFO:root:| epoch   2 |  1000/ 1710 batches | lr 20.00 | ms/batch  8.02 | loss  0.79
INFO:root:| epoch   2 |  1200/ 1710 batches | lr 20.00 | ms/batch  8.18 | loss  0.71
INFO:root:| epoch   2 |  1400/ 1710 batches | lr 20.00 | ms/batch  9.80 | loss  0.73
INFO:root:| epoch   2 |  1600/ 1710 batches | lr 20.00 | ms/batch  7.50 | loss  0.76
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   2 | time: 14.42s | valid loss  1.73 | valid ppl     5.64
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   3 |   200/ 1710 batches | lr 20.00 | ms/batch  9.98 | loss  0.76
INFO:root:| epoch   3 |   400/ 1710 batches | lr 20.00 | ms/batch  7.94 | loss  0.82
INFO:root:| epoch   3 |   600/ 1710 batches | lr 20.00 | ms/batch  7.66 | loss  0.75
INFO:root:| epoch   3 |   800/ 1710 batches | lr 20.00 | ms/batch  9.43 | loss  0.76
INFO:root:| epoch   3 |  1000/ 1710 batches | lr 20.00 | ms/batch  8.82 | loss  0.75
INFO:root:| epoch   3 |  1200/ 1710 batches | lr 20.00 | ms/batch  7.99 | loss  0.76
INFO:root:| epoch   3 |  1400/ 1710 batches | lr 20.00 | ms/batch  9.89 | loss  0.76
INFO:root:| epoch   3 |  1600/ 1710 batches | lr 20.00 | ms/batch  7.65 | loss  0.76
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   3 | time: 14.98s | valid loss  1.80 | valid ppl     6.06
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   4 |   200/ 1710 batches | lr 5.00 | ms/batch 11.02 | loss  0.43
INFO:root:| epoch   4 |   400/ 1710 batches | lr 5.00 | ms/batch  7.66 | loss  0.37
INFO:root:| epoch   4 |   600/ 1710 batches | lr 5.00 | ms/batch  7.67 | loss  0.36
INFO:root:| epoch   4 |   800/ 1710 batches | lr 5.00 | ms/batch  8.41 | loss  0.37
INFO:root:| epoch   4 |  1000/ 1710 batches | lr 5.00 | ms/batch  9.08 | loss  0.36
INFO:root:| epoch   4 |  1200/ 1710 batches | lr 5.00 | ms/batch  7.61 | loss  0.36
INFO:root:| epoch   4 |  1400/ 1710 batches | lr 5.00 | ms/batch  8.53 | loss  0.37
INFO:root:| epoch   4 |  1600/ 1710 batches | lr 5.00 | ms/batch  8.94 | loss  0.37
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   4 | time: 14.77s | valid loss  1.32 | valid ppl     3.74
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   5 |   200/ 1710 batches | lr 5.00 | ms/batch  8.62 | loss  0.36
INFO:root:| epoch   5 |   400/ 1710 batches | lr 5.00 | ms/batch 11.88 | loss  0.36
INFO:root:| epoch   5 |   600/ 1710 batches | lr 5.00 | ms/batch  7.55 | loss  0.35
INFO:root:| epoch   5 |   800/ 1710 batches | lr 5.00 | ms/batch  8.80 | loss  0.36
INFO:root:| epoch   5 |  1000/ 1710 batches | lr 5.00 | ms/batch  8.61 | loss  0.36
INFO:root:| epoch   5 |  1200/ 1710 batches | lr 5.00 | ms/batch  7.49 | loss  0.36
INFO:root:| epoch   5 |  1400/ 1710 batches | lr 5.00 | ms/batch  7.48 | loss  0.36
INFO:root:| epoch   5 |  1600/ 1710 batches | lr 5.00 | ms/batch  7.67 | loss  0.37
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   5 | time: 14.63s | valid loss  1.38 | valid ppl     3.97
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   6 |   200/ 1710 batches | lr 1.25 | ms/batch  9.94 | loss  0.30
INFO:root:| epoch   6 |   400/ 1710 batches | lr 1.25 | ms/batch  7.73 | loss  0.29
INFO:root:| epoch   6 |   600/ 1710 batches | lr 1.25 | ms/batch  7.62 | loss  0.27
INFO:root:| epoch   6 |   800/ 1710 batches | lr 1.25 | ms/batch  7.72 | loss  0.28
INFO:root:| epoch   6 |  1000/ 1710 batches | lr 1.25 | ms/batch  7.64 | loss  0.28
INFO:root:| epoch   6 |  1200/ 1710 batches | lr 1.25 | ms/batch  8.06 | loss  0.28
INFO:root:| epoch   6 |  1400/ 1710 batches | lr 1.25 | ms/batch  9.60 | loss  0.29
INFO:root:| epoch   6 |  1600/ 1710 batches | lr 1.25 | ms/batch  7.63 | loss  0.29
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   6 | time: 14.20s | valid loss  1.30 | valid ppl     3.68
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   7 |   200/ 1710 batches | lr 1.25 | ms/batch  7.82 | loss  0.28
INFO:root:| epoch   7 |   400/ 1710 batches | lr 1.25 | ms/batch  7.73 | loss  0.29
INFO:root:| epoch   7 |   600/ 1710 batches | lr 1.25 | ms/batch  7.69 | loss  0.27
INFO:root:| epoch   7 |   800/ 1710 batches | lr 1.25 | ms/batch  7.73 | loss  0.28
INFO:root:| epoch   7 |  1000/ 1710 batches | lr 1.25 | ms/batch  9.23 | loss  0.28
INFO:root:| epoch   7 |  1200/ 1710 batches | lr 1.25 | ms/batch  8.66 | loss  0.28
INFO:root:| epoch   7 |  1400/ 1710 batches | lr 1.25 | ms/batch  7.87 | loss  0.29
INFO:root:| epoch   7 |  1600/ 1710 batches | lr 1.25 | ms/batch  9.47 | loss  0.29
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   7 | time: 14.37s | valid loss  1.31 | valid ppl     3.70
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   8 |   200/ 1710 batches | lr 0.31 | ms/batch  7.90 | loss  0.27
INFO:root:| epoch   8 |   400/ 1710 batches | lr 0.31 | ms/batch  9.89 | loss  0.27
INFO:root:| epoch   8 |   600/ 1710 batches | lr 0.31 | ms/batch  9.14 | loss  0.26
INFO:root:| epoch   8 |   800/ 1710 batches | lr 0.31 | ms/batch  7.81 | loss  0.26
INFO:root:| epoch   8 |  1000/ 1710 batches | lr 0.31 | ms/batch  8.02 | loss  0.26
INFO:root:| epoch   8 |  1200/ 1710 batches | lr 0.31 | ms/batch  8.95 | loss  0.26
INFO:root:| epoch   8 |  1400/ 1710 batches | lr 0.31 | ms/batch  7.76 | loss  0.27
INFO:root:| epoch   8 |  1600/ 1710 batches | lr 0.31 | ms/batch  9.13 | loss  0.27
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   8 | time: 14.95s | valid loss  1.29 | valid ppl     3.62
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   9 |   200/ 1710 batches | lr 0.31 | ms/batch  8.34 | loss  0.26
INFO:root:| epoch   9 |   400/ 1710 batches | lr 0.31 | ms/batch  8.00 | loss  0.27
INFO:root:| epoch   9 |   600/ 1710 batches | lr 0.31 | ms/batch  7.89 | loss  0.25
INFO:root:| epoch   9 |   800/ 1710 batches | lr 0.31 | ms/batch  8.90 | loss  0.26
INFO:root:| epoch   9 |  1000/ 1710 batches | lr 0.31 | ms/batch  9.32 | loss  0.26
INFO:root:| epoch   9 |  1200/ 1710 batches | lr 0.31 | ms/batch  7.92 | loss  0.26
INFO:root:| epoch   9 |  1400/ 1710 batches | lr 0.31 | ms/batch  9.14 | loss  0.27
INFO:root:| epoch   9 |  1600/ 1710 batches | lr 0.31 | ms/batch  8.77 | loss  0.27
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   9 | time: 14.68s | valid loss  1.29 | valid ppl     3.63
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  10 |   200/ 1710 batches | lr 0.08 | ms/batch  7.96 | loss  0.26
INFO:root:| epoch  10 |   400/ 1710 batches | lr 0.08 | ms/batch  7.93 | loss  0.27
INFO:root:| epoch  10 |   600/ 1710 batches | lr 0.08 | ms/batch 10.58 | loss  0.25
INFO:root:| epoch  10 |   800/ 1710 batches | lr 0.08 | ms/batch 10.25 | loss  0.26
INFO:root:| epoch  10 |  1000/ 1710 batches | lr 0.08 | ms/batch  8.11 | loss  0.26
INFO:root:| epoch  10 |  1200/ 1710 batches | lr 0.08 | ms/batch  8.11 | loss  0.26
INFO:root:| epoch  10 |  1400/ 1710 batches | lr 0.08 | ms/batch 10.41 | loss  0.26
INFO:root:| epoch  10 |  1600/ 1710 batches | lr 0.08 | ms/batch  9.07 | loss  0.27
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  10 | time: 15.53s | valid loss  1.29 | valid ppl     3.62
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:=========================================================================================
INFO:root:| End of training | test loss  1.47 | test ppl     4.37
INFO:root:=========================================================================================
INFO:root:Namespace(cuda=False, train=False, test=True, save='model.pt')
INFO:root:Namespace(cuda=False, train=True, test=False, save='model.pt')
INFO:root:Loading data
INFO:root:Vocab size 712
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:| epoch   1 |   200/ 1710 batches | lr 20.00 | ms/batch 11.86 | loss  2.84
INFO:root:| epoch   1 |   400/ 1710 batches | lr 20.00 | ms/batch  8.69 | loss  1.05
INFO:root:| epoch   1 |   600/ 1710 batches | lr 20.00 | ms/batch  8.88 | loss  0.89
INFO:root:| epoch   1 |   800/ 1710 batches | lr 20.00 | ms/batch 11.05 | loss  0.83
INFO:root:| epoch   1 |  1000/ 1710 batches | lr 20.00 | ms/batch  7.21 | loss  0.84
INFO:root:| epoch   1 |  1200/ 1710 batches | lr 20.00 | ms/batch  8.08 | loss  0.87
INFO:root:| epoch   1 |  1400/ 1710 batches | lr 20.00 | ms/batch 10.90 | loss  0.84
INFO:root:| epoch   1 |  1600/ 1710 batches | lr 20.00 | ms/batch  7.39 | loss  0.88
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   1 | time: 15.88s | valid loss  1.69 | valid ppl     5.41
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   2 |   200/ 1710 batches | lr 20.00 | ms/batch  9.84 | loss  0.90
INFO:root:| epoch   2 |   400/ 1710 batches | lr 20.00 | ms/batch  7.27 | loss  0.91
INFO:root:| epoch   2 |   600/ 1710 batches | lr 20.00 | ms/batch  7.33 | loss  0.88
INFO:root:| epoch   2 |   800/ 1710 batches | lr 20.00 | ms/batch  9.08 | loss  0.94
INFO:root:| epoch   2 |  1000/ 1710 batches | lr 20.00 | ms/batch  7.57 | loss  0.88
INFO:root:| epoch   2 |  1200/ 1710 batches | lr 20.00 | ms/batch  7.27 | loss  0.93
INFO:root:| epoch   2 |  1400/ 1710 batches | lr 20.00 | ms/batch  7.26 | loss  0.94
INFO:root:| epoch   2 |  1600/ 1710 batches | lr 20.00 | ms/batch  7.41 | loss  0.97
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   2 | time: 13.56s | valid loss  1.42 | valid ppl     4.16
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   3 |   200/ 1710 batches | lr 20.00 | ms/batch  7.87 | loss  0.92
INFO:root:| epoch   3 |   400/ 1710 batches | lr 20.00 | ms/batch  9.21 | loss  0.98
INFO:root:| epoch   3 |   600/ 1710 batches | lr 20.00 | ms/batch  9.66 | loss  0.92
INFO:root:| epoch   3 |   800/ 1710 batches | lr 20.00 | ms/batch  7.47 | loss  0.91
INFO:root:| epoch   3 |  1000/ 1710 batches | lr 20.00 | ms/batch  9.44 | loss  0.92
INFO:root:| epoch   3 |  1200/ 1710 batches | lr 20.00 | ms/batch  7.41 | loss  0.96
INFO:root:| epoch   3 |  1400/ 1710 batches | lr 20.00 | ms/batch  7.42 | loss  0.90
INFO:root:| epoch   3 |  1600/ 1710 batches | lr 20.00 | ms/batch  9.76 | loss  0.96
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   3 | time: 14.68s | valid loss  1.77 | valid ppl     5.89
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   4 |   200/ 1710 batches | lr 5.00 | ms/batch  7.56 | loss  0.52
INFO:root:| epoch   4 |   400/ 1710 batches | lr 5.00 | ms/batch  7.72 | loss  0.42
INFO:root:| epoch   4 |   600/ 1710 batches | lr 5.00 | ms/batch  7.50 | loss  0.39
INFO:root:| epoch   4 |   800/ 1710 batches | lr 5.00 | ms/batch  8.52 | loss  0.40
INFO:root:| epoch   4 |  1000/ 1710 batches | lr 5.00 | ms/batch  9.99 | loss  0.39
INFO:root:| epoch   4 |  1200/ 1710 batches | lr 5.00 | ms/batch 12.93 | loss  0.39
INFO:root:| epoch   4 |  1400/ 1710 batches | lr 5.00 | ms/batch  8.12 | loss  0.39
INFO:root:| epoch   4 |  1600/ 1710 batches | lr 5.00 | ms/batch  7.65 | loss  0.39
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   4 | time: 14.99s | valid loss  1.27 | valid ppl     3.56
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   5 |   200/ 1710 batches | lr 5.00 | ms/batch  8.48 | loss  0.40
INFO:root:| epoch   5 |   400/ 1710 batches | lr 5.00 | ms/batch  9.37 | loss  0.41
INFO:root:| epoch   5 |   600/ 1710 batches | lr 5.00 | ms/batch  7.78 | loss  0.38
INFO:root:| epoch   5 |   800/ 1710 batches | lr 5.00 | ms/batch  7.58 | loss  0.39
INFO:root:| epoch   5 |  1000/ 1710 batches | lr 5.00 | ms/batch  7.67 | loss  0.39
INFO:root:| epoch   5 |  1200/ 1710 batches | lr 5.00 | ms/batch  7.61 | loss  0.39
INFO:root:| epoch   5 |  1400/ 1710 batches | lr 5.00 | ms/batch  7.77 | loss  0.39
INFO:root:| epoch   5 |  1600/ 1710 batches | lr 5.00 | ms/batch  9.94 | loss  0.39
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   5 | time: 14.24s | valid loss  1.26 | valid ppl     3.53
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   6 |   200/ 1710 batches | lr 5.00 | ms/batch  7.87 | loss  0.40
INFO:root:| epoch   6 |   400/ 1710 batches | lr 5.00 | ms/batch  9.66 | loss  0.41
INFO:root:| epoch   6 |   600/ 1710 batches | lr 5.00 | ms/batch  8.09 | loss  0.38
INFO:root:| epoch   6 |   800/ 1710 batches | lr 5.00 | ms/batch  7.71 | loss  0.39
INFO:root:| epoch   6 |  1000/ 1710 batches | lr 5.00 | ms/batch  9.87 | loss  0.39
INFO:root:| epoch   6 |  1200/ 1710 batches | lr 5.00 | ms/batch  7.93 | loss  0.39
INFO:root:| epoch   6 |  1400/ 1710 batches | lr 5.00 | ms/batch  7.78 | loss  0.39
INFO:root:| epoch   6 |  1600/ 1710 batches | lr 5.00 | ms/batch  7.60 | loss  0.39
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   6 | time: 14.30s | valid loss  1.29 | valid ppl     3.65
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   7 |   200/ 1710 batches | lr 1.25 | ms/batch 10.14 | loss  0.33
INFO:root:| epoch   7 |   400/ 1710 batches | lr 1.25 | ms/batch  7.90 | loss  0.33
INFO:root:| epoch   7 |   600/ 1710 batches | lr 1.25 | ms/batch  8.26 | loss  0.30
INFO:root:| epoch   7 |   800/ 1710 batches | lr 1.25 | ms/batch  9.56 | loss  0.30
INFO:root:| epoch   7 |  1000/ 1710 batches | lr 1.25 | ms/batch  7.79 | loss  0.30
INFO:root:| epoch   7 |  1200/ 1710 batches | lr 1.25 | ms/batch  8.27 | loss  0.29
INFO:root:| epoch   7 |  1400/ 1710 batches | lr 1.25 | ms/batch  9.76 | loss  0.30
INFO:root:| epoch   7 |  1600/ 1710 batches | lr 1.25 | ms/batch 10.60 | loss  0.30
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   7 | time: 16.07s | valid loss  1.19 | valid ppl     3.27
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   8 |   200/ 1710 batches | lr 1.25 | ms/batch  9.66 | loss  0.30
INFO:root:| epoch   8 |   400/ 1710 batches | lr 1.25 | ms/batch  8.04 | loss  0.32
INFO:root:| epoch   8 |   600/ 1710 batches | lr 1.25 | ms/batch  8.07 | loss  0.29
INFO:root:| epoch   8 |   800/ 1710 batches | lr 1.25 | ms/batch  8.23 | loss  0.30
INFO:root:| epoch   8 |  1000/ 1710 batches | lr 1.25 | ms/batch  8.68 | loss  0.29
INFO:root:| epoch   8 |  1200/ 1710 batches | lr 1.25 | ms/batch  9.26 | loss  0.29
INFO:root:| epoch   8 |  1400/ 1710 batches | lr 1.25 | ms/batch  9.19 | loss  0.29
INFO:root:| epoch   8 |  1600/ 1710 batches | lr 1.25 | ms/batch  8.17 | loss  0.29
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   8 | time: 15.01s | valid loss  1.18 | valid ppl     3.26
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   9 |   200/ 1710 batches | lr 1.25 | ms/batch  9.39 | loss  0.30
INFO:root:| epoch   9 |   400/ 1710 batches | lr 1.25 | ms/batch  7.84 | loss  0.32
INFO:root:| epoch   9 |   600/ 1710 batches | lr 1.25 | ms/batch  8.63 | loss  0.29
INFO:root:| epoch   9 |   800/ 1710 batches | lr 1.25 | ms/batch  9.19 | loss  0.30
INFO:root:| epoch   9 |  1000/ 1710 batches | lr 1.25 | ms/batch  8.10 | loss  0.29
INFO:root:| epoch   9 |  1200/ 1710 batches | lr 1.25 | ms/batch  8.94 | loss  0.29
INFO:root:| epoch   9 |  1400/ 1710 batches | lr 1.25 | ms/batch  8.69 | loss  0.29
INFO:root:| epoch   9 |  1600/ 1710 batches | lr 1.25 | ms/batch  7.93 | loss  0.29
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   9 | time: 14.79s | valid loss  1.18 | valid ppl     3.27
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  10 |   200/ 1710 batches | lr 0.31 | ms/batch 10.32 | loss  0.29
INFO:root:| epoch  10 |   400/ 1710 batches | lr 0.31 | ms/batch  8.04 | loss  0.30
INFO:root:| epoch  10 |   600/ 1710 batches | lr 0.31 | ms/batch  7.91 | loss  0.27
INFO:root:| epoch  10 |   800/ 1710 batches | lr 0.31 | ms/batch 10.00 | loss  0.27
INFO:root:| epoch  10 |  1000/ 1710 batches | lr 0.31 | ms/batch  8.21 | loss  0.27
INFO:root:| epoch  10 |  1200/ 1710 batches | lr 0.31 | ms/batch  8.40 | loss  0.27
INFO:root:| epoch  10 |  1400/ 1710 batches | lr 0.31 | ms/batch  9.75 | loss  0.27
INFO:root:| epoch  10 |  1600/ 1710 batches | lr 0.31 | ms/batch  7.78 | loss  0.27
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  10 | time: 15.10s | valid loss  1.16 | valid ppl     3.20
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:=========================================================================================
INFO:root:| End of training | test loss  1.20 | test ppl     3.31
INFO:root:=========================================================================================
INFO:root:Namespace(cuda=False, train=False, test=True, save='model.pt')
INFO:root:Namespace(cuda=False, train=False, test=True, save='model.pt')
INFO:root:Namespace(cuda=False, train=False, test=True, save='model.pt')
INFO:root:Vocab file not found, creating new vocab file.
INFO:root:Namespace(cuda=False, train=False, test=True, save='model.pt')
INFO:root:Namespace(cuda=False, train=False, test=True, save='model.pt')
INFO:root:Namespace(cuda=False, train=False, test=True, save='model.pt')
INFO:root:Namespace(cuda=False, train=True, test=False, save='model.pt')
INFO:root:Loading data
INFO:root:Vocab size 744
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:| epoch   1 |   200/ 1710 batches | lr 20.00 | ms/batch  9.77 | loss  3.95
INFO:root:| epoch   1 |   400/ 1710 batches | lr 20.00 | ms/batch  8.35 | loss  2.38
INFO:root:| epoch   1 |   600/ 1710 batches | lr 20.00 | ms/batch 14.46 | loss  2.36
INFO:root:| epoch   1 |   800/ 1710 batches | lr 20.00 | ms/batch 18.52 | loss  2.15
INFO:root:| epoch   1 |  1000/ 1710 batches | lr 20.00 | ms/batch 17.27 | loss  2.04
INFO:root:| epoch   1 |  1200/ 1710 batches | lr 20.00 | ms/batch  7.65 | loss  2.11
INFO:root:| epoch   1 |  1400/ 1710 batches | lr 20.00 | ms/batch  9.16 | loss  2.16
INFO:root:| epoch   1 |  1600/ 1710 batches | lr 20.00 | ms/batch  8.17 | loss  2.17
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   1 | time: 19.63s | valid loss  3.91 | valid ppl    49.87
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   2 |   200/ 1710 batches | lr 20.00 | ms/batch  8.50 | loss  2.23
INFO:root:| epoch   2 |   400/ 1710 batches | lr 20.00 | ms/batch 10.51 | loss  2.09
INFO:root:| epoch   2 |   600/ 1710 batches | lr 20.00 | ms/batch 22.77 | loss  1.99
INFO:root:| epoch   2 |   800/ 1710 batches | lr 20.00 | ms/batch  8.93 | loss  1.87
INFO:root:| epoch   2 |  1000/ 1710 batches | lr 20.00 | ms/batch  9.38 | loss  1.82
INFO:root:| epoch   2 |  1200/ 1710 batches | lr 20.00 | ms/batch  8.63 | loss  1.99
INFO:root:| epoch   2 |  1400/ 1710 batches | lr 20.00 | ms/batch  7.78 | loss  1.96
INFO:root:| epoch   2 |  1600/ 1710 batches | lr 20.00 | ms/batch  7.93 | loss  2.07
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   2 | time: 17.86s | valid loss  3.80 | valid ppl    44.81
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   3 |   200/ 1710 batches | lr 20.00 | ms/batch  7.57 | loss  2.13
INFO:root:| epoch   3 |   400/ 1710 batches | lr 20.00 | ms/batch  9.72 | loss  1.99
INFO:root:| epoch   3 |   600/ 1710 batches | lr 20.00 | ms/batch  7.58 | loss  1.80
INFO:root:| epoch   3 |   800/ 1710 batches | lr 20.00 | ms/batch  7.53 | loss  1.81
INFO:root:| epoch   3 |  1000/ 1710 batches | lr 20.00 | ms/batch  7.48 | loss  1.75
INFO:root:| epoch   3 |  1200/ 1710 batches | lr 20.00 | ms/batch  9.53 | loss  1.83
INFO:root:| epoch   3 |  1400/ 1710 batches | lr 20.00 | ms/batch  8.03 | loss  1.82
INFO:root:| epoch   3 |  1600/ 1710 batches | lr 20.00 | ms/batch  7.70 | loss  1.91
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   3 | time: 14.27s | valid loss  3.95 | valid ppl    51.96
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   4 |   200/ 1710 batches | lr 5.00 | ms/batch 10.19 | loss  2.01
INFO:root:| epoch   4 |   400/ 1710 batches | lr 5.00 | ms/batch  9.04 | loss  1.87
INFO:root:| epoch   4 |   600/ 1710 batches | lr 5.00 | ms/batch  8.73 | loss  1.77
INFO:root:| epoch   4 |   800/ 1710 batches | lr 5.00 | ms/batch  9.13 | loss  1.67
INFO:root:| epoch   4 |  1000/ 1710 batches | lr 5.00 | ms/batch 12.99 | loss  1.65
INFO:root:| epoch   4 |  1200/ 1710 batches | lr 5.00 | ms/batch 14.12 | loss  1.67
INFO:root:| epoch   4 |  1400/ 1710 batches | lr 5.00 | ms/batch 14.09 | loss  1.63
INFO:root:| epoch   4 |  1600/ 1710 batches | lr 5.00 | ms/batch  8.21 | loss  1.63
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   4 | time: 18.74s | valid loss  3.50 | valid ppl    33.18
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   5 |   200/ 1710 batches | lr 5.00 | ms/batch  7.86 | loss  1.79
INFO:root:| epoch   5 |   400/ 1710 batches | lr 5.00 | ms/batch  8.62 | loss  1.66
INFO:root:| epoch   5 |   600/ 1710 batches | lr 5.00 | ms/batch 24.00 | loss  1.57
INFO:root:| epoch   5 |   800/ 1710 batches | lr 5.00 | ms/batch 52.48 | loss  1.59
INFO:root:| epoch   5 |  1000/ 1710 batches | lr 5.00 | ms/batch 16.41 | loss  1.52
INFO:root:| epoch   5 |  1200/ 1710 batches | lr 5.00 | ms/batch 10.60 | loss  1.55
INFO:root:| epoch   5 |  1400/ 1710 batches | lr 5.00 | ms/batch 18.05 | loss  1.50
INFO:root:| epoch   5 |  1600/ 1710 batches | lr 5.00 | ms/batch 11.56 | loss  1.53
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   5 | time: 32.39s | valid loss  3.63 | valid ppl    37.72
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   6 |   200/ 1710 batches | lr 1.25 | ms/batch 15.42 | loss  1.96
INFO:root:| epoch   6 |   400/ 1710 batches | lr 1.25 | ms/batch 12.66 | loss  1.85
INFO:root:| epoch   6 |   600/ 1710 batches | lr 1.25 | ms/batch 14.13 | loss  1.67
INFO:root:| epoch   6 |   800/ 1710 batches | lr 1.25 | ms/batch 10.82 | loss  1.67
INFO:root:| epoch   6 |  1000/ 1710 batches | lr 1.25 | ms/batch 10.59 | loss  1.70
INFO:root:| epoch   6 |  1200/ 1710 batches | lr 1.25 | ms/batch 16.62 | loss  1.69
INFO:root:| epoch   6 |  1400/ 1710 batches | lr 1.25 | ms/batch 16.64 | loss  1.69
INFO:root:| epoch   6 |  1600/ 1710 batches | lr 1.25 | ms/batch 10.46 | loss  1.60
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   6 | time: 23.47s | valid loss  3.39 | valid ppl    29.71
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   7 |   200/ 1710 batches | lr 1.25 | ms/batch  9.87 | loss  1.81
INFO:root:| epoch   7 |   400/ 1710 batches | lr 1.25 | ms/batch 11.47 | loss  1.69
INFO:root:| epoch   7 |   600/ 1710 batches | lr 1.25 | ms/batch 14.82 | loss  1.57
INFO:root:| epoch   7 |   800/ 1710 batches | lr 1.25 | ms/batch 11.47 | loss  1.61
INFO:root:| epoch   7 |  1000/ 1710 batches | lr 1.25 | ms/batch 11.43 | loss  1.61
INFO:root:| epoch   7 |  1200/ 1710 batches | lr 1.25 | ms/batch 13.49 | loss  1.62
INFO:root:| epoch   7 |  1400/ 1710 batches | lr 1.25 | ms/batch 17.94 | loss  1.62
INFO:root:| epoch   7 |  1600/ 1710 batches | lr 1.25 | ms/batch 13.12 | loss  1.50
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   7 | time: 22.58s | valid loss  3.44 | valid ppl    31.34
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   8 |   200/ 1710 batches | lr 0.31 | ms/batch 14.25 | loss  1.88
INFO:root:| epoch   8 |   400/ 1710 batches | lr 0.31 | ms/batch  9.55 | loss  1.71
INFO:root:| epoch   8 |   600/ 1710 batches | lr 0.31 | ms/batch 11.05 | loss  1.81
INFO:root:| epoch   8 |   800/ 1710 batches | lr 0.31 | ms/batch 10.80 | loss  1.81
INFO:root:| epoch   8 |  1000/ 1710 batches | lr 0.31 | ms/batch  8.80 | loss  1.72
INFO:root:| epoch   8 |  1200/ 1710 batches | lr 0.31 | ms/batch  9.64 | loss  1.69
INFO:root:| epoch   8 |  1400/ 1710 batches | lr 0.31 | ms/batch  9.16 | loss  1.66
INFO:root:| epoch   8 |  1600/ 1710 batches | lr 0.31 | ms/batch  8.13 | loss  1.67
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   8 | time: 17.25s | valid loss  3.40 | valid ppl    29.97
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   9 |   200/ 1710 batches | lr 0.08 | ms/batch 12.94 | loss  1.97
INFO:root:| epoch   9 |   400/ 1710 batches | lr 0.08 | ms/batch  8.79 | loss  2.01
INFO:root:| epoch   9 |   600/ 1710 batches | lr 0.08 | ms/batch 10.14 | loss  2.00
INFO:root:| epoch   9 |   800/ 1710 batches | lr 0.08 | ms/batch 10.14 | loss  1.95
INFO:root:| epoch   9 |  1000/ 1710 batches | lr 0.08 | ms/batch 12.33 | loss  1.90
INFO:root:| epoch   9 |  1200/ 1710 batches | lr 0.08 | ms/batch  9.96 | loss  1.79
INFO:root:| epoch   9 |  1400/ 1710 batches | lr 0.08 | ms/batch  7.68 | loss  1.66
INFO:root:| epoch   9 |  1600/ 1710 batches | lr 0.08 | ms/batch  8.41 | loss  1.68
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   9 | time: 17.10s | valid loss  3.33 | valid ppl    27.91
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  10 |   200/ 1710 batches | lr 0.08 | ms/batch  7.71 | loss  1.92
INFO:root:| epoch  10 |   400/ 1710 batches | lr 0.08 | ms/batch  7.56 | loss  1.89
INFO:root:| epoch  10 |   600/ 1710 batches | lr 0.08 | ms/batch  7.67 | loss  1.86
INFO:root:| epoch  10 |   800/ 1710 batches | lr 0.08 | ms/batch  7.59 | loss  1.85
INFO:root:| epoch  10 |  1000/ 1710 batches | lr 0.08 | ms/batch  7.52 | loss  1.78
INFO:root:| epoch  10 |  1200/ 1710 batches | lr 0.08 | ms/batch  7.38 | loss  1.77
INFO:root:| epoch  10 |  1400/ 1710 batches | lr 0.08 | ms/batch  7.54 | loss  1.68
INFO:root:| epoch  10 |  1600/ 1710 batches | lr 0.08 | ms/batch  9.85 | loss  1.71
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  10 | time: 13.55s | valid loss  3.32 | valid ppl    27.66
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:=========================================================================================
INFO:root:| End of training | test loss  2.94 | test ppl    18.92
INFO:root:=========================================================================================
INFO:root:Namespace(cuda=False, train=False, test=True, save='model.pt')
INFO:root:Namespace(cuda=False, train=True, test=False)
INFO:root:Loading data
INFO:root:Namespace(cuda=False, train=True, test=False)
INFO:root:Loading data
INFO:root:Vocab size 2005
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:| epoch   1 |   200/ 1710 batches | lr 20.00 | ms/batch  7.62 | loss  4.36
INFO:root:| epoch   1 |   400/ 1710 batches | lr 20.00 | ms/batch  5.61 | loss  3.36
INFO:root:| epoch   1 |   600/ 1710 batches | lr 20.00 | ms/batch  5.44 | loss  3.27
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:Exiting from training early
INFO:root:Namespace(cuda=False, train=True, test=False)
INFO:root:Namespace(cuda=False, train=True, test=False)
INFO:root:----------- new value of n = 1, k = 1 -----------
INFO:root:Loading data
INFO:root:Vocab size 2005
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:| epoch   1 |   200/ 1710 batches | lr 20.00 | ms/batch  5.58 | loss  4.36
INFO:root:| epoch   1 |   400/ 1710 batches | lr 20.00 | ms/batch  5.92 | loss  3.36
INFO:root:| epoch   1 |   600/ 1710 batches | lr 20.00 | ms/batch  6.07 | loss  3.27
INFO:root:| epoch   1 |   800/ 1710 batches | lr 20.00 | ms/batch  5.17 | loss  3.15
INFO:root:| epoch   1 |  1000/ 1710 batches | lr 20.00 | ms/batch  5.12 | loss  3.18
INFO:root:| epoch   1 |  1200/ 1710 batches | lr 20.00 | ms/batch  5.04 | loss  3.11
INFO:root:| epoch   1 |  1400/ 1710 batches | lr 20.00 | ms/batch  5.04 | loss  3.05
INFO:root:| epoch   1 |  1600/ 1710 batches | lr 20.00 | ms/batch  5.05 | loss  3.02
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   1 | time:  9.23s | valid loss  3.59 | valid ppl    36.22
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   2 |   200/ 1710 batches | lr 20.00 | ms/batch  5.13 | loss  3.07
INFO:root:| epoch   2 |   400/ 1710 batches | lr 20.00 | ms/batch  4.93 | loss  3.06
INFO:root:| epoch   2 |   600/ 1710 batches | lr 20.00 | ms/batch  5.69 | loss  3.04
INFO:root:| epoch   2 |   800/ 1710 batches | lr 20.00 | ms/batch  6.09 | loss  2.97
INFO:root:| epoch   2 |  1000/ 1710 batches | lr 20.00 | ms/batch  4.89 | loss  3.03
INFO:root:| epoch   2 |  1200/ 1710 batches | lr 20.00 | ms/batch  4.92 | loss  2.98
INFO:root:| epoch   2 |  1400/ 1710 batches | lr 20.00 | ms/batch  4.98 | loss  2.93
INFO:root:| epoch   2 |  1600/ 1710 batches | lr 20.00 | ms/batch  6.16 | loss  2.95
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   2 | time:  9.31s | valid loss  3.54 | valid ppl    34.33
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   3 |   200/ 1710 batches | lr 20.00 | ms/batch  5.02 | loss  3.00
INFO:root:| epoch   3 |   400/ 1710 batches | lr 20.00 | ms/batch  5.00 | loss  2.95
INFO:root:| epoch   3 |   600/ 1710 batches | lr 20.00 | ms/batch  4.96 | loss  2.91
INFO:root:| epoch   3 |   800/ 1710 batches | lr 20.00 | ms/batch  6.92 | loss  2.87
INFO:root:| epoch   3 |  1000/ 1710 batches | lr 20.00 | ms/batch  5.50 | loss  2.91
INFO:root:| epoch   3 |  1200/ 1710 batches | lr 20.00 | ms/batch  5.10 | loss  2.89
INFO:root:| epoch   3 |  1400/ 1710 batches | lr 20.00 | ms/batch  4.99 | loss  2.87
INFO:root:| epoch   3 |  1600/ 1710 batches | lr 20.00 | ms/batch  5.03 | loss  2.86
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   3 | time:  9.14s | valid loss  3.60 | valid ppl    36.49
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   4 |   200/ 1710 batches | lr 5.00 | ms/batch  5.09 | loss  2.67
INFO:root:| epoch   4 |   400/ 1710 batches | lr 5.00 | ms/batch  5.08 | loss  2.57
INFO:root:| epoch   4 |   600/ 1710 batches | lr 5.00 | ms/batch  5.01 | loss  2.48
INFO:root:| epoch   4 |   800/ 1710 batches | lr 5.00 | ms/batch  5.01 | loss  2.51
INFO:root:| epoch   4 |  1000/ 1710 batches | lr 5.00 | ms/batch  6.13 | loss  2.45
INFO:root:| epoch   4 |  1200/ 1710 batches | lr 5.00 | ms/batch  6.74 | loss  2.42
INFO:root:| epoch   4 |  1400/ 1710 batches | lr 5.00 | ms/batch  5.30 | loss  2.37
INFO:root:| epoch   4 |  1600/ 1710 batches | lr 5.00 | ms/batch  5.18 | loss  2.32
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   4 | time:  9.35s | valid loss  3.15 | valid ppl    23.40
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   5 |   200/ 1710 batches | lr 5.00 | ms/batch  6.92 | loss  2.45
INFO:root:| epoch   5 |   400/ 1710 batches | lr 5.00 | ms/batch  5.27 | loss  2.43
INFO:root:| epoch   5 |   600/ 1710 batches | lr 5.00 | ms/batch  5.07 | loss  2.35
INFO:root:| epoch   5 |   800/ 1710 batches | lr 5.00 | ms/batch  5.03 | loss  2.35
INFO:root:| epoch   5 |  1000/ 1710 batches | lr 5.00 | ms/batch  5.70 | loss  2.32
INFO:root:| epoch   5 |  1200/ 1710 batches | lr 5.00 | ms/batch  6.13 | loss  2.30
INFO:root:| epoch   5 |  1400/ 1710 batches | lr 5.00 | ms/batch  5.13 | loss  2.30
INFO:root:| epoch   5 |  1600/ 1710 batches | lr 5.00 | ms/batch  5.15 | loss  2.26
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   5 | time:  9.52s | valid loss  3.21 | valid ppl    24.89
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   6 |   200/ 1710 batches | lr 1.25 | ms/batch  5.24 | loss  2.36
INFO:root:| epoch   6 |   400/ 1710 batches | lr 1.25 | ms/batch  6.05 | loss  2.39
INFO:root:| epoch   6 |   600/ 1710 batches | lr 1.25 | ms/batch  5.17 | loss  2.35
INFO:root:| epoch   6 |   800/ 1710 batches | lr 1.25 | ms/batch  5.17 | loss  2.32
INFO:root:| epoch   6 |  1000/ 1710 batches | lr 1.25 | ms/batch  5.06 | loss  2.29
INFO:root:| epoch   6 |  1200/ 1710 batches | lr 1.25 | ms/batch  5.16 | loss  2.21
INFO:root:| epoch   6 |  1400/ 1710 batches | lr 1.25 | ms/batch  6.30 | loss  2.16
INFO:root:| epoch   6 |  1600/ 1710 batches | lr 1.25 | ms/batch  5.73 | loss  2.12
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   6 | time:  9.42s | valid loss  3.11 | valid ppl    22.49
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   7 |   200/ 1710 batches | lr 1.25 | ms/batch  5.27 | loss  2.30
INFO:root:| epoch   7 |   400/ 1710 batches | lr 1.25 | ms/batch  5.26 | loss  2.29
INFO:root:| epoch   7 |   600/ 1710 batches | lr 1.25 | ms/batch  6.63 | loss  2.24
INFO:root:| epoch   7 |   800/ 1710 batches | lr 1.25 | ms/batch  5.16 | loss  2.24
INFO:root:| epoch   7 |  1000/ 1710 batches | lr 1.25 | ms/batch  5.09 | loss  2.21
INFO:root:| epoch   7 |  1200/ 1710 batches | lr 1.25 | ms/batch  5.11 | loss  2.16
INFO:root:| epoch   7 |  1400/ 1710 batches | lr 1.25 | ms/batch  5.09 | loss  2.16
INFO:root:| epoch   7 |  1600/ 1710 batches | lr 1.25 | ms/batch  5.11 | loss  2.12
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   7 | time:  9.17s | valid loss  3.13 | valid ppl    22.93
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   8 |   200/ 1710 batches | lr 0.31 | ms/batch  5.33 | loss  2.27
INFO:root:| epoch   8 |   400/ 1710 batches | lr 0.31 | ms/batch  5.15 | loss  2.31
INFO:root:| epoch   8 |   600/ 1710 batches | lr 0.31 | ms/batch  5.08 | loss  2.31
INFO:root:| epoch   8 |   800/ 1710 batches | lr 0.31 | ms/batch  5.12 | loss  2.25
INFO:root:| epoch   8 |  1000/ 1710 batches | lr 0.31 | ms/batch  5.08 | loss  2.22
INFO:root:| epoch   8 |  1200/ 1710 batches | lr 0.31 | ms/batch  5.17 | loss  2.15
INFO:root:| epoch   8 |  1400/ 1710 batches | lr 0.31 | ms/batch  5.12 | loss  2.09
INFO:root:| epoch   8 |  1600/ 1710 batches | lr 0.31 | ms/batch  5.99 | loss  2.05
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   8 | time:  9.18s | valid loss  3.10 | valid ppl    22.20
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   9 |   200/ 1710 batches | lr 0.31 | ms/batch  8.76 | loss  2.25
INFO:root:| epoch   9 |   400/ 1710 batches | lr 0.31 | ms/batch  5.66 | loss  2.26
INFO:root:| epoch   9 |   600/ 1710 batches | lr 0.31 | ms/batch  5.58 | loss  2.25
INFO:root:| epoch   9 |   800/ 1710 batches | lr 0.31 | ms/batch  6.24 | loss  2.21
INFO:root:| epoch   9 |  1000/ 1710 batches | lr 0.31 | ms/batch  6.11 | loss  2.19
INFO:root:| epoch   9 |  1200/ 1710 batches | lr 0.31 | ms/batch  5.23 | loss  2.13
INFO:root:| epoch   9 |  1400/ 1710 batches | lr 0.31 | ms/batch  5.11 | loss  2.10
INFO:root:| epoch   9 |  1600/ 1710 batches | lr 0.31 | ms/batch  5.17 | loss  2.07
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   9 | time: 10.21s | valid loss  3.10 | valid ppl    22.25
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  10 |   200/ 1710 batches | lr 0.08 | ms/batch  5.30 | loss  2.25
INFO:root:| epoch  10 |   400/ 1710 batches | lr 0.08 | ms/batch  5.25 | loss  2.25
INFO:root:| epoch  10 |   600/ 1710 batches | lr 0.08 | ms/batch  6.07 | loss  2.25
INFO:root:| epoch  10 |   800/ 1710 batches | lr 0.08 | ms/batch  5.40 | loss  2.21
INFO:root:| epoch  10 |  1000/ 1710 batches | lr 0.08 | ms/batch  5.16 | loss  2.17
INFO:root:| epoch  10 |  1200/ 1710 batches | lr 0.08 | ms/batch  5.37 | loss  2.12
INFO:root:| epoch  10 |  1400/ 1710 batches | lr 0.08 | ms/batch  5.09 | loss  2.08
INFO:root:| epoch  10 |  1600/ 1710 batches | lr 0.08 | ms/batch  5.14 | loss  2.04
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  10 | time:  9.22s | valid loss  3.10 | valid ppl    22.25
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:=========================================================================================
INFO:root:| End of training | test loss  3.43 | test ppl    30.92
INFO:root:=========================================================================================
INFO:root:----------- new value of n = 1, k = 2 -----------
INFO:root:Loading data
INFO:root:Vocab size 3005
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:| epoch   1 |   200/ 1890 batches | lr 0.02 | ms/batch  7.26 | loss  7.96
INFO:root:| epoch   1 |   400/ 1890 batches | lr 0.02 | ms/batch  5.67 | loss  7.76
INFO:root:| epoch   1 |   600/ 1890 batches | lr 0.02 | ms/batch  5.65 | loss  7.60
INFO:root:| epoch   1 |   800/ 1890 batches | lr 0.02 | ms/batch  6.35 | loss  7.42
INFO:root:| epoch   1 |  1000/ 1890 batches | lr 0.02 | ms/batch  6.65 | loss  7.26
INFO:root:| epoch   1 |  1200/ 1890 batches | lr 0.02 | ms/batch  5.64 | loss  7.07
INFO:root:| epoch   1 |  1400/ 1890 batches | lr 0.02 | ms/batch  5.69 | loss  6.90
INFO:root:| epoch   1 |  1600/ 1890 batches | lr 0.02 | ms/batch  6.07 | loss  6.71
INFO:root:| epoch   1 |  1800/ 1890 batches | lr 0.02 | ms/batch  6.93 | loss  6.52
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   1 | time: 11.79s | valid loss  6.33 | valid ppl   558.77
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   2 |   200/ 1890 batches | lr 0.02 | ms/batch  5.70 | loss  6.25
INFO:root:| epoch   2 |   400/ 1890 batches | lr 0.02 | ms/batch  5.64 | loss  6.06
INFO:root:| epoch   2 |   600/ 1890 batches | lr 0.02 | ms/batch  5.63 | loss  5.88
INFO:root:| epoch   2 |   800/ 1890 batches | lr 0.02 | ms/batch  5.66 | loss  5.72
INFO:root:| epoch   2 |  1000/ 1890 batches | lr 0.02 | ms/batch  5.87 | loss  5.61
INFO:root:| epoch   2 |  1200/ 1890 batches | lr 0.02 | ms/batch  5.72 | loss  5.49
INFO:root:| epoch   2 |  1400/ 1890 batches | lr 0.02 | ms/batch  5.71 | loss  5.42
INFO:root:| epoch   2 |  1600/ 1890 batches | lr 0.02 | ms/batch  7.22 | loss  5.35
INFO:root:| epoch   2 |  1800/ 1890 batches | lr 0.02 | ms/batch  5.95 | loss  5.27
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   2 | time: 11.24s | valid loss  5.20 | valid ppl   180.83
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   3 |   200/ 1890 batches | lr 0.02 | ms/batch  5.71 | loss  5.17
INFO:root:| epoch   3 |   400/ 1890 batches | lr 0.02 | ms/batch  6.28 | loss  5.13
INFO:root:| epoch   3 |   600/ 1890 batches | lr 0.02 | ms/batch  6.89 | loss  5.05
INFO:root:| epoch   3 |   800/ 1890 batches | lr 0.02 | ms/batch  5.64 | loss  4.98
INFO:root:| epoch   3 |  1000/ 1890 batches | lr 0.02 | ms/batch  5.66 | loss  4.94
INFO:root:| epoch   3 |  1200/ 1890 batches | lr 0.02 | ms/batch  6.08 | loss  4.87
INFO:root:| epoch   3 |  1400/ 1890 batches | lr 0.02 | ms/batch  7.08 | loss  4.84
INFO:root:| epoch   3 |  1600/ 1890 batches | lr 0.02 | ms/batch  5.91 | loss  4.80
INFO:root:| epoch   3 |  1800/ 1890 batches | lr 0.02 | ms/batch  5.81 | loss  4.76
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   3 | time: 11.62s | valid loss  4.72 | valid ppl   112.47
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   4 |   200/ 1890 batches | lr 0.02 | ms/batch  5.64 | loss  4.71
INFO:root:| epoch   4 |   400/ 1890 batches | lr 0.02 | ms/batch  5.83 | loss  4.72
INFO:root:| epoch   4 |   600/ 1890 batches | lr 0.02 | ms/batch  5.66 | loss  4.69
INFO:root:| epoch   4 |   800/ 1890 batches | lr 0.02 | ms/batch  5.66 | loss  4.66
INFO:root:| epoch   4 |  1000/ 1890 batches | lr 0.02 | ms/batch  6.28 | loss  4.66
INFO:root:| epoch   4 |  1200/ 1890 batches | lr 0.02 | ms/batch  6.85 | loss  4.63
INFO:root:| epoch   4 |  1400/ 1890 batches | lr 0.02 | ms/batch  5.63 | loss  4.63
INFO:root:| epoch   4 |  1600/ 1890 batches | lr 0.02 | ms/batch  5.63 | loss  4.63
INFO:root:| epoch   4 |  1800/ 1890 batches | lr 0.02 | ms/batch  5.70 | loss  4.61
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   4 | time: 11.38s | valid loss  4.59 | valid ppl    98.95
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   5 |   200/ 1890 batches | lr 0.02 | ms/batch  6.45 | loss  4.59
INFO:root:| epoch   5 |   400/ 1890 batches | lr 0.02 | ms/batch  5.65 | loss  4.62
INFO:root:| epoch   5 |   600/ 1890 batches | lr 0.02 | ms/batch  5.65 | loss  4.59
INFO:root:| epoch   5 |   800/ 1890 batches | lr 0.02 | ms/batch  6.57 | loss  4.58
INFO:root:| epoch   5 |  1000/ 1890 batches | lr 0.02 | ms/batch  6.40 | loss  4.58
INFO:root:| epoch   5 |  1200/ 1890 batches | lr 0.02 | ms/batch  5.60 | loss  4.57
INFO:root:| epoch   5 |  1400/ 1890 batches | lr 0.02 | ms/batch  5.63 | loss  4.57
INFO:root:| epoch   5 |  1600/ 1890 batches | lr 0.02 | ms/batch  5.64 | loss  4.57
INFO:root:| epoch   5 |  1800/ 1890 batches | lr 0.02 | ms/batch  5.83 | loss  4.55
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   5 | time: 11.29s | valid loss  4.54 | valid ppl    93.92
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   6 |   200/ 1890 batches | lr 0.02 | ms/batch  5.67 | loss  4.53
INFO:root:| epoch   6 |   400/ 1890 batches | lr 0.02 | ms/batch  6.22 | loss  4.57
INFO:root:| epoch   6 |   600/ 1890 batches | lr 0.02 | ms/batch  6.88 | loss  4.54
INFO:root:| epoch   6 |   800/ 1890 batches | lr 0.02 | ms/batch  6.26 | loss  4.54
INFO:root:| epoch   6 |  1000/ 1890 batches | lr 0.02 | ms/batch  5.91 | loss  4.54
INFO:root:| epoch   6 |  1200/ 1890 batches | lr 0.02 | ms/batch  5.75 | loss  4.52
INFO:root:| epoch   6 |  1400/ 1890 batches | lr 0.02 | ms/batch  6.87 | loss  4.52
INFO:root:| epoch   6 |  1600/ 1890 batches | lr 0.02 | ms/batch  6.17 | loss  4.52
INFO:root:| epoch   6 |  1800/ 1890 batches | lr 0.02 | ms/batch  5.69 | loss  4.50
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   6 | time: 11.70s | valid loss  4.50 | valid ppl    89.91
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   7 |   200/ 1890 batches | lr 0.02 | ms/batch  5.97 | loss  4.49
INFO:root:| epoch   7 |   400/ 1890 batches | lr 0.02 | ms/batch  7.15 | loss  4.52
INFO:root:| epoch   7 |   600/ 1890 batches | lr 0.02 | ms/batch  5.63 | loss  4.49
INFO:root:| epoch   7 |   800/ 1890 batches | lr 0.02 | ms/batch  5.64 | loss  4.49
INFO:root:| epoch   7 |  1000/ 1890 batches | lr 0.02 | ms/batch  5.67 | loss  4.49
INFO:root:| epoch   7 |  1200/ 1890 batches | lr 0.02 | ms/batch  5.64 | loss  4.47
INFO:root:| epoch   7 |  1400/ 1890 batches | lr 0.02 | ms/batch  5.66 | loss  4.46
INFO:root:| epoch   7 |  1600/ 1890 batches | lr 0.02 | ms/batch  5.64 | loss  4.47
INFO:root:| epoch   7 |  1800/ 1890 batches | lr 0.02 | ms/batch  5.62 | loss  4.45
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   7 | time: 11.13s | valid loss  4.44 | valid ppl    84.62
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   8 |   200/ 1890 batches | lr 0.02 | ms/batch  6.58 | loss  4.42
INFO:root:| epoch   8 |   400/ 1890 batches | lr 0.02 | ms/batch  6.51 | loss  4.45
INFO:root:| epoch   8 |   600/ 1890 batches | lr 0.02 | ms/batch  5.61 | loss  4.42
INFO:root:| epoch   8 |   800/ 1890 batches | lr 0.02 | ms/batch  5.72 | loss  4.41
INFO:root:| epoch   8 |  1000/ 1890 batches | lr 0.02 | ms/batch  6.56 | loss  4.41
INFO:root:| epoch   8 |  1200/ 1890 batches | lr 0.02 | ms/batch  6.56 | loss  4.39
INFO:root:| epoch   8 |  1400/ 1890 batches | lr 0.02 | ms/batch  5.61 | loss  4.38
INFO:root:| epoch   8 |  1600/ 1890 batches | lr 0.02 | ms/batch  5.71 | loss  4.38
INFO:root:| epoch   8 |  1800/ 1890 batches | lr 0.02 | ms/batch  5.67 | loss  4.36
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   8 | time: 11.51s | valid loss  4.35 | valid ppl    77.19
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   9 |   200/ 1890 batches | lr 0.02 | ms/batch  5.69 | loss  4.33
INFO:root:| epoch   9 |   400/ 1890 batches | lr 0.02 | ms/batch  5.64 | loss  4.36
INFO:root:| epoch   9 |   600/ 1890 batches | lr 0.02 | ms/batch  5.62 | loss  4.32
INFO:root:| epoch   9 |   800/ 1890 batches | lr 0.02 | ms/batch  5.65 | loss  4.31
INFO:root:| epoch   9 |  1000/ 1890 batches | lr 0.02 | ms/batch  5.65 | loss  4.31
INFO:root:| epoch   9 |  1200/ 1890 batches | lr 0.02 | ms/batch  5.68 | loss  4.28
INFO:root:| epoch   9 |  1400/ 1890 batches | lr 0.02 | ms/batch  5.92 | loss  4.27
INFO:root:| epoch   9 |  1600/ 1890 batches | lr 0.02 | ms/batch  6.37 | loss  4.28
INFO:root:| epoch   9 |  1800/ 1890 batches | lr 0.02 | ms/batch  7.25 | loss  4.24
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   9 | time: 11.51s | valid loss  4.23 | valid ppl    68.89
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  10 |   200/ 1890 batches | lr 0.02 | ms/batch  5.92 | loss  4.21
INFO:root:| epoch  10 |   400/ 1890 batches | lr 0.02 | ms/batch  6.29 | loss  4.24
INFO:root:| epoch  10 |   600/ 1890 batches | lr 0.02 | ms/batch  6.61 | loss  4.20
INFO:root:| epoch  10 |   800/ 1890 batches | lr 0.02 | ms/batch  6.92 | loss  4.19
INFO:root:| epoch  10 |  1000/ 1890 batches | lr 0.02 | ms/batch  5.65 | loss  4.18
INFO:root:| epoch  10 |  1200/ 1890 batches | lr 0.02 | ms/batch  5.79 | loss  4.16
INFO:root:| epoch  10 |  1400/ 1890 batches | lr 0.02 | ms/batch  5.94 | loss  4.14
INFO:root:| epoch  10 |  1600/ 1890 batches | lr 0.02 | ms/batch  5.75 | loss  4.15
INFO:root:| epoch  10 |  1800/ 1890 batches | lr 0.02 | ms/batch  5.71 | loss  4.11
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  10 | time: 11.53s | valid loss  4.10 | valid ppl    60.47
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:=========================================================================================
INFO:root:| End of training | test loss  4.29 | test ppl    73.10
INFO:root:=========================================================================================
INFO:root:----------- new value of n = 1, k = 3 -----------
INFO:root:Loading data
INFO:root:Vocab size 4005
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:| epoch   1 |   200/ 2070 batches | lr 0.02 | ms/batch  6.81 | loss  8.28
INFO:root:| epoch   1 |   400/ 2070 batches | lr 0.02 | ms/batch  6.73 | loss  8.11
INFO:root:| epoch   1 |   600/ 2070 batches | lr 0.02 | ms/batch  6.72 | loss  7.99
INFO:root:| epoch   1 |   800/ 2070 batches | lr 0.02 | ms/batch  7.47 | loss  7.85
INFO:root:| epoch   1 |  1000/ 2070 batches | lr 0.02 | ms/batch  7.52 | loss  7.72
INFO:root:| epoch   1 |  1200/ 2070 batches | lr 0.02 | ms/batch  8.11 | loss  7.59
INFO:root:| epoch   1 |  1400/ 2070 batches | lr 0.02 | ms/batch  6.86 | loss  7.44
INFO:root:| epoch   1 |  1600/ 2070 batches | lr 0.02 | ms/batch  6.93 | loss  7.33
INFO:root:| epoch   1 |  1800/ 2070 batches | lr 0.02 | ms/batch  8.55 | loss  7.17
INFO:root:| epoch   1 |  2000/ 2070 batches | lr 0.02 | ms/batch  6.76 | loss  7.02
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   1 | time: 15.09s | valid loss  6.89 | valid ppl   985.50
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   2 |   200/ 2070 batches | lr 0.02 | ms/batch  6.85 | loss  6.83
INFO:root:| epoch   2 |   400/ 2070 batches | lr 0.02 | ms/batch  8.12 | loss  6.66
INFO:root:| epoch   2 |   600/ 2070 batches | lr 0.02 | ms/batch  6.35 | loss  6.52
INFO:root:| epoch   2 |   800/ 2070 batches | lr 0.02 | ms/batch  6.35 | loss  6.32
INFO:root:| epoch   2 |  1000/ 2070 batches | lr 0.02 | ms/batch  6.37 | loss  6.22
INFO:root:| epoch   2 |  1200/ 2070 batches | lr 0.02 | ms/batch  6.32 | loss  6.10
INFO:root:| epoch   2 |  1400/ 2070 batches | lr 0.02 | ms/batch  6.33 | loss  5.94
INFO:root:| epoch   2 |  1600/ 2070 batches | lr 0.02 | ms/batch  6.36 | loss  5.92
INFO:root:| epoch   2 |  1800/ 2070 batches | lr 0.02 | ms/batch  6.62 | loss  5.79
INFO:root:| epoch   2 |  2000/ 2070 batches | lr 0.02 | ms/batch  7.89 | loss  5.71
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   2 | time: 14.08s | valid loss  5.66 | valid ppl   286.90
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   3 |   200/ 2070 batches | lr 0.02 | ms/batch  6.42 | loss  5.62
INFO:root:| epoch   3 |   400/ 2070 batches | lr 0.02 | ms/batch  6.57 | loss  5.57
INFO:root:| epoch   3 |   600/ 2070 batches | lr 0.02 | ms/batch  8.17 | loss  5.54
INFO:root:| epoch   3 |   800/ 2070 batches | lr 0.02 | ms/batch  6.39 | loss  5.40
INFO:root:| epoch   3 |  1000/ 2070 batches | lr 0.02 | ms/batch  6.43 | loss  5.43
INFO:root:| epoch   3 |  1200/ 2070 batches | lr 0.02 | ms/batch  6.35 | loss  5.39
INFO:root:| epoch   3 |  1400/ 2070 batches | lr 0.02 | ms/batch  6.35 | loss  5.28
INFO:root:| epoch   3 |  1600/ 2070 batches | lr 0.02 | ms/batch  6.40 | loss  5.35
INFO:root:| epoch   3 |  1800/ 2070 batches | lr 0.02 | ms/batch  6.37 | loss  5.26
INFO:root:| epoch   3 |  2000/ 2070 batches | lr 0.02 | ms/batch  6.40 | loss  5.23
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   3 | time: 13.74s | valid loss  5.22 | valid ppl   185.78
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   4 |   200/ 2070 batches | lr 0.02 | ms/batch  6.53 | loss  5.20
INFO:root:| epoch   4 |   400/ 2070 batches | lr 0.02 | ms/batch  6.37 | loss  5.20
INFO:root:| epoch   4 |   600/ 2070 batches | lr 0.02 | ms/batch  6.37 | loss  5.22
INFO:root:| epoch   4 |   800/ 2070 batches | lr 0.02 | ms/batch  7.86 | loss  5.10
INFO:root:| epoch   4 |  1000/ 2070 batches | lr 0.02 | ms/batch  6.70 | loss  5.18
INFO:root:| epoch   4 |  1200/ 2070 batches | lr 0.02 | ms/batch  6.33 | loss  5.17
INFO:root:| epoch   4 |  1400/ 2070 batches | lr 0.02 | ms/batch  6.70 | loss  5.08
INFO:root:| epoch   4 |  1600/ 2070 batches | lr 0.02 | ms/batch  7.85 | loss  5.19
INFO:root:| epoch   4 |  1800/ 2070 batches | lr 0.02 | ms/batch  6.37 | loss  5.11
INFO:root:| epoch   4 |  2000/ 2070 batches | lr 0.02 | ms/batch  6.43 | loss  5.10
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   4 | time: 14.07s | valid loss  5.11 | valid ppl   165.72
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   5 |   200/ 2070 batches | lr 0.02 | ms/batch  8.11 | loss  5.08
INFO:root:| epoch   5 |   400/ 2070 batches | lr 0.02 | ms/batch  6.35 | loss  5.10
INFO:root:| epoch   5 |   600/ 2070 batches | lr 0.02 | ms/batch  6.77 | loss  5.13
INFO:root:| epoch   5 |   800/ 2070 batches | lr 0.02 | ms/batch  6.45 | loss  5.01
INFO:root:| epoch   5 |  1000/ 2070 batches | lr 0.02 | ms/batch  6.37 | loss  5.10
INFO:root:| epoch   5 |  1200/ 2070 batches | lr 0.02 | ms/batch  6.88 | loss  5.10
INFO:root:| epoch   5 |  1400/ 2070 batches | lr 0.02 | ms/batch  6.44 | loss  5.01
INFO:root:| epoch   5 |  1600/ 2070 batches | lr 0.02 | ms/batch  8.02 | loss  5.13
INFO:root:| epoch   5 |  1800/ 2070 batches | lr 0.02 | ms/batch  8.30 | loss  5.05
INFO:root:| epoch   5 |  2000/ 2070 batches | lr 0.02 | ms/batch  6.49 | loss  5.04
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   5 | time: 14.61s | valid loss  5.06 | valid ppl   157.00
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   6 |   200/ 2070 batches | lr 0.02 | ms/batch  6.83 | loss  5.03
INFO:root:| epoch   6 |   400/ 2070 batches | lr 0.02 | ms/batch  7.71 | loss  5.04
INFO:root:| epoch   6 |   600/ 2070 batches | lr 0.02 | ms/batch  6.58 | loss  5.08
INFO:root:| epoch   6 |   800/ 2070 batches | lr 0.02 | ms/batch  6.64 | loss  4.96
INFO:root:| epoch   6 |  1000/ 2070 batches | lr 0.02 | ms/batch  7.01 | loss  5.06
INFO:root:| epoch   6 |  1200/ 2070 batches | lr 0.02 | ms/batch  6.40 | loss  5.05
INFO:root:| epoch   6 |  1400/ 2070 batches | lr 0.02 | ms/batch  6.54 | loss  4.97
INFO:root:| epoch   6 |  1600/ 2070 batches | lr 0.02 | ms/batch  6.37 | loss  5.08
INFO:root:| epoch   6 |  1800/ 2070 batches | lr 0.02 | ms/batch  6.42 | loss  5.00
INFO:root:| epoch   6 |  2000/ 2070 batches | lr 0.02 | ms/batch  6.37 | loss  5.00
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   6 | time: 13.93s | valid loss  5.02 | valid ppl   151.02
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   7 |   200/ 2070 batches | lr 0.02 | ms/batch  6.43 | loss  4.99
INFO:root:| epoch   7 |   400/ 2070 batches | lr 0.02 | ms/batch  6.36 | loss  5.00
INFO:root:| epoch   7 |   600/ 2070 batches | lr 0.02 | ms/batch  8.46 | loss  5.04
INFO:root:| epoch   7 |   800/ 2070 batches | lr 0.02 | ms/batch  6.69 | loss  4.92
INFO:root:| epoch   7 |  1000/ 2070 batches | lr 0.02 | ms/batch  6.52 | loss  5.02
INFO:root:| epoch   7 |  1200/ 2070 batches | lr 0.02 | ms/batch  6.97 | loss  5.01
INFO:root:| epoch   7 |  1400/ 2070 batches | lr 0.02 | ms/batch  7.55 | loss  4.93
INFO:root:| epoch   7 |  1600/ 2070 batches | lr 0.02 | ms/batch  6.60 | loss  5.05
INFO:root:| epoch   7 |  1800/ 2070 batches | lr 0.02 | ms/batch  6.40 | loss  4.97
INFO:root:| epoch   7 |  2000/ 2070 batches | lr 0.02 | ms/batch  6.37 | loss  4.97
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   7 | time: 14.24s | valid loss  4.99 | valid ppl   146.51
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   8 |   200/ 2070 batches | lr 0.02 | ms/batch  7.11 | loss  4.95
INFO:root:| epoch   8 |   400/ 2070 batches | lr 0.02 | ms/batch  7.68 | loss  4.97
INFO:root:| epoch   8 |   600/ 2070 batches | lr 0.02 | ms/batch  6.55 | loss  5.01
INFO:root:| epoch   8 |   800/ 2070 batches | lr 0.02 | ms/batch  6.44 | loss  4.89
INFO:root:| epoch   8 |  1000/ 2070 batches | lr 0.02 | ms/batch  7.83 | loss  4.99
INFO:root:| epoch   8 |  1200/ 2070 batches | lr 0.02 | ms/batch  6.72 | loss  4.98
INFO:root:| epoch   8 |  1400/ 2070 batches | lr 0.02 | ms/batch  6.45 | loss  4.90
INFO:root:| epoch   8 |  1600/ 2070 batches | lr 0.02 | ms/batch  6.53 | loss  5.01
INFO:root:| epoch   8 |  1800/ 2070 batches | lr 0.02 | ms/batch  7.94 | loss  4.94
INFO:root:| epoch   8 |  2000/ 2070 batches | lr 0.02 | ms/batch  6.52 | loss  4.93
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   8 | time: 14.52s | valid loss  4.96 | valid ppl   142.36
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   9 |   200/ 2070 batches | lr 0.02 | ms/batch  6.42 | loss  4.92
INFO:root:| epoch   9 |   400/ 2070 batches | lr 0.02 | ms/batch  8.12 | loss  4.94
INFO:root:| epoch   9 |   600/ 2070 batches | lr 0.02 | ms/batch  6.49 | loss  4.98
INFO:root:| epoch   9 |   800/ 2070 batches | lr 0.02 | ms/batch  6.44 | loss  4.85
INFO:root:| epoch   9 |  1000/ 2070 batches | lr 0.02 | ms/batch  6.49 | loss  4.95
INFO:root:| epoch   9 |  1200/ 2070 batches | lr 0.02 | ms/batch  6.36 | loss  4.95
INFO:root:| epoch   9 |  1400/ 2070 batches | lr 0.02 | ms/batch  6.38 | loss  4.87
INFO:root:| epoch   9 |  1600/ 2070 batches | lr 0.02 | ms/batch  6.89 | loss  4.98
INFO:root:| epoch   9 |  1800/ 2070 batches | lr 0.02 | ms/batch  6.41 | loss  4.91
INFO:root:| epoch   9 |  2000/ 2070 batches | lr 0.02 | ms/batch  6.42 | loss  4.90
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   9 | time: 13.86s | valid loss  4.93 | valid ppl   137.83
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  10 |   200/ 2070 batches | lr 0.02 | ms/batch  7.98 | loss  4.88
INFO:root:| epoch  10 |   400/ 2070 batches | lr 0.02 | ms/batch  6.91 | loss  4.90
INFO:root:| epoch  10 |   600/ 2070 batches | lr 0.02 | ms/batch  6.49 | loss  4.94
INFO:root:| epoch  10 |   800/ 2070 batches | lr 0.02 | ms/batch  6.74 | loss  4.82
INFO:root:| epoch  10 |  1000/ 2070 batches | lr 0.02 | ms/batch  7.78 | loss  4.91
INFO:root:| epoch  10 |  1200/ 2070 batches | lr 0.02 | ms/batch  6.50 | loss  4.91
INFO:root:| epoch  10 |  1400/ 2070 batches | lr 0.02 | ms/batch  6.41 | loss  4.83
INFO:root:| epoch  10 |  1600/ 2070 batches | lr 0.02 | ms/batch  7.44 | loss  4.94
INFO:root:| epoch  10 |  1800/ 2070 batches | lr 0.02 | ms/batch  7.07 | loss  4.86
INFO:root:| epoch  10 |  2000/ 2070 batches | lr 0.02 | ms/batch  6.46 | loss  4.86
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  10 | time: 14.53s | valid loss  4.89 | valid ppl   132.34
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:=========================================================================================
INFO:root:| End of training | test loss  5.10 | test ppl   163.31
INFO:root:=========================================================================================
INFO:root:----------- new value of n = 1, k = 4 -----------
INFO:root:Loading data
INFO:root:Vocab size 5005
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:| epoch   1 |   200/ 2250 batches | lr 0.02 | ms/batch  7.15 | loss  8.51
INFO:root:| epoch   1 |   400/ 2250 batches | lr 0.02 | ms/batch  6.96 | loss  8.34
INFO:root:| epoch   1 |   600/ 2250 batches | lr 0.02 | ms/batch  7.23 | loss  8.22
INFO:root:| epoch   1 |   800/ 2250 batches | lr 0.02 | ms/batch  7.16 | loss  8.10
INFO:root:| epoch   1 |  1000/ 2250 batches | lr 0.02 | ms/batch  8.40 | loss  7.98
INFO:root:| epoch   1 |  1200/ 2250 batches | lr 0.02 | ms/batch  7.59 | loss  7.85
INFO:root:| epoch   1 |  1400/ 2250 batches | lr 0.02 | ms/batch  7.10 | loss  7.72
INFO:root:| epoch   1 |  1600/ 2250 batches | lr 0.02 | ms/batch  7.93 | loss  7.59
INFO:root:| epoch   1 |  1800/ 2250 batches | lr 0.02 | ms/batch  8.04 | loss  7.45
INFO:root:| epoch   1 |  2000/ 2250 batches | lr 0.02 | ms/batch  7.16 | loss  7.31
INFO:root:| epoch   1 |  2200/ 2250 batches | lr 0.02 | ms/batch  7.10 | loss  7.16
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   1 | time: 16.88s | valid loss  7.05 | valid ppl  1155.97
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   2 |   200/ 2250 batches | lr 0.02 | ms/batch  7.77 | loss  7.02
INFO:root:| epoch   2 |   400/ 2250 batches | lr 0.02 | ms/batch  7.75 | loss  6.83
INFO:root:| epoch   2 |   600/ 2250 batches | lr 0.02 | ms/batch  7.66 | loss  6.70
INFO:root:| epoch   2 |   800/ 2250 batches | lr 0.02 | ms/batch 10.99 | loss  6.57
INFO:root:| epoch   2 |  1000/ 2250 batches | lr 0.02 | ms/batch  8.25 | loss  6.46
INFO:root:| epoch   2 |  1200/ 2250 batches | lr 0.02 | ms/batch  7.86 | loss  6.37
INFO:root:| epoch   2 |  1400/ 2250 batches | lr 0.02 | ms/batch  9.42 | loss  6.29
INFO:root:| epoch   2 |  1600/ 2250 batches | lr 0.02 | ms/batch  7.82 | loss  6.22
INFO:root:| epoch   2 |  1800/ 2250 batches | lr 0.02 | ms/batch  7.80 | loss  6.16
INFO:root:| epoch   2 |  2000/ 2250 batches | lr 0.02 | ms/batch  9.30 | loss  6.10
INFO:root:| epoch   2 |  2200/ 2250 batches | lr 0.02 | ms/batch  7.84 | loss  6.04
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   2 | time: 19.02s | valid loss  6.01 | valid ppl   405.56
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   3 |   200/ 2250 batches | lr 0.02 | ms/batch  7.17 | loss  6.01
INFO:root:| epoch   3 |   400/ 2250 batches | lr 0.02 | ms/batch  7.01 | loss  5.92
INFO:root:| epoch   3 |   600/ 2250 batches | lr 0.02 | ms/batch  7.11 | loss  5.88
INFO:root:| epoch   3 |   800/ 2250 batches | lr 0.02 | ms/batch  7.95 | loss  5.83
INFO:root:| epoch   3 |  1000/ 2250 batches | lr 0.02 | ms/batch  7.23 | loss  5.78
INFO:root:| epoch   3 |  1200/ 2250 batches | lr 0.02 | ms/batch  7.23 | loss  5.75
INFO:root:| epoch   3 |  1400/ 2250 batches | lr 0.02 | ms/batch  7.31 | loss  5.71
INFO:root:| epoch   3 |  1600/ 2250 batches | lr 0.02 | ms/batch  8.22 | loss  5.67
INFO:root:| epoch   3 |  1800/ 2250 batches | lr 0.02 | ms/batch  7.80 | loss  5.64
INFO:root:| epoch   3 |  2000/ 2250 batches | lr 0.02 | ms/batch  7.04 | loss  5.62
INFO:root:| epoch   3 |  2200/ 2250 batches | lr 0.02 | ms/batch  7.76 | loss  5.59
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   3 | time: 17.06s | valid loss  5.58 | valid ppl   265.98
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   4 |   200/ 2250 batches | lr 0.02 | ms/batch  7.37 | loss  5.60
INFO:root:| epoch   4 |   400/ 2250 batches | lr 0.02 | ms/batch  6.93 | loss  5.55
INFO:root:| epoch   4 |   600/ 2250 batches | lr 0.02 | ms/batch  7.65 | loss  5.54
INFO:root:| epoch   4 |   800/ 2250 batches | lr 0.02 | ms/batch  8.22 | loss  5.53
INFO:root:| epoch   4 |  1000/ 2250 batches | lr 0.02 | ms/batch  7.09 | loss  5.51
INFO:root:| epoch   4 |  1200/ 2250 batches | lr 0.02 | ms/batch  6.96 | loss  5.51
INFO:root:| epoch   4 |  1400/ 2250 batches | lr 0.02 | ms/batch  6.97 | loss  5.50
INFO:root:| epoch   4 |  1600/ 2250 batches | lr 0.02 | ms/batch  6.99 | loss  5.49
INFO:root:| epoch   4 |  1800/ 2250 batches | lr 0.02 | ms/batch  7.08 | loss  5.48
INFO:root:| epoch   4 |  2000/ 2250 batches | lr 0.02 | ms/batch  8.18 | loss  5.47
INFO:root:| epoch   4 |  2200/ 2250 batches | lr 0.02 | ms/batch  8.08 | loss  5.46
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   4 | time: 16.93s | valid loss  5.47 | valid ppl   236.84
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   5 |   200/ 2250 batches | lr 0.02 | ms/batch  7.36 | loss  5.48
INFO:root:| epoch   5 |   400/ 2250 batches | lr 0.02 | ms/batch  8.85 | loss  5.44
INFO:root:| epoch   5 |   600/ 2250 batches | lr 0.02 | ms/batch  7.25 | loss  5.44
INFO:root:| epoch   5 |   800/ 2250 batches | lr 0.02 | ms/batch  7.08 | loss  5.44
INFO:root:| epoch   5 |  1000/ 2250 batches | lr 0.02 | ms/batch  7.92 | loss  5.43
INFO:root:| epoch   5 |  1200/ 2250 batches | lr 0.02 | ms/batch  7.88 | loss  5.43
INFO:root:| epoch   5 |  1400/ 2250 batches | lr 0.02 | ms/batch  7.17 | loss  5.42
INFO:root:| epoch   5 |  1600/ 2250 batches | lr 0.02 | ms/batch  6.95 | loss  5.41
INFO:root:| epoch   5 |  1800/ 2250 batches | lr 0.02 | ms/batch  6.96 | loss  5.41
INFO:root:| epoch   5 |  2000/ 2250 batches | lr 0.02 | ms/batch  6.93 | loss  5.40
INFO:root:| epoch   5 |  2200/ 2250 batches | lr 0.02 | ms/batch  7.69 | loss  5.39
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   5 | time: 17.10s | valid loss  5.40 | valid ppl   221.79
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   6 |   200/ 2250 batches | lr 0.02 | ms/batch  7.87 | loss  5.41
INFO:root:| epoch   6 |   400/ 2250 batches | lr 0.02 | ms/batch  7.08 | loss  5.37
INFO:root:| epoch   6 |   600/ 2250 batches | lr 0.02 | ms/batch  7.68 | loss  5.37
INFO:root:| epoch   6 |   800/ 2250 batches | lr 0.02 | ms/batch  8.15 | loss  5.37
INFO:root:| epoch   6 |  1000/ 2250 batches | lr 0.02 | ms/batch  7.16 | loss  5.36
INFO:root:| epoch   6 |  1200/ 2250 batches | lr 0.02 | ms/batch  7.02 | loss  5.36
INFO:root:| epoch   6 |  1400/ 2250 batches | lr 0.02 | ms/batch  9.23 | loss  5.36
INFO:root:| epoch   6 |  1600/ 2250 batches | lr 0.02 | ms/batch  7.55 | loss  5.35
INFO:root:| epoch   6 |  1800/ 2250 batches | lr 0.02 | ms/batch  7.47 | loss  5.35
INFO:root:| epoch   6 |  2000/ 2250 batches | lr 0.02 | ms/batch  7.00 | loss  5.34
INFO:root:| epoch   6 |  2200/ 2250 batches | lr 0.02 | ms/batch  7.06 | loss  5.33
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   6 | time: 17.16s | valid loss  5.35 | valid ppl   210.10
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   7 |   200/ 2250 batches | lr 0.02 | ms/batch  7.16 | loss  5.36
INFO:root:| epoch   7 |   400/ 2250 batches | lr 0.02 | ms/batch  7.04 | loss  5.32
INFO:root:| epoch   7 |   600/ 2250 batches | lr 0.02 | ms/batch  7.98 | loss  5.32
INFO:root:| epoch   7 |   800/ 2250 batches | lr 0.02 | ms/batch  8.23 | loss  5.32
INFO:root:| epoch   7 |  1000/ 2250 batches | lr 0.02 | ms/batch  7.15 | loss  5.31
INFO:root:| epoch   7 |  1200/ 2250 batches | lr 0.02 | ms/batch  7.30 | loss  5.31
INFO:root:| epoch   7 |  1400/ 2250 batches | lr 0.02 | ms/batch  8.63 | loss  5.30
INFO:root:| epoch   7 |  1600/ 2250 batches | lr 0.02 | ms/batch  7.11 | loss  5.30
INFO:root:| epoch   7 |  1800/ 2250 batches | lr 0.02 | ms/batch  7.05 | loss  5.29
INFO:root:| epoch   7 |  2000/ 2250 batches | lr 0.02 | ms/batch  8.80 | loss  5.28
INFO:root:| epoch   7 |  2200/ 2250 batches | lr 0.02 | ms/batch  7.10 | loss  5.27
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   7 | time: 17.22s | valid loss  5.30 | valid ppl   199.50
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   8 |   200/ 2250 batches | lr 0.02 | ms/batch  7.20 | loss  5.30
INFO:root:| epoch   8 |   400/ 2250 batches | lr 0.02 | ms/batch  6.95 | loss  5.26
INFO:root:| epoch   8 |   600/ 2250 batches | lr 0.02 | ms/batch  6.96 | loss  5.26
INFO:root:| epoch   8 |   800/ 2250 batches | lr 0.02 | ms/batch  7.09 | loss  5.26
INFO:root:| epoch   8 |  1000/ 2250 batches | lr 0.02 | ms/batch  7.72 | loss  5.25
INFO:root:| epoch   8 |  1200/ 2250 batches | lr 0.02 | ms/batch  8.54 | loss  5.25
INFO:root:| epoch   8 |  1400/ 2250 batches | lr 0.02 | ms/batch  7.07 | loss  5.24
INFO:root:| epoch   8 |  1600/ 2250 batches | lr 0.02 | ms/batch  7.03 | loss  5.24
INFO:root:| epoch   8 |  1800/ 2250 batches | lr 0.02 | ms/batch  8.90 | loss  5.23
INFO:root:| epoch   8 |  2000/ 2250 batches | lr 0.02 | ms/batch  7.10 | loss  5.22
INFO:root:| epoch   8 |  2200/ 2250 batches | lr 0.02 | ms/batch  7.13 | loss  5.21
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   8 | time: 16.89s | valid loss  5.24 | valid ppl   187.81
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   9 |   200/ 2250 batches | lr 0.02 | ms/batch  8.85 | loss  5.23
INFO:root:| epoch   9 |   400/ 2250 batches | lr 0.02 | ms/batch  7.14 | loss  5.19
INFO:root:| epoch   9 |   600/ 2250 batches | lr 0.02 | ms/batch  6.98 | loss  5.19
INFO:root:| epoch   9 |   800/ 2250 batches | lr 0.02 | ms/batch  6.96 | loss  5.19
INFO:root:| epoch   9 |  1000/ 2250 batches | lr 0.02 | ms/batch  7.11 | loss  5.18
INFO:root:| epoch   9 |  1200/ 2250 batches | lr 0.02 | ms/batch  7.11 | loss  5.18
INFO:root:| epoch   9 |  1400/ 2250 batches | lr 0.02 | ms/batch  7.03 | loss  5.17
INFO:root:| epoch   9 |  1600/ 2250 batches | lr 0.02 | ms/batch  8.73 | loss  5.16
INFO:root:| epoch   9 |  1800/ 2250 batches | lr 0.02 | ms/batch  7.56 | loss  5.15
INFO:root:| epoch   9 |  2000/ 2250 batches | lr 0.02 | ms/batch  7.23 | loss  5.14
INFO:root:| epoch   9 |  2200/ 2250 batches | lr 0.02 | ms/batch  9.73 | loss  5.13
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   9 | time: 17.54s | valid loss  5.16 | valid ppl   173.67
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  10 |   200/ 2250 batches | lr 0.02 | ms/batch  7.66 | loss  5.15
INFO:root:| epoch  10 |   400/ 2250 batches | lr 0.02 | ms/batch  7.24 | loss  5.11
INFO:root:| epoch  10 |   600/ 2250 batches | lr 0.02 | ms/batch 10.48 | loss  5.10
INFO:root:| epoch  10 |   800/ 2250 batches | lr 0.02 | ms/batch  7.26 | loss  5.10
INFO:root:| epoch  10 |  1000/ 2250 batches | lr 0.02 | ms/batch  7.14 | loss  5.09
INFO:root:| epoch  10 |  1200/ 2250 batches | lr 0.02 | ms/batch  7.14 | loss  5.09
INFO:root:| epoch  10 |  1400/ 2250 batches | lr 0.02 | ms/batch  7.21 | loss  5.07
INFO:root:| epoch  10 |  1600/ 2250 batches | lr 0.02 | ms/batch  7.91 | loss  5.07
INFO:root:| epoch  10 |  1800/ 2250 batches | lr 0.02 | ms/batch  8.24 | loss  5.05
INFO:root:| epoch  10 |  2000/ 2250 batches | lr 0.02 | ms/batch  7.11 | loss  5.04
INFO:root:| epoch  10 |  2200/ 2250 batches | lr 0.02 | ms/batch  7.46 | loss  5.02
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  10 | time: 17.65s | valid loss  5.05 | valid ppl   156.70
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:=========================================================================================
INFO:root:| End of training | test loss  5.25 | test ppl   191.28
INFO:root:=========================================================================================
INFO:root:----------- new value of n = 2, k = 1 -----------
INFO:root:Loading data
INFO:root:Vocab size 2005
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:| epoch   1 |   200/ 1710 batches | lr 0.02 | ms/batch  6.12 | loss  7.54
INFO:root:| epoch   1 |   400/ 1710 batches | lr 0.02 | ms/batch  5.67 | loss  7.29
INFO:root:| epoch   1 |   600/ 1710 batches | lr 0.02 | ms/batch  5.88 | loss  7.07
INFO:root:| epoch   1 |   800/ 1710 batches | lr 0.02 | ms/batch  7.66 | loss  6.84
INFO:root:| epoch   1 |  1000/ 1710 batches | lr 0.02 | ms/batch  5.69 | loss  6.57
INFO:root:| epoch   1 |  1200/ 1710 batches | lr 0.02 | ms/batch  5.66 | loss  6.30
INFO:root:| epoch   1 |  1400/ 1710 batches | lr 0.02 | ms/batch  5.69 | loss  5.99
INFO:root:| epoch   1 |  1600/ 1710 batches | lr 0.02 | ms/batch  7.59 | loss  5.67
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   1 | time: 10.71s | valid loss  5.38 | valid ppl   218.08
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   2 |   200/ 1710 batches | lr 0.02 | ms/batch  6.14 | loss  5.26
INFO:root:| epoch   2 |   400/ 1710 batches | lr 0.02 | ms/batch  5.75 | loss  5.02
INFO:root:| epoch   2 |   600/ 1710 batches | lr 0.02 | ms/batch  5.72 | loss  4.86
INFO:root:| epoch   2 |   800/ 1710 batches | lr 0.02 | ms/batch  6.89 | loss  4.76
INFO:root:| epoch   2 |  1000/ 1710 batches | lr 0.02 | ms/batch  6.88 | loss  4.62
INFO:root:| epoch   2 |  1200/ 1710 batches | lr 0.02 | ms/batch  5.86 | loss  4.56
INFO:root:| epoch   2 |  1400/ 1710 batches | lr 0.02 | ms/batch  5.70 | loss  4.45
INFO:root:| epoch   2 |  1600/ 1710 batches | lr 0.02 | ms/batch  6.90 | loss  4.36
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   2 | time: 10.86s | valid loss  4.33 | valid ppl    75.82
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   3 |   200/ 1710 batches | lr 0.02 | ms/batch  5.77 | loss  4.28
INFO:root:| epoch   3 |   400/ 1710 batches | lr 0.02 | ms/batch  5.74 | loss  4.19
INFO:root:| epoch   3 |   600/ 1710 batches | lr 0.02 | ms/batch  6.11 | loss  4.15
INFO:root:| epoch   3 |   800/ 1710 batches | lr 0.02 | ms/batch  7.68 | loss  4.14
INFO:root:| epoch   3 |  1000/ 1710 batches | lr 0.02 | ms/batch  6.54 | loss  4.08
INFO:root:| epoch   3 |  1200/ 1710 batches | lr 0.02 | ms/batch  6.16 | loss  4.10
INFO:root:| epoch   3 |  1400/ 1710 batches | lr 0.02 | ms/batch  5.98 | loss  4.07
INFO:root:| epoch   3 |  1600/ 1710 batches | lr 0.02 | ms/batch  5.71 | loss  4.06
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   3 | time: 10.68s | valid loss  4.09 | valid ppl    59.84
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   4 |   200/ 1710 batches | lr 0.02 | ms/batch  5.97 | loss  4.07
INFO:root:| epoch   4 |   400/ 1710 batches | lr 0.02 | ms/batch  5.92 | loss  4.03
INFO:root:| epoch   4 |   600/ 1710 batches | lr 0.02 | ms/batch  7.10 | loss  4.02
INFO:root:| epoch   4 |   800/ 1710 batches | lr 0.02 | ms/batch  6.73 | loss  4.03
INFO:root:| epoch   4 |  1000/ 1710 batches | lr 0.02 | ms/batch  5.82 | loss  3.98
INFO:root:| epoch   4 |  1200/ 1710 batches | lr 0.02 | ms/batch  5.83 | loss  4.03
INFO:root:| epoch   4 |  1400/ 1710 batches | lr 0.02 | ms/batch  6.22 | loss  4.01
INFO:root:| epoch   4 |  1600/ 1710 batches | lr 0.02 | ms/batch  5.81 | loss  4.01
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   4 | time: 10.91s | valid loss  4.04 | valid ppl    56.98
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   5 |   200/ 1710 batches | lr 0.02 | ms/batch  7.16 | loss  4.02
INFO:root:| epoch   5 |   400/ 1710 batches | lr 0.02 | ms/batch  5.93 | loss  3.98
INFO:root:| epoch   5 |   600/ 1710 batches | lr 0.02 | ms/batch  6.34 | loss  3.98
INFO:root:| epoch   5 |   800/ 1710 batches | lr 0.02 | ms/batch  7.58 | loss  4.00
INFO:root:| epoch   5 |  1000/ 1710 batches | lr 0.02 | ms/batch  5.97 | loss  3.95
INFO:root:| epoch   5 |  1200/ 1710 batches | lr 0.02 | ms/batch  7.95 | loss  4.00
INFO:root:| epoch   5 |  1400/ 1710 batches | lr 0.02 | ms/batch  6.87 | loss  3.98
INFO:root:| epoch   5 |  1600/ 1710 batches | lr 0.02 | ms/batch  7.26 | loss  3.98
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   5 | time: 11.76s | valid loss  4.02 | valid ppl    55.70
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   6 |   200/ 1710 batches | lr 0.02 | ms/batch  5.94 | loss  4.00
INFO:root:| epoch   6 |   400/ 1710 batches | lr 0.02 | ms/batch  6.01 | loss  3.96
INFO:root:| epoch   6 |   600/ 1710 batches | lr 0.02 | ms/batch  7.50 | loss  3.96
INFO:root:| epoch   6 |   800/ 1710 batches | lr 0.02 | ms/batch  5.85 | loss  3.97
INFO:root:| epoch   6 |  1000/ 1710 batches | lr 0.02 | ms/batch  6.24 | loss  3.93
INFO:root:| epoch   6 |  1200/ 1710 batches | lr 0.02 | ms/batch  6.40 | loss  3.98
INFO:root:| epoch   6 |  1400/ 1710 batches | lr 0.02 | ms/batch  7.24 | loss  3.95
INFO:root:| epoch   6 |  1600/ 1710 batches | lr 0.02 | ms/batch  5.79 | loss  3.96
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   6 | time: 10.95s | valid loss  4.00 | valid ppl    54.53
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   7 |   200/ 1710 batches | lr 0.02 | ms/batch  5.90 | loss  3.97
INFO:root:| epoch   7 |   400/ 1710 batches | lr 0.02 | ms/batch  7.58 | loss  3.93
INFO:root:| epoch   7 |   600/ 1710 batches | lr 0.02 | ms/batch  5.85 | loss  3.93
INFO:root:| epoch   7 |   800/ 1710 batches | lr 0.02 | ms/batch  5.85 | loss  3.94
INFO:root:| epoch   7 |  1000/ 1710 batches | lr 0.02 | ms/batch  5.76 | loss  3.90
INFO:root:| epoch   7 |  1200/ 1710 batches | lr 0.02 | ms/batch  5.70 | loss  3.95
INFO:root:| epoch   7 |  1400/ 1710 batches | lr 0.02 | ms/batch  5.73 | loss  3.92
INFO:root:| epoch   7 |  1600/ 1710 batches | lr 0.02 | ms/batch  5.69 | loss  3.92
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   7 | time: 10.35s | valid loss  3.96 | valid ppl    52.66
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   8 |   200/ 1710 batches | lr 0.02 | ms/batch  7.73 | loss  3.94
INFO:root:| epoch   8 |   400/ 1710 batches | lr 0.02 | ms/batch  6.20 | loss  3.89
INFO:root:| epoch   8 |   600/ 1710 batches | lr 0.02 | ms/batch  5.80 | loss  3.88
INFO:root:| epoch   8 |   800/ 1710 batches | lr 0.02 | ms/batch  5.75 | loss  3.89
INFO:root:| epoch   8 |  1000/ 1710 batches | lr 0.02 | ms/batch  7.68 | loss  3.84
INFO:root:| epoch   8 |  1200/ 1710 batches | lr 0.02 | ms/batch  5.97 | loss  3.89
INFO:root:| epoch   8 |  1400/ 1710 batches | lr 0.02 | ms/batch  5.85 | loss  3.85
INFO:root:| epoch   8 |  1600/ 1710 batches | lr 0.02 | ms/batch  5.86 | loss  3.85
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   8 | time: 11.18s | valid loss  3.89 | valid ppl    49.10
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   9 |   200/ 1710 batches | lr 0.02 | ms/batch  6.54 | loss  3.86
INFO:root:| epoch   9 |   400/ 1710 batches | lr 0.02 | ms/batch  5.86 | loss  3.81
INFO:root:| epoch   9 |   600/ 1710 batches | lr 0.02 | ms/batch  5.70 | loss  3.79
INFO:root:| epoch   9 |   800/ 1710 batches | lr 0.02 | ms/batch  5.70 | loss  3.80
INFO:root:| epoch   9 |  1000/ 1710 batches | lr 0.02 | ms/batch  5.71 | loss  3.74
INFO:root:| epoch   9 |  1200/ 1710 batches | lr 0.02 | ms/batch  5.72 | loss  3.78
INFO:root:| epoch   9 |  1400/ 1710 batches | lr 0.02 | ms/batch  5.76 | loss  3.74
INFO:root:| epoch   9 |  1600/ 1710 batches | lr 0.02 | ms/batch  6.42 | loss  3.74
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   9 | time: 10.53s | valid loss  3.78 | valid ppl    43.64
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  10 |   200/ 1710 batches | lr 0.02 | ms/batch  6.06 | loss  3.74
INFO:root:| epoch  10 |   400/ 1710 batches | lr 0.02 | ms/batch  5.78 | loss  3.69
INFO:root:| epoch  10 |   600/ 1710 batches | lr 0.02 | ms/batch  5.70 | loss  3.67
INFO:root:| epoch  10 |   800/ 1710 batches | lr 0.02 | ms/batch  5.69 | loss  3.68
INFO:root:| epoch  10 |  1000/ 1710 batches | lr 0.02 | ms/batch  6.64 | loss  3.62
INFO:root:| epoch  10 |  1200/ 1710 batches | lr 0.02 | ms/batch  7.43 | loss  3.66
INFO:root:| epoch  10 |  1400/ 1710 batches | lr 0.02 | ms/batch  6.30 | loss  3.62
INFO:root:| epoch  10 |  1600/ 1710 batches | lr 0.02 | ms/batch  5.80 | loss  3.62
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  10 | time: 10.67s | valid loss  3.66 | valid ppl    39.02
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:=========================================================================================
INFO:root:| End of training | test loss  3.77 | test ppl    43.29
INFO:root:=========================================================================================
INFO:root:----------- new value of n = 2, k = 2 -----------
INFO:root:Loading data
INFO:root:Vocab size 3005
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:| epoch   1 |   200/ 1890 batches | lr 0.02 | ms/batch  8.01 | loss  7.96
INFO:root:| epoch   1 |   400/ 1890 batches | lr 0.02 | ms/batch  6.69 | loss  7.74
INFO:root:| epoch   1 |   600/ 1890 batches | lr 0.02 | ms/batch  6.55 | loss  7.56
INFO:root:| epoch   1 |   800/ 1890 batches | lr 0.02 | ms/batch  6.97 | loss  7.37
INFO:root:| epoch   1 |  1000/ 1890 batches | lr 0.02 | ms/batch  8.28 | loss  7.15
INFO:root:| epoch   1 |  1200/ 1890 batches | lr 0.02 | ms/batch  6.67 | loss  6.91
INFO:root:| epoch   1 |  1400/ 1890 batches | lr 0.02 | ms/batch  6.62 | loss  6.66
INFO:root:| epoch   1 |  1600/ 1890 batches | lr 0.02 | ms/batch  8.30 | loss  6.38
INFO:root:| epoch   1 |  1800/ 1890 batches | lr 0.02 | ms/batch  6.86 | loss  6.11
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   1 | time: 13.72s | valid loss  5.83 | valid ppl   341.78
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   2 |   200/ 1890 batches | lr 0.02 | ms/batch  6.70 | loss  5.78
INFO:root:| epoch   2 |   400/ 1890 batches | lr 0.02 | ms/batch  8.41 | loss  5.57
INFO:root:| epoch   2 |   600/ 1890 batches | lr 0.02 | ms/batch  6.70 | loss  5.45
INFO:root:| epoch   2 |   800/ 1890 batches | lr 0.02 | ms/batch  6.80 | loss  5.36
INFO:root:| epoch   2 |  1000/ 1890 batches | lr 0.02 | ms/batch  6.58 | loss  5.24
INFO:root:| epoch   2 |  1200/ 1890 batches | lr 0.02 | ms/batch  6.53 | loss  5.13
INFO:root:| epoch   2 |  1400/ 1890 batches | lr 0.02 | ms/batch  6.62 | loss  5.05
INFO:root:| epoch   2 |  1600/ 1890 batches | lr 0.02 | ms/batch  6.68 | loss  4.98
INFO:root:| epoch   2 |  1800/ 1890 batches | lr 0.02 | ms/batch  6.62 | loss  4.90
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   2 | time: 13.05s | valid loss  4.81 | valid ppl   123.13
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   3 |   200/ 1890 batches | lr 0.02 | ms/batch  7.32 | loss  4.82
INFO:root:| epoch   3 |   400/ 1890 batches | lr 0.02 | ms/batch  8.27 | loss  4.75
INFO:root:| epoch   3 |   600/ 1890 batches | lr 0.02 | ms/batch  6.74 | loss  4.73
INFO:root:| epoch   3 |   800/ 1890 batches | lr 0.02 | ms/batch  6.75 | loss  4.73
INFO:root:| epoch   3 |  1000/ 1890 batches | lr 0.02 | ms/batch  8.50 | loss  4.68
INFO:root:| epoch   3 |  1200/ 1890 batches | lr 0.02 | ms/batch  6.79 | loss  4.65
INFO:root:| epoch   3 |  1400/ 1890 batches | lr 0.02 | ms/batch  6.87 | loss  4.63
INFO:root:| epoch   3 |  1600/ 1890 batches | lr 0.02 | ms/batch  7.53 | loss  4.65
INFO:root:| epoch   3 |  1800/ 1890 batches | lr 0.02 | ms/batch  7.69 | loss  4.63
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   3 | time: 14.04s | valid loss  4.60 | valid ppl    99.61
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   4 |   200/ 1890 batches | lr 0.02 | ms/batch  6.63 | loss  4.63
INFO:root:| epoch   4 |   400/ 1890 batches | lr 0.02 | ms/batch  6.57 | loss  4.59
INFO:root:| epoch   4 |   600/ 1890 batches | lr 0.02 | ms/batch  6.40 | loss  4.60
INFO:root:| epoch   4 |   800/ 1890 batches | lr 0.02 | ms/batch  6.41 | loss  4.63
INFO:root:| epoch   4 |  1000/ 1890 batches | lr 0.02 | ms/batch  6.57 | loss  4.59
INFO:root:| epoch   4 |  1200/ 1890 batches | lr 0.02 | ms/batch  7.04 | loss  4.57
INFO:root:| epoch   4 |  1400/ 1890 batches | lr 0.02 | ms/batch  8.14 | loss  4.56
INFO:root:| epoch   4 |  1600/ 1890 batches | lr 0.02 | ms/batch  6.57 | loss  4.58
INFO:root:| epoch   4 |  1800/ 1890 batches | lr 0.02 | ms/batch  6.41 | loss  4.56
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   4 | time: 12.89s | valid loss  4.55 | valid ppl    94.53
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   5 |   200/ 1890 batches | lr 0.02 | ms/batch  8.26 | loss  4.57
INFO:root:| epoch   5 |   400/ 1890 batches | lr 0.02 | ms/batch 12.08 | loss  4.54
INFO:root:| epoch   5 |   600/ 1890 batches | lr 0.02 | ms/batch  8.57 | loss  4.55
INFO:root:| epoch   5 |   800/ 1890 batches | lr 0.02 | ms/batch  8.93 | loss  4.58
INFO:root:| epoch   5 |  1000/ 1890 batches | lr 0.02 | ms/batch  7.26 | loss  4.54
INFO:root:| epoch   5 |  1200/ 1890 batches | lr 0.02 | ms/batch  7.01 | loss  4.54
INFO:root:| epoch   5 |  1400/ 1890 batches | lr 0.02 | ms/batch  7.89 | loss  4.52
INFO:root:| epoch   5 |  1600/ 1890 batches | lr 0.02 | ms/batch  7.86 | loss  4.55
INFO:root:| epoch   5 |  1800/ 1890 batches | lr 0.02 | ms/batch  7.34 | loss  4.53
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   5 | time: 15.84s | valid loss  4.52 | valid ppl    92.13
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   6 |   200/ 1890 batches | lr 0.02 | ms/batch  8.69 | loss  4.54
INFO:root:| epoch   6 |   400/ 1890 batches | lr 0.02 | ms/batch  6.89 | loss  4.51
INFO:root:| epoch   6 |   600/ 1890 batches | lr 0.02 | ms/batch  6.55 | loss  4.52
INFO:root:| epoch   6 |   800/ 1890 batches | lr 0.02 | ms/batch  7.17 | loss  4.56
INFO:root:| epoch   6 |  1000/ 1890 batches | lr 0.02 | ms/batch  7.73 | loss  4.52
INFO:root:| epoch   6 |  1200/ 1890 batches | lr 0.02 | ms/batch  6.54 | loss  4.51
INFO:root:| epoch   6 |  1400/ 1890 batches | lr 0.02 | ms/batch  6.55 | loss  4.49
INFO:root:| epoch   6 |  1600/ 1890 batches | lr 0.02 | ms/batch  8.43 | loss  4.53
INFO:root:| epoch   6 |  1800/ 1890 batches | lr 0.02 | ms/batch  6.69 | loss  4.50
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   6 | time: 13.77s | valid loss  4.50 | valid ppl    90.23
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   7 |   200/ 1890 batches | lr 0.02 | ms/batch  6.63 | loss  4.52
INFO:root:| epoch   7 |   400/ 1890 batches | lr 0.02 | ms/batch  6.47 | loss  4.49
INFO:root:| epoch   7 |   600/ 1890 batches | lr 0.02 | ms/batch  7.34 | loss  4.49
INFO:root:| epoch   7 |   800/ 1890 batches | lr 0.02 | ms/batch  7.57 | loss  4.53
INFO:root:| epoch   7 |  1000/ 1890 batches | lr 0.02 | ms/batch  7.69 | loss  4.49
INFO:root:| epoch   7 |  1200/ 1890 batches | lr 0.02 | ms/batch  6.55 | loss  4.48
INFO:root:| epoch   7 |  1400/ 1890 batches | lr 0.02 | ms/batch  6.55 | loss  4.47
INFO:root:| epoch   7 |  1600/ 1890 batches | lr 0.02 | ms/batch  8.55 | loss  4.50
INFO:root:| epoch   7 |  1800/ 1890 batches | lr 0.02 | ms/batch  6.62 | loss  4.47
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   7 | time: 13.53s | valid loss  4.48 | valid ppl    88.03
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   8 |   200/ 1890 batches | lr 0.02 | ms/batch  6.69 | loss  4.49
INFO:root:| epoch   8 |   400/ 1890 batches | lr 0.02 | ms/batch  8.43 | loss  4.46
INFO:root:| epoch   8 |   600/ 1890 batches | lr 0.02 | ms/batch  6.55 | loss  4.46
INFO:root:| epoch   8 |   800/ 1890 batches | lr 0.02 | ms/batch  6.54 | loss  4.50
INFO:root:| epoch   8 |  1000/ 1890 batches | lr 0.02 | ms/batch  6.52 | loss  4.46
INFO:root:| epoch   8 |  1200/ 1890 batches | lr 0.02 | ms/batch  6.54 | loss  4.45
INFO:root:| epoch   8 |  1400/ 1890 batches | lr 0.02 | ms/batch  6.38 | loss  4.43
INFO:root:| epoch   8 |  1600/ 1890 batches | lr 0.02 | ms/batch  6.46 | loss  4.46
INFO:root:| epoch   8 |  1800/ 1890 batches | lr 0.02 | ms/batch  6.53 | loss  4.44
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   8 | time: 12.85s | valid loss  4.44 | valid ppl    85.11
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   9 |   200/ 1890 batches | lr 0.02 | ms/batch  8.70 | loss  4.45
INFO:root:| epoch   9 |   400/ 1890 batches | lr 0.02 | ms/batch  6.59 | loss  4.42
INFO:root:| epoch   9 |   600/ 1890 batches | lr 0.02 | ms/batch  6.69 | loss  4.42
INFO:root:| epoch   9 |   800/ 1890 batches | lr 0.02 | ms/batch  6.57 | loss  4.45
INFO:root:| epoch   9 |  1000/ 1890 batches | lr 0.02 | ms/batch  7.08 | loss  4.41
INFO:root:| epoch   9 |  1200/ 1890 batches | lr 0.02 | ms/batch  8.81 | loss  4.41
INFO:root:| epoch   9 |  1400/ 1890 batches | lr 0.02 | ms/batch  6.78 | loss  4.39
INFO:root:| epoch   9 |  1600/ 1890 batches | lr 0.02 | ms/batch  6.52 | loss  4.41
INFO:root:| epoch   9 |  1800/ 1890 batches | lr 0.02 | ms/batch  8.54 | loss  4.38
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   9 | time: 13.98s | valid loss  4.40 | valid ppl    81.08
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  10 |   200/ 1890 batches | lr 0.02 | ms/batch  6.60 | loss  4.39
INFO:root:| epoch  10 |   400/ 1890 batches | lr 0.02 | ms/batch  6.63 | loss  4.36
INFO:root:| epoch  10 |   600/ 1890 batches | lr 0.02 | ms/batch  8.60 | loss  4.36
INFO:root:| epoch  10 |   800/ 1890 batches | lr 0.02 | ms/batch  6.57 | loss  4.39
INFO:root:| epoch  10 |  1000/ 1890 batches | lr 0.02 | ms/batch  6.56 | loss  4.35
INFO:root:| epoch  10 |  1200/ 1890 batches | lr 0.02 | ms/batch  7.44 | loss  4.34
INFO:root:| epoch  10 |  1400/ 1890 batches | lr 0.02 | ms/batch  7.80 | loss  4.32
INFO:root:| epoch  10 |  1600/ 1890 batches | lr 0.02 | ms/batch  6.64 | loss  4.35
INFO:root:| epoch  10 |  1800/ 1890 batches | lr 0.02 | ms/batch  6.50 | loss  4.32
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  10 | time: 13.45s | valid loss  4.33 | valid ppl    76.05
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:=========================================================================================
INFO:root:| End of training | test loss  4.50 | test ppl    90.38
INFO:root:=========================================================================================
INFO:root:----------- new value of n = 2, k = 3 -----------
INFO:root:Loading data
INFO:root:Vocab size 4005
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:| epoch   1 |   200/ 2070 batches | lr 0.02 | ms/batch  9.11 | loss  8.28
INFO:root:| epoch   1 |   400/ 2070 batches | lr 0.02 | ms/batch  7.77 | loss  8.10
INFO:root:| epoch   1 |   600/ 2070 batches | lr 0.02 | ms/batch  8.64 | loss  7.97
INFO:root:| epoch   1 |   800/ 2070 batches | lr 0.02 | ms/batch  8.64 | loss  7.81
INFO:root:| epoch   1 |  1000/ 2070 batches | lr 0.02 | ms/batch  7.78 | loss  7.67
INFO:root:| epoch   1 |  1200/ 2070 batches | lr 0.02 | ms/batch  7.86 | loss  7.50
INFO:root:| epoch   1 |  1400/ 2070 batches | lr 0.02 | ms/batch  7.83 | loss  7.31
INFO:root:| epoch   1 |  1600/ 2070 batches | lr 0.02 | ms/batch  7.99 | loss  7.14
INFO:root:| epoch   1 |  1800/ 2070 batches | lr 0.02 | ms/batch  8.47 | loss  6.89
INFO:root:| epoch   1 |  2000/ 2070 batches | lr 0.02 | ms/batch  8.47 | loss  6.69
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   1 | time: 17.26s | valid loss  6.50 | valid ppl   666.72
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   2 |   200/ 2070 batches | lr 0.02 | ms/batch  7.76 | loss  6.38
INFO:root:| epoch   2 |   400/ 2070 batches | lr 0.02 | ms/batch  8.79 | loss  6.15
INFO:root:| epoch   2 |   600/ 2070 batches | lr 0.02 | ms/batch  8.27 | loss  6.02
INFO:root:| epoch   2 |   800/ 2070 batches | lr 0.02 | ms/batch  7.54 | loss  5.76
INFO:root:| epoch   2 |  1000/ 2070 batches | lr 0.02 | ms/batch  8.79 | loss  5.76
INFO:root:| epoch   2 |  1200/ 2070 batches | lr 0.02 | ms/batch  8.60 | loss  5.62
INFO:root:| epoch   2 |  1400/ 2070 batches | lr 0.02 | ms/batch  7.94 | loss  5.50
INFO:root:| epoch   2 |  1600/ 2070 batches | lr 0.02 | ms/batch  7.51 | loss  5.50
INFO:root:| epoch   2 |  1800/ 2070 batches | lr 0.02 | ms/batch  7.59 | loss  5.33
INFO:root:| epoch   2 |  2000/ 2070 batches | lr 0.02 | ms/batch  7.89 | loss  5.34
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   2 | time: 17.09s | valid loss  5.31 | valid ppl   203.29
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   3 |   200/ 2070 batches | lr 0.02 | ms/batch  8.34 | loss  5.23
INFO:root:| epoch   3 |   400/ 2070 batches | lr 0.02 | ms/batch  7.69 | loss  5.22
INFO:root:| epoch   3 |   600/ 2070 batches | lr 0.02 | ms/batch  9.70 | loss  5.26
INFO:root:| epoch   3 |   800/ 2070 batches | lr 0.02 | ms/batch  7.89 | loss  5.08
INFO:root:| epoch   3 |  1000/ 2070 batches | lr 0.02 | ms/batch  7.56 | loss  5.21
INFO:root:| epoch   3 |  1200/ 2070 batches | lr 0.02 | ms/batch  9.45 | loss  5.15
INFO:root:| epoch   3 |  1400/ 2070 batches | lr 0.02 | ms/batch  7.96 | loss  5.09
INFO:root:| epoch   3 |  1600/ 2070 batches | lr 0.02 | ms/batch  7.83 | loss  5.18
INFO:root:| epoch   3 |  1800/ 2070 batches | lr 0.02 | ms/batch  9.47 | loss  5.05
INFO:root:| epoch   3 |  2000/ 2070 batches | lr 0.02 | ms/batch  7.61 | loss  5.12
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   3 | time: 17.39s | valid loss  5.13 | valid ppl   169.45
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   4 |   200/ 2070 batches | lr 0.02 | ms/batch  8.11 | loss  5.06
INFO:root:| epoch   4 |   400/ 2070 batches | lr 0.02 | ms/batch  9.31 | loss  5.08
INFO:root:| epoch   4 |   600/ 2070 batches | lr 0.02 | ms/batch  7.68 | loss  5.14
INFO:root:| epoch   4 |   800/ 2070 batches | lr 0.02 | ms/batch  7.95 | loss  4.97
INFO:root:| epoch   4 |  1000/ 2070 batches | lr 0.02 | ms/batch  8.98 | loss  5.12
INFO:root:| epoch   4 |  1200/ 2070 batches | lr 0.02 | ms/batch  7.55 | loss  5.06
INFO:root:| epoch   4 |  1400/ 2070 batches | lr 0.02 | ms/batch  7.53 | loss  5.00
INFO:root:| epoch   4 |  1600/ 2070 batches | lr 0.02 | ms/batch  8.05 | loss  5.10
INFO:root:| epoch   4 |  1800/ 2070 batches | lr 0.02 | ms/batch  9.24 | loss  4.98
INFO:root:| epoch   4 |  2000/ 2070 batches | lr 0.02 | ms/batch  7.70 | loss  5.04
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   4 | time: 17.11s | valid loss  5.07 | valid ppl   159.60
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   5 |   200/ 2070 batches | lr 0.02 | ms/batch  7.67 | loss  4.99
INFO:root:| epoch   5 |   400/ 2070 batches | lr 0.02 | ms/batch  8.74 | loss  5.02
INFO:root:| epoch   5 |   600/ 2070 batches | lr 0.02 | ms/batch  8.56 | loss  5.08
INFO:root:| epoch   5 |   800/ 2070 batches | lr 0.02 | ms/batch  7.72 | loss  4.91
INFO:root:| epoch   5 |  1000/ 2070 batches | lr 0.02 | ms/batch  8.69 | loss  5.07
INFO:root:| epoch   5 |  1200/ 2070 batches | lr 0.02 | ms/batch  8.42 | loss  5.01
INFO:root:| epoch   5 |  1400/ 2070 batches | lr 0.02 | ms/batch  7.55 | loss  4.95
INFO:root:| epoch   5 |  1600/ 2070 batches | lr 0.02 | ms/batch  7.60 | loss  5.06
INFO:root:| epoch   5 |  1800/ 2070 batches | lr 0.02 | ms/batch  7.77 | loss  4.94
INFO:root:| epoch   5 |  2000/ 2070 batches | lr 0.02 | ms/batch  8.28 | loss  5.00
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   5 | time: 17.17s | valid loss  5.04 | valid ppl   153.83
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   6 |   200/ 2070 batches | lr 0.02 | ms/batch  8.02 | loss  4.95
INFO:root:| epoch   6 |   400/ 2070 batches | lr 0.02 | ms/batch  7.53 | loss  4.97
INFO:root:| epoch   6 |   600/ 2070 batches | lr 0.02 | ms/batch  7.60 | loss  5.04
INFO:root:| epoch   6 |   800/ 2070 batches | lr 0.02 | ms/batch  7.68 | loss  4.87
INFO:root:| epoch   6 |  1000/ 2070 batches | lr 0.02 | ms/batch  7.54 | loss  5.03
INFO:root:| epoch   6 |  1200/ 2070 batches | lr 0.02 | ms/batch 10.51 | loss  4.97
INFO:root:| epoch   6 |  1400/ 2070 batches | lr 0.02 | ms/batch 10.89 | loss  4.92
INFO:root:| epoch   6 |  1600/ 2070 batches | lr 0.02 | ms/batch 11.51 | loss  5.02
INFO:root:| epoch   6 |  1800/ 2070 batches | lr 0.02 | ms/batch 10.08 | loss  4.90
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:Exiting from training early
INFO:root:=========================================================================================
INFO:root:| End of training | test loss  5.25 | test ppl   190.98
INFO:root:=========================================================================================
INFO:root:----------- new value of n = 2, k = 4 -----------
INFO:root:Loading data
INFO:root:Vocab size 5005
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:| epoch   1 |   200/ 2250 batches | lr 0.02 | ms/batch 10.35 | loss  8.50
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:Exiting from training early
INFO:root:Namespace(cuda=False, train=True, test=False)
INFO:root:----------- new value of n = 1, k = 1 -----------
INFO:root:Loading data
INFO:root:Vocab size 2005
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:| epoch   1 |   200/ 1710 batches | lr 20.00 | ms/batch  6.68 | loss  4.36
INFO:root:| epoch   1 |   400/ 1710 batches | lr 20.00 | ms/batch  5.72 | loss  3.36
INFO:root:| epoch   1 |   600/ 1710 batches | lr 20.00 | ms/batch  6.71 | loss  3.27
INFO:root:| epoch   1 |   800/ 1710 batches | lr 20.00 | ms/batch  5.23 | loss  3.15
INFO:root:| epoch   1 |  1000/ 1710 batches | lr 20.00 | ms/batch  5.15 | loss  3.18
INFO:root:| epoch   1 |  1200/ 1710 batches | lr 20.00 | ms/batch  5.09 | loss  3.11
INFO:root:| epoch   1 |  1400/ 1710 batches | lr 20.00 | ms/batch  6.12 | loss  3.05
INFO:root:| epoch   1 |  1600/ 1710 batches | lr 20.00 | ms/batch  5.85 | loss  3.02
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   1 | time:  9.98s | valid loss  3.59 | valid ppl    36.22
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   2 |   200/ 1710 batches | lr 20.00 | ms/batch  5.52 | loss  3.07
INFO:root:| epoch   2 |   400/ 1710 batches | lr 20.00 | ms/batch  5.00 | loss  3.06
INFO:root:| epoch   2 |   600/ 1710 batches | lr 20.00 | ms/batch  5.00 | loss  3.04
INFO:root:| epoch   2 |   800/ 1710 batches | lr 20.00 | ms/batch  6.77 | loss  2.97
INFO:root:| epoch   2 |  1000/ 1710 batches | lr 20.00 | ms/batch  5.98 | loss  3.03
INFO:root:| epoch   2 |  1200/ 1710 batches | lr 20.00 | ms/batch 11.38 | loss  2.98
INFO:root:| epoch   2 |  1400/ 1710 batches | lr 20.00 | ms/batch  8.67 | loss  2.93
INFO:root:| epoch   2 |  1600/ 1710 batches | lr 20.00 | ms/batch 10.70 | loss  2.95
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   2 | time: 12.96s | valid loss  3.54 | valid ppl    34.33
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   3 |   200/ 1710 batches | lr 20.00 | ms/batch  6.44 | loss  3.00
INFO:root:| epoch   3 |   400/ 1710 batches | lr 20.00 | ms/batch  6.26 | loss  2.95
INFO:root:| epoch   3 |   600/ 1710 batches | lr 20.00 | ms/batch  9.06 | loss  2.91
INFO:root:| epoch   3 |   800/ 1710 batches | lr 20.00 | ms/batch  6.99 | loss  2.87
INFO:root:| epoch   3 |  1000/ 1710 batches | lr 20.00 | ms/batch 10.65 | loss  2.91
INFO:root:| epoch   3 |  1200/ 1710 batches | lr 20.00 | ms/batch  5.91 | loss  2.89
INFO:root:| epoch   3 |  1400/ 1710 batches | lr 20.00 | ms/batch  7.22 | loss  2.87
INFO:root:| epoch   3 |  1600/ 1710 batches | lr 20.00 | ms/batch  5.69 | loss  2.86
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   3 | time: 12.29s | valid loss  3.60 | valid ppl    36.49
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   4 |   200/ 1710 batches | lr 5.00 | ms/batch  5.34 | loss  2.67
INFO:root:| epoch   4 |   400/ 1710 batches | lr 5.00 | ms/batch  5.55 | loss  2.57
INFO:root:| epoch   4 |   600/ 1710 batches | lr 5.00 | ms/batch  6.85 | loss  2.48
INFO:root:| epoch   4 |   800/ 1710 batches | lr 5.00 | ms/batch  5.17 | loss  2.51
INFO:root:| epoch   4 |  1000/ 1710 batches | lr 5.00 | ms/batch  5.17 | loss  2.45
INFO:root:| epoch   4 |  1200/ 1710 batches | lr 5.00 | ms/batch  5.22 | loss  2.42
INFO:root:| epoch   4 |  1400/ 1710 batches | lr 5.00 | ms/batch  6.44 | loss  2.37
INFO:root:| epoch   4 |  1600/ 1710 batches | lr 5.00 | ms/batch  6.15 | loss  2.32
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   4 | time:  9.90s | valid loss  3.15 | valid ppl    23.40
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   5 |   200/ 1710 batches | lr 5.00 | ms/batch  5.43 | loss  2.45
INFO:root:| epoch   5 |   400/ 1710 batches | lr 5.00 | ms/batch  5.81 | loss  2.43
INFO:root:| epoch   5 |   600/ 1710 batches | lr 5.00 | ms/batch  7.09 | loss  2.35
INFO:root:| epoch   5 |   800/ 1710 batches | lr 5.00 | ms/batch  6.20 | loss  2.35
INFO:root:| epoch   5 |  1000/ 1710 batches | lr 5.00 | ms/batch  5.47 | loss  2.32
INFO:root:| epoch   5 |  1200/ 1710 batches | lr 5.00 | ms/batch  5.22 | loss  2.30
INFO:root:| epoch   5 |  1400/ 1710 batches | lr 5.00 | ms/batch  5.19 | loss  2.30
INFO:root:| epoch   5 |  1600/ 1710 batches | lr 5.00 | ms/batch  5.21 | loss  2.26
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   5 | time:  9.78s | valid loss  3.21 | valid ppl    24.89
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   6 |   200/ 1710 batches | lr 1.25 | ms/batch  5.52 | loss  2.36
INFO:root:| epoch   6 |   400/ 1710 batches | lr 1.25 | ms/batch  5.52 | loss  2.39
INFO:root:| epoch   6 |   600/ 1710 batches | lr 1.25 | ms/batch  5.26 | loss  2.35
INFO:root:| epoch   6 |   800/ 1710 batches | lr 1.25 | ms/batch  7.46 | loss  2.32
INFO:root:| epoch   6 |  1000/ 1710 batches | lr 1.25 | ms/batch  5.78 | loss  2.29
INFO:root:| epoch   6 |  1200/ 1710 batches | lr 1.25 | ms/batch  5.39 | loss  2.21
INFO:root:| epoch   6 |  1400/ 1710 batches | lr 1.25 | ms/batch  5.21 | loss  2.16
INFO:root:| epoch   6 |  1600/ 1710 batches | lr 1.25 | ms/batch  5.21 | loss  2.12
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   6 | time:  9.72s | valid loss  3.11 | valid ppl    22.49
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   7 |   200/ 1710 batches | lr 1.25 | ms/batch  5.33 | loss  2.30
INFO:root:| epoch   7 |   400/ 1710 batches | lr 1.25 | ms/batch  6.07 | loss  2.29
INFO:root:| epoch   7 |   600/ 1710 batches | lr 1.25 | ms/batch  6.63 | loss  2.24
INFO:root:| epoch   7 |   800/ 1710 batches | lr 1.25 | ms/batch  5.40 | loss  2.24
INFO:root:| epoch   7 |  1000/ 1710 batches | lr 1.25 | ms/batch  5.40 | loss  2.21
INFO:root:| epoch   7 |  1200/ 1710 batches | lr 1.25 | ms/batch  5.25 | loss  2.16
INFO:root:| epoch   7 |  1400/ 1710 batches | lr 1.25 | ms/batch  6.86 | loss  2.16
INFO:root:| epoch   7 |  1600/ 1710 batches | lr 1.25 | ms/batch  5.50 | loss  2.12
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   7 | time:  9.94s | valid loss  3.13 | valid ppl    22.93
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   8 |   200/ 1710 batches | lr 0.31 | ms/batch  5.28 | loss  2.27
INFO:root:| epoch   8 |   400/ 1710 batches | lr 0.31 | ms/batch  5.27 | loss  2.31
INFO:root:| epoch   8 |   600/ 1710 batches | lr 0.31 | ms/batch  5.25 | loss  2.31
INFO:root:| epoch   8 |   800/ 1710 batches | lr 0.31 | ms/batch  5.78 | loss  2.25
INFO:root:| epoch   8 |  1000/ 1710 batches | lr 0.31 | ms/batch  6.70 | loss  2.22
INFO:root:| epoch   8 |  1200/ 1710 batches | lr 0.31 | ms/batch  5.38 | loss  2.15
INFO:root:| epoch   8 |  1400/ 1710 batches | lr 0.31 | ms/batch  5.30 | loss  2.09
INFO:root:| epoch   8 |  1600/ 1710 batches | lr 0.31 | ms/batch  5.26 | loss  2.05
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   8 | time:  9.49s | valid loss  3.10 | valid ppl    22.20
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   9 |   200/ 1710 batches | lr 0.31 | ms/batch  5.26 | loss  2.25
INFO:root:| epoch   9 |   400/ 1710 batches | lr 0.31 | ms/batch  5.49 | loss  2.26
INFO:root:| epoch   9 |   600/ 1710 batches | lr 0.31 | ms/batch  5.58 | loss  2.25
INFO:root:| epoch   9 |   800/ 1710 batches | lr 0.31 | ms/batch  6.94 | loss  2.21
INFO:root:| epoch   9 |  1000/ 1710 batches | lr 0.31 | ms/batch  5.40 | loss  2.19
INFO:root:| epoch   9 |  1200/ 1710 batches | lr 0.31 | ms/batch  5.51 | loss  2.13
INFO:root:| epoch   9 |  1400/ 1710 batches | lr 0.31 | ms/batch  5.25 | loss  2.10
INFO:root:| epoch   9 |  1600/ 1710 batches | lr 0.31 | ms/batch  5.31 | loss  2.07
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   9 | time:  9.60s | valid loss  3.10 | valid ppl    22.25
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  10 |   200/ 1710 batches | lr 0.08 | ms/batch  6.44 | loss  2.25
INFO:root:| epoch  10 |   400/ 1710 batches | lr 0.08 | ms/batch  5.27 | loss  2.25
INFO:root:| epoch  10 |   600/ 1710 batches | lr 0.08 | ms/batch  5.54 | loss  2.25
INFO:root:| epoch  10 |   800/ 1710 batches | lr 0.08 | ms/batch  5.36 | loss  2.21
INFO:root:| epoch  10 |  1000/ 1710 batches | lr 0.08 | ms/batch  6.51 | loss  2.17
INFO:root:| epoch  10 |  1200/ 1710 batches | lr 0.08 | ms/batch  7.88 | loss  2.12
INFO:root:| epoch  10 |  1400/ 1710 batches | lr 0.08 | ms/batch  5.25 | loss  2.08
INFO:root:| epoch  10 |  1600/ 1710 batches | lr 0.08 | ms/batch  5.24 | loss  2.04
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  10 | time: 10.15s | valid loss  3.10 | valid ppl    22.25
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:Namespace(cuda=False, train=True, test=False)
INFO:root:----------- new value of n = 1, k = 1 -----------
INFO:root:Loading data
INFO:root:Vocab size 2005
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:| epoch   1 |   200/ 1710 batches | lr 20.00 | ms/batch  9.21 | loss  4.36
INFO:root:| epoch   1 |   400/ 1710 batches | lr 20.00 | ms/batch  6.19 | loss  3.36
INFO:root:| epoch   1 |   600/ 1710 batches | lr 20.00 | ms/batch  5.82 | loss  3.27
INFO:root:| epoch   1 |   800/ 1710 batches | lr 20.00 | ms/batch  5.75 | loss  3.15
INFO:root:| epoch   1 |  1000/ 1710 batches | lr 20.00 | ms/batch  5.27 | loss  3.18
INFO:root:| epoch   1 |  1200/ 1710 batches | lr 20.00 | ms/batch  5.01 | loss  3.11
INFO:root:| epoch   1 |  1400/ 1710 batches | lr 20.00 | ms/batch  6.02 | loss  3.05
INFO:root:| epoch   1 |  1600/ 1710 batches | lr 20.00 | ms/batch  5.87 | loss  3.02
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   1 | time: 10.47s | valid loss  3.59 | valid ppl    36.22
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   2 |   200/ 1710 batches | lr 20.00 | ms/batch  5.15 | loss  3.07
INFO:root:| epoch   2 |   400/ 1710 batches | lr 20.00 | ms/batch  4.94 | loss  3.06
INFO:root:| epoch   2 |   600/ 1710 batches | lr 20.00 | ms/batch  5.16 | loss  3.04
INFO:root:| epoch   2 |   800/ 1710 batches | lr 20.00 | ms/batch  5.17 | loss  2.97
INFO:root:| epoch   2 |  1000/ 1710 batches | lr 20.00 | ms/batch  4.99 | loss  3.03
INFO:root:| epoch   2 |  1200/ 1710 batches | lr 20.00 | ms/batch  5.11 | loss  2.98
INFO:root:| epoch   2 |  1400/ 1710 batches | lr 20.00 | ms/batch  5.67 | loss  2.93
INFO:root:| epoch   2 |  1600/ 1710 batches | lr 20.00 | ms/batch  6.76 | loss  2.95
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   2 | time:  9.48s | valid loss  3.54 | valid ppl    34.33
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   3 |   200/ 1710 batches | lr 20.00 | ms/batch  6.49 | loss  3.00
INFO:root:| epoch   3 |   400/ 1710 batches | lr 20.00 | ms/batch  6.47 | loss  2.95
INFO:root:| epoch   3 |   600/ 1710 batches | lr 20.00 | ms/batch  7.85 | loss  2.91
INFO:root:| epoch   3 |   800/ 1710 batches | lr 20.00 | ms/batch 10.00 | loss  2.87
INFO:root:| epoch   3 |  1000/ 1710 batches | lr 20.00 | ms/batch  9.01 | loss  2.91
INFO:root:| epoch   3 |  1200/ 1710 batches | lr 20.00 | ms/batch 11.78 | loss  2.89
INFO:root:| epoch   3 |  1400/ 1710 batches | lr 20.00 | ms/batch 10.99 | loss  2.87
INFO:root:| epoch   3 |  1600/ 1710 batches | lr 20.00 | ms/batch  7.23 | loss  2.86
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   3 | time: 15.22s | valid loss  3.60 | valid ppl    36.49
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   4 |   200/ 1710 batches | lr 5.00 | ms/batch  7.84 | loss  2.67
INFO:root:| epoch   4 |   400/ 1710 batches | lr 5.00 | ms/batch  7.26 | loss  2.57
INFO:root:| epoch   4 |   600/ 1710 batches | lr 5.00 | ms/batch 51.22 | loss  2.48
INFO:root:| epoch   4 |   800/ 1710 batches | lr 5.00 | ms/batch 11.53 | loss  2.51
INFO:root:| epoch   4 |  1000/ 1710 batches | lr 5.00 | ms/batch  7.73 | loss  2.45
INFO:root:| epoch   4 |  1200/ 1710 batches | lr 5.00 | ms/batch  7.60 | loss  2.42
INFO:root:| epoch   4 |  1400/ 1710 batches | lr 5.00 | ms/batch 11.16 | loss  2.37
INFO:root:| epoch   4 |  1600/ 1710 batches | lr 5.00 | ms/batch 12.66 | loss  2.32
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   4 | time: 24.91s | valid loss  3.15 | valid ppl    23.40
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   5 |   200/ 1710 batches | lr 5.00 | ms/batch  8.63 | loss  2.45
INFO:root:| epoch   5 |   400/ 1710 batches | lr 5.00 | ms/batch  7.39 | loss  2.43
INFO:root:| epoch   5 |   600/ 1710 batches | lr 5.00 | ms/batch  8.81 | loss  2.35
INFO:root:| epoch   5 |   800/ 1710 batches | lr 5.00 | ms/batch  7.92 | loss  2.35
INFO:root:| epoch   5 |  1000/ 1710 batches | lr 5.00 | ms/batch  7.27 | loss  2.32
INFO:root:| epoch   5 |  1200/ 1710 batches | lr 5.00 | ms/batch  8.67 | loss  2.30
INFO:root:| epoch   5 |  1400/ 1710 batches | lr 5.00 | ms/batch  8.05 | loss  2.30
INFO:root:| epoch   5 |  1600/ 1710 batches | lr 5.00 | ms/batch  7.81 | loss  2.26
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   5 | time: 14.05s | valid loss  3.21 | valid ppl    24.89
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   6 |   200/ 1710 batches | lr 1.25 | ms/batch 11.21 | loss  2.36
INFO:root:| epoch   6 |   400/ 1710 batches | lr 1.25 | ms/batch 12.18 | loss  2.39
INFO:root:| epoch   6 |   600/ 1710 batches | lr 1.25 | ms/batch 83.37 | loss  2.35
INFO:root:| epoch   6 |   800/ 1710 batches | lr 1.25 | ms/batch  7.61 | loss  2.32
INFO:root:| epoch   6 |  1000/ 1710 batches | lr 1.25 | ms/batch  7.24 | loss  2.29
INFO:root:| epoch   6 |  1200/ 1710 batches | lr 1.25 | ms/batch  8.23 | loss  2.21
INFO:root:| epoch   6 |  1400/ 1710 batches | lr 1.25 | ms/batch  8.11 | loss  2.16
INFO:root:| epoch   6 |  1600/ 1710 batches | lr 1.25 | ms/batch  8.68 | loss  2.12
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   6 | time: 31.34s | valid loss  3.11 | valid ppl    22.49
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   7 |   200/ 1710 batches | lr 1.25 | ms/batch  9.53 | loss  2.30
INFO:root:| epoch   7 |   400/ 1710 batches | lr 1.25 | ms/batch  6.24 | loss  2.29
INFO:root:| epoch   7 |   600/ 1710 batches | lr 1.25 | ms/batch  9.79 | loss  2.24
INFO:root:| epoch   7 |   800/ 1710 batches | lr 1.25 | ms/batch  5.87 | loss  2.24
INFO:root:| epoch   7 |  1000/ 1710 batches | lr 1.25 | ms/batch  5.82 | loss  2.21
INFO:root:| epoch   7 |  1200/ 1710 batches | lr 1.25 | ms/batch  8.12 | loss  2.16
INFO:root:| epoch   7 |  1400/ 1710 batches | lr 1.25 | ms/batch  6.47 | loss  2.16
INFO:root:| epoch   7 |  1600/ 1710 batches | lr 1.25 | ms/batch  5.35 | loss  2.12
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   7 | time: 12.27s | valid loss  3.13 | valid ppl    22.93
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   8 |   200/ 1710 batches | lr 0.31 | ms/batch  7.79 | loss  2.27
INFO:root:| epoch   8 |   400/ 1710 batches | lr 0.31 | ms/batch  6.17 | loss  2.31
INFO:root:| epoch   8 |   600/ 1710 batches | lr 0.31 | ms/batch 10.93 | loss  2.31
INFO:root:| epoch   8 |   800/ 1710 batches | lr 0.31 | ms/batch  8.52 | loss  2.25
INFO:root:| epoch   8 |  1000/ 1710 batches | lr 0.31 | ms/batch  7.55 | loss  2.22
INFO:root:| epoch   8 |  1200/ 1710 batches | lr 0.31 | ms/batch 10.88 | loss  2.15
INFO:root:| epoch   8 |  1400/ 1710 batches | lr 0.31 | ms/batch  7.53 | loss  2.09
INFO:root:| epoch   8 |  1600/ 1710 batches | lr 0.31 | ms/batch  8.37 | loss  2.05
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   8 | time: 14.62s | valid loss  3.10 | valid ppl    22.20
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   9 |   200/ 1710 batches | lr 0.31 | ms/batch  5.69 | loss  2.25
INFO:root:| epoch   9 |   400/ 1710 batches | lr 0.31 | ms/batch  5.53 | loss  2.26
INFO:root:| epoch   9 |   600/ 1710 batches | lr 0.31 | ms/batch  5.42 | loss  2.25
INFO:root:| epoch   9 |   800/ 1710 batches | lr 0.31 | ms/batch  9.97 | loss  2.21
INFO:root:| epoch   9 |  1000/ 1710 batches | lr 0.31 | ms/batch  7.13 | loss  2.19
INFO:root:| epoch   9 |  1200/ 1710 batches | lr 0.31 | ms/batch  8.02 | loss  2.13
INFO:root:| epoch   9 |  1400/ 1710 batches | lr 0.31 | ms/batch 13.71 | loss  2.10
INFO:root:| epoch   9 |  1600/ 1710 batches | lr 0.31 | ms/batch  9.04 | loss  2.07
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   9 | time: 14.38s | valid loss  3.10 | valid ppl    22.25
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  10 |   200/ 1710 batches | lr 0.08 | ms/batch  9.54 | loss  2.25
INFO:root:| epoch  10 |   400/ 1710 batches | lr 0.08 | ms/batch  8.90 | loss  2.25
INFO:root:| epoch  10 |   600/ 1710 batches | lr 0.08 | ms/batch 10.43 | loss  2.25
INFO:root:| epoch  10 |   800/ 1710 batches | lr 0.08 | ms/batch  8.88 | loss  2.21
INFO:root:| epoch  10 |  1000/ 1710 batches | lr 0.08 | ms/batch  6.39 | loss  2.17
INFO:root:| epoch  10 |  1200/ 1710 batches | lr 0.08 | ms/batch  7.54 | loss  2.12
INFO:root:| epoch  10 |  1400/ 1710 batches | lr 0.08 | ms/batch  6.15 | loss  2.08
INFO:root:| epoch  10 |  1600/ 1710 batches | lr 0.08 | ms/batch  9.29 | loss  2.04
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  10 | time: 15.01s | valid loss  3.10 | valid ppl    22.25
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:=========================================================================================
INFO:root:| End of training | test loss  3.43 | test ppl    30.92
INFO:root:=========================================================================================
INFO:root:----------- new value of n = 1, k = 2 -----------
INFO:root:Loading data
INFO:root:Vocab size 3005
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:| epoch   1 |   200/ 1890 batches | lr 0.02 | ms/batch 10.75 | loss  7.96
INFO:root:| epoch   1 |   400/ 1890 batches | lr 0.02 | ms/batch  9.47 | loss  7.76
INFO:root:| epoch   1 |   600/ 1890 batches | lr 0.02 | ms/batch  8.58 | loss  7.60
INFO:root:| epoch   1 |   800/ 1890 batches | lr 0.02 | ms/batch  6.79 | loss  7.42
INFO:root:| epoch   1 |  1000/ 1890 batches | lr 0.02 | ms/batch  6.71 | loss  7.26
INFO:root:| epoch   1 |  1200/ 1890 batches | lr 0.02 | ms/batch 10.49 | loss  7.07
INFO:root:| epoch   1 |  1400/ 1890 batches | lr 0.02 | ms/batch  9.06 | loss  6.90
INFO:root:| epoch   1 |  1600/ 1890 batches | lr 0.02 | ms/batch  9.66 | loss  6.71
INFO:root:| epoch   1 |  1800/ 1890 batches | lr 0.02 | ms/batch 11.86 | loss  6.52
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   1 | time: 17.43s | valid loss  6.33 | valid ppl   558.77
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   2 |   200/ 1890 batches | lr 0.02 | ms/batch  7.35 | loss  6.25
INFO:root:| epoch   2 |   400/ 1890 batches | lr 0.02 | ms/batch 12.82 | loss  6.06
INFO:root:| epoch   2 |   600/ 1890 batches | lr 0.02 | ms/batch 28.54 | loss  5.88
INFO:root:| epoch   2 |   800/ 1890 batches | lr 0.02 | ms/batch 18.16 | loss  5.72
INFO:root:| epoch   2 |  1000/ 1890 batches | lr 0.02 | ms/batch  8.10 | loss  5.61
INFO:root:| epoch   2 |  1200/ 1890 batches | lr 0.02 | ms/batch  7.48 | loss  5.49
INFO:root:| epoch   2 |  1400/ 1890 batches | lr 0.02 | ms/batch 11.52 | loss  5.42
INFO:root:| epoch   2 |  1600/ 1890 batches | lr 0.02 | ms/batch  9.06 | loss  5.35
INFO:root:| epoch   2 |  1800/ 1890 batches | lr 0.02 | ms/batch  8.02 | loss  5.27
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   2 | time: 23.37s | valid loss  5.20 | valid ppl   180.83
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   3 |   200/ 1890 batches | lr 0.02 | ms/batch  9.66 | loss  5.17
INFO:root:| epoch   3 |   400/ 1890 batches | lr 0.02 | ms/batch  7.11 | loss  5.13
INFO:root:| epoch   3 |   600/ 1890 batches | lr 0.02 | ms/batch  8.03 | loss  5.05
INFO:root:| epoch   3 |   800/ 1890 batches | lr 0.02 | ms/batch  5.82 | loss  4.98
INFO:root:| epoch   3 |  1000/ 1890 batches | lr 0.02 | ms/batch  5.74 | loss  4.94
INFO:root:| epoch   3 |  1200/ 1890 batches | lr 0.02 | ms/batch  6.69 | loss  4.87
INFO:root:| epoch   3 |  1400/ 1890 batches | lr 0.02 | ms/batch  6.59 | loss  4.84
INFO:root:| epoch   3 |  1600/ 1890 batches | lr 0.02 | ms/batch  5.91 | loss  4.80
INFO:root:| epoch   3 |  1800/ 1890 batches | lr 0.02 | ms/batch  6.05 | loss  4.76
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   3 | time: 12.99s | valid loss  4.72 | valid ppl   112.47
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   4 |   200/ 1890 batches | lr 0.02 | ms/batch  7.35 | loss  4.71
INFO:root:| epoch   4 |   400/ 1890 batches | lr 0.02 | ms/batch  5.74 | loss  4.72
INFO:root:| epoch   4 |   600/ 1890 batches | lr 0.02 | ms/batch  5.87 | loss  4.69
INFO:root:| epoch   4 |   800/ 1890 batches | lr 0.02 | ms/batch  5.64 | loss  4.66
INFO:root:| epoch   4 |  1000/ 1890 batches | lr 0.02 | ms/batch  5.71 | loss  4.66
INFO:root:| epoch   4 |  1200/ 1890 batches | lr 0.02 | ms/batch  7.86 | loss  4.63
INFO:root:| epoch   4 |  1400/ 1890 batches | lr 0.02 | ms/batch  6.77 | loss  4.63
INFO:root:| epoch   4 |  1600/ 1890 batches | lr 0.02 | ms/batch  7.07 | loss  4.63
INFO:root:| epoch   4 |  1800/ 1890 batches | lr 0.02 | ms/batch  6.84 | loss  4.61
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   4 | time: 12.59s | valid loss  4.59 | valid ppl    98.95
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   5 |   200/ 1890 batches | lr 0.02 | ms/batch  6.56 | loss  4.59
INFO:root:| epoch   5 |   400/ 1890 batches | lr 0.02 | ms/batch  6.22 | loss  4.62
INFO:root:| epoch   5 |   600/ 1890 batches | lr 0.02 | ms/batch  5.71 | loss  4.59
INFO:root:| epoch   5 |   800/ 1890 batches | lr 0.02 | ms/batch  7.73 | loss  4.58
INFO:root:| epoch   5 |  1000/ 1890 batches | lr 0.02 | ms/batch  6.61 | loss  4.58
INFO:root:| epoch   5 |  1200/ 1890 batches | lr 0.02 | ms/batch  6.03 | loss  4.57
INFO:root:| epoch   5 |  1400/ 1890 batches | lr 0.02 | ms/batch  5.84 | loss  4.57
INFO:root:| epoch   5 |  1600/ 1890 batches | lr 0.02 | ms/batch  7.27 | loss  4.57
INFO:root:| epoch   5 |  1800/ 1890 batches | lr 0.02 | ms/batch  6.06 | loss  4.55
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   5 | time: 12.22s | valid loss  4.54 | valid ppl    93.92
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   6 |   200/ 1890 batches | lr 0.02 | ms/batch  5.91 | loss  4.53
INFO:root:| epoch   6 |   400/ 1890 batches | lr 0.02 | ms/batch  6.24 | loss  4.57
INFO:root:| epoch   6 |   600/ 1890 batches | lr 0.02 | ms/batch  7.95 | loss  4.54
INFO:root:| epoch   6 |   800/ 1890 batches | lr 0.02 | ms/batch  5.96 | loss  4.54
INFO:root:| epoch   6 |  1000/ 1890 batches | lr 0.02 | ms/batch  5.80 | loss  4.54
INFO:root:| epoch   6 |  1200/ 1890 batches | lr 0.02 | ms/batch  6.09 | loss  4.52
INFO:root:| epoch   6 |  1400/ 1890 batches | lr 0.02 | ms/batch  7.22 | loss  4.52
INFO:root:| epoch   6 |  1600/ 1890 batches | lr 0.02 | ms/batch  5.77 | loss  4.52
INFO:root:| epoch   6 |  1800/ 1890 batches | lr 0.02 | ms/batch  5.78 | loss  4.50
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   6 | time: 11.98s | valid loss  4.50 | valid ppl    89.91
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   7 |   200/ 1890 batches | lr 0.02 | ms/batch  5.69 | loss  4.49
INFO:root:| epoch   7 |   400/ 1890 batches | lr 0.02 | ms/batch  6.67 | loss  4.52
INFO:root:| epoch   7 |   600/ 1890 batches | lr 0.02 | ms/batch  6.87 | loss  4.49
INFO:root:| epoch   7 |   800/ 1890 batches | lr 0.02 | ms/batch  5.74 | loss  4.49
INFO:root:| epoch   7 |  1000/ 1890 batches | lr 0.02 | ms/batch  5.76 | loss  4.49
INFO:root:| epoch   7 |  1200/ 1890 batches | lr 0.02 | ms/batch  5.71 | loss  4.47
INFO:root:| epoch   7 |  1400/ 1890 batches | lr 0.02 | ms/batch  5.64 | loss  4.46
INFO:root:| epoch   7 |  1600/ 1890 batches | lr 0.02 | ms/batch  5.68 | loss  4.47
INFO:root:| epoch   7 |  1800/ 1890 batches | lr 0.02 | ms/batch  6.37 | loss  4.45
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   7 | time: 11.63s | valid loss  4.44 | valid ppl    84.62
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   8 |   200/ 1890 batches | lr 0.02 | ms/batch  6.45 | loss  4.42
INFO:root:| epoch   8 |   400/ 1890 batches | lr 0.02 | ms/batch  5.85 | loss  4.45
INFO:root:| epoch   8 |   600/ 1890 batches | lr 0.02 | ms/batch  5.79 | loss  4.42
INFO:root:| epoch   8 |   800/ 1890 batches | lr 0.02 | ms/batch  7.16 | loss  4.41
INFO:root:| epoch   8 |  1000/ 1890 batches | lr 0.02 | ms/batch  6.20 | loss  4.41
INFO:root:| epoch   8 |  1200/ 1890 batches | lr 0.02 | ms/batch  5.67 | loss  4.39
INFO:root:| epoch   8 |  1400/ 1890 batches | lr 0.02 | ms/batch  5.66 | loss  4.38
INFO:root:| epoch   8 |  1600/ 1890 batches | lr 0.02 | ms/batch  5.62 | loss  4.38
INFO:root:| epoch   8 |  1800/ 1890 batches | lr 0.02 | ms/batch  6.58 | loss  4.36
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   8 | time: 11.84s | valid loss  4.35 | valid ppl    77.19
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   9 |   200/ 1890 batches | lr 0.02 | ms/batch  5.99 | loss  4.33
INFO:root:| epoch   9 |   400/ 1890 batches | lr 0.02 | ms/batch  5.76 | loss  4.36
INFO:root:| epoch   9 |   600/ 1890 batches | lr 0.02 | ms/batch  5.90 | loss  4.32
INFO:root:| epoch   9 |   800/ 1890 batches | lr 0.02 | ms/batch  7.49 | loss  4.31
INFO:root:| epoch   9 |  1000/ 1890 batches | lr 0.02 | ms/batch  6.49 | loss  4.31
INFO:root:| epoch   9 |  1200/ 1890 batches | lr 0.02 | ms/batch  6.78 | loss  4.28
INFO:root:| epoch   9 |  1400/ 1890 batches | lr 0.02 | ms/batch  7.16 | loss  4.27
INFO:root:| epoch   9 |  1600/ 1890 batches | lr 0.02 | ms/batch  7.32 | loss  4.28
INFO:root:| epoch   9 |  1800/ 1890 batches | lr 0.02 | ms/batch  7.24 | loss  4.24
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   9 | time: 12.72s | valid loss  4.23 | valid ppl    68.89
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  10 |   200/ 1890 batches | lr 0.02 | ms/batch  7.74 | loss  4.21
INFO:root:| epoch  10 |   400/ 1890 batches | lr 0.02 | ms/batch  8.66 | loss  4.24
INFO:root:| epoch  10 |   600/ 1890 batches | lr 0.02 | ms/batch  6.98 | loss  4.20
INFO:root:| epoch  10 |   800/ 1890 batches | lr 0.02 | ms/batch  6.27 | loss  4.19
INFO:root:| epoch  10 |  1000/ 1890 batches | lr 0.02 | ms/batch  8.15 | loss  4.18
INFO:root:| epoch  10 |  1200/ 1890 batches | lr 0.02 | ms/batch  8.15 | loss  4.16
INFO:root:| epoch  10 |  1400/ 1890 batches | lr 0.02 | ms/batch  7.21 | loss  4.14
INFO:root:| epoch  10 |  1600/ 1890 batches | lr 0.02 | ms/batch  7.58 | loss  4.15
INFO:root:| epoch  10 |  1800/ 1890 batches | lr 0.02 | ms/batch  5.96 | loss  4.11
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  10 | time: 13.96s | valid loss  4.10 | valid ppl    60.47
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:=========================================================================================
INFO:root:| End of training | test loss  4.29 | test ppl    73.10
INFO:root:=========================================================================================
INFO:root:----------- new value of n = 1, k = 3 -----------
INFO:root:Loading data
INFO:root:Vocab size 4005
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:| epoch   1 |   200/ 2070 batches | lr 0.02 | ms/batch  7.16 | loss  8.28
INFO:root:| epoch   1 |   400/ 2070 batches | lr 0.02 | ms/batch  8.57 | loss  8.11
INFO:root:| epoch   1 |   600/ 2070 batches | lr 0.02 | ms/batch  6.86 | loss  7.99
INFO:root:| epoch   1 |   800/ 2070 batches | lr 0.02 | ms/batch  6.98 | loss  7.85
INFO:root:| epoch   1 |  1000/ 2070 batches | lr 0.02 | ms/batch  8.84 | loss  7.72
INFO:root:| epoch   1 |  1200/ 2070 batches | lr 0.02 | ms/batch  7.10 | loss  7.59
INFO:root:| epoch   1 |  1400/ 2070 batches | lr 0.02 | ms/batch  6.79 | loss  7.44
INFO:root:| epoch   1 |  1600/ 2070 batches | lr 0.02 | ms/batch  6.85 | loss  7.33
INFO:root:| epoch   1 |  1800/ 2070 batches | lr 0.02 | ms/batch  8.63 | loss  7.17
INFO:root:| epoch   1 |  2000/ 2070 batches | lr 0.02 | ms/batch  6.77 | loss  7.02
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   1 | time: 15.51s | valid loss  6.89 | valid ppl   985.50
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   2 |   200/ 2070 batches | lr 0.02 | ms/batch  6.74 | loss  6.83
INFO:root:| epoch   2 |   400/ 2070 batches | lr 0.02 | ms/batch  8.14 | loss  6.66
INFO:root:| epoch   2 |   600/ 2070 batches | lr 0.02 | ms/batch  6.67 | loss  6.52
INFO:root:| epoch   2 |   800/ 2070 batches | lr 0.02 | ms/batch  6.44 | loss  6.32
INFO:root:| epoch   2 |  1000/ 2070 batches | lr 0.02 | ms/batch  7.04 | loss  6.22
INFO:root:| epoch   2 |  1200/ 2070 batches | lr 0.02 | ms/batch  7.75 | loss  6.10
INFO:root:| epoch   2 |  1400/ 2070 batches | lr 0.02 | ms/batch  6.44 | loss  5.94
INFO:root:| epoch   2 |  1600/ 2070 batches | lr 0.02 | ms/batch  6.55 | loss  5.92
INFO:root:| epoch   2 |  1800/ 2070 batches | lr 0.02 | ms/batch  7.80 | loss  5.79
INFO:root:| epoch   2 |  2000/ 2070 batches | lr 0.02 | ms/batch  6.85 | loss  5.71
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   2 | time: 14.65s | valid loss  5.66 | valid ppl   286.90
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   3 |   200/ 2070 batches | lr 0.02 | ms/batch  6.97 | loss  5.62
INFO:root:| epoch   3 |   400/ 2070 batches | lr 0.02 | ms/batch  7.92 | loss  5.57
INFO:root:| epoch   3 |   600/ 2070 batches | lr 0.02 | ms/batch  6.91 | loss  5.54
INFO:root:| epoch   3 |   800/ 2070 batches | lr 0.02 | ms/batch  6.56 | loss  5.40
INFO:root:| epoch   3 |  1000/ 2070 batches | lr 0.02 | ms/batch  6.68 | loss  5.43
INFO:root:| epoch   3 |  1200/ 2070 batches | lr 0.02 | ms/batch  8.14 | loss  5.39
INFO:root:| epoch   3 |  1400/ 2070 batches | lr 0.02 | ms/batch  7.20 | loss  5.28
INFO:root:| epoch   3 |  1600/ 2070 batches | lr 0.02 | ms/batch  6.61 | loss  5.35
INFO:root:| epoch   3 |  1800/ 2070 batches | lr 0.02 | ms/batch  7.94 | loss  5.26
INFO:root:| epoch   3 |  2000/ 2070 batches | lr 0.02 | ms/batch  6.83 | loss  5.23
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   3 | time: 14.93s | valid loss  5.22 | valid ppl   185.78
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   4 |   200/ 2070 batches | lr 0.02 | ms/batch  6.54 | loss  5.20
INFO:root:| epoch   4 |   400/ 2070 batches | lr 0.02 | ms/batch  8.60 | loss  5.20
INFO:root:| epoch   4 |   600/ 2070 batches | lr 0.02 | ms/batch  7.94 | loss  5.22
INFO:root:| epoch   4 |   800/ 2070 batches | lr 0.02 | ms/batch  7.02 | loss  5.10
INFO:root:| epoch   4 |  1000/ 2070 batches | lr 0.02 | ms/batch  7.99 | loss  5.18
INFO:root:| epoch   4 |  1200/ 2070 batches | lr 0.02 | ms/batch  7.68 | loss  5.17
INFO:root:| epoch   4 |  1400/ 2070 batches | lr 0.02 | ms/batch  6.52 | loss  5.08
INFO:root:| epoch   4 |  1600/ 2070 batches | lr 0.02 | ms/batch  6.43 | loss  5.19
INFO:root:| epoch   4 |  1800/ 2070 batches | lr 0.02 | ms/batch  8.08 | loss  5.11
INFO:root:| epoch   4 |  2000/ 2070 batches | lr 0.02 | ms/batch  6.75 | loss  5.10
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   4 | time: 15.27s | valid loss  5.11 | valid ppl   165.72
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   5 |   200/ 2070 batches | lr 0.02 | ms/batch  6.56 | loss  5.08
INFO:root:| epoch   5 |   400/ 2070 batches | lr 0.02 | ms/batch  9.02 | loss  5.10
INFO:root:| epoch   5 |   600/ 2070 batches | lr 0.02 | ms/batch  6.84 | loss  5.13
INFO:root:| epoch   5 |   800/ 2070 batches | lr 0.02 | ms/batch  6.49 | loss  5.01
INFO:root:| epoch   5 |  1000/ 2070 batches | lr 0.02 | ms/batch  7.13 | loss  5.10
INFO:root:| epoch   5 |  1200/ 2070 batches | lr 0.02 | ms/batch  7.62 | loss  5.10
INFO:root:| epoch   5 |  1400/ 2070 batches | lr 0.02 | ms/batch  6.49 | loss  5.01
INFO:root:| epoch   5 |  1600/ 2070 batches | lr 0.02 | ms/batch  6.48 | loss  5.13
INFO:root:| epoch   5 |  1800/ 2070 batches | lr 0.02 | ms/batch  6.65 | loss  5.05
INFO:root:| epoch   5 |  2000/ 2070 batches | lr 0.02 | ms/batch  8.29 | loss  5.04
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   5 | time: 14.89s | valid loss  5.06 | valid ppl   157.00
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   6 |   200/ 2070 batches | lr 0.02 | ms/batch  6.56 | loss  5.03
INFO:root:| epoch   6 |   400/ 2070 batches | lr 0.02 | ms/batch  6.43 | loss  5.04
INFO:root:| epoch   6 |   600/ 2070 batches | lr 0.02 | ms/batch  6.47 | loss  5.08
INFO:root:| epoch   6 |   800/ 2070 batches | lr 0.02 | ms/batch  6.41 | loss  4.96
INFO:root:| epoch   6 |  1000/ 2070 batches | lr 0.02 | ms/batch  6.42 | loss  5.06
INFO:root:| epoch   6 |  1200/ 2070 batches | lr 0.02 | ms/batch  7.36 | loss  5.05
INFO:root:| epoch   6 |  1400/ 2070 batches | lr 0.02 | ms/batch  8.33 | loss  4.97
INFO:root:| epoch   6 |  1600/ 2070 batches | lr 0.02 | ms/batch  7.09 | loss  5.08
INFO:root:| epoch   6 |  1800/ 2070 batches | lr 0.02 | ms/batch  6.81 | loss  5.00
INFO:root:| epoch   6 |  2000/ 2070 batches | lr 0.02 | ms/batch  8.41 | loss  5.00
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   6 | time: 14.63s | valid loss  5.02 | valid ppl   151.02
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   7 |   200/ 2070 batches | lr 0.02 | ms/batch  6.47 | loss  4.99
INFO:root:| epoch   7 |   400/ 2070 batches | lr 0.02 | ms/batch  6.45 | loss  5.00
INFO:root:| epoch   7 |   600/ 2070 batches | lr 0.02 | ms/batch  7.51 | loss  5.04
INFO:root:| epoch   7 |   800/ 2070 batches | lr 0.02 | ms/batch  7.55 | loss  4.92
INFO:root:| epoch   7 |  1000/ 2070 batches | lr 0.02 | ms/batch  7.04 | loss  5.02
INFO:root:| epoch   7 |  1200/ 2070 batches | lr 0.02 | ms/batch  6.54 | loss  5.01
INFO:root:| epoch   7 |  1400/ 2070 batches | lr 0.02 | ms/batch  6.93 | loss  4.93
INFO:root:| epoch   7 |  1600/ 2070 batches | lr 0.02 | ms/batch  8.06 | loss  5.05
INFO:root:| epoch   7 |  1800/ 2070 batches | lr 0.02 | ms/batch  7.11 | loss  4.97
INFO:root:| epoch   7 |  2000/ 2070 batches | lr 0.02 | ms/batch  6.69 | loss  4.97
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   7 | time: 14.65s | valid loss  4.99 | valid ppl   146.51
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   8 |   200/ 2070 batches | lr 0.02 | ms/batch  7.89 | loss  4.95
INFO:root:| epoch   8 |   400/ 2070 batches | lr 0.02 | ms/batch  7.03 | loss  4.97
INFO:root:| epoch   8 |   600/ 2070 batches | lr 0.02 | ms/batch  6.60 | loss  5.01
INFO:root:| epoch   8 |   800/ 2070 batches | lr 0.02 | ms/batch  6.69 | loss  4.89
INFO:root:| epoch   8 |  1000/ 2070 batches | lr 0.02 | ms/batch  8.06 | loss  4.99
INFO:root:| epoch   8 |  1200/ 2070 batches | lr 0.02 | ms/batch  6.59 | loss  4.98
INFO:root:| epoch   8 |  1400/ 2070 batches | lr 0.02 | ms/batch  6.57 | loss  4.90
INFO:root:| epoch   8 |  1600/ 2070 batches | lr 0.02 | ms/batch  7.61 | loss  5.01
INFO:root:| epoch   8 |  1800/ 2070 batches | lr 0.02 | ms/batch  7.23 | loss  4.94
INFO:root:| epoch   8 |  2000/ 2070 batches | lr 0.02 | ms/batch  6.54 | loss  4.93
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   8 | time: 14.73s | valid loss  4.96 | valid ppl   142.36
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   9 |   200/ 2070 batches | lr 0.02 | ms/batch  6.46 | loss  4.92
INFO:root:| epoch   9 |   400/ 2070 batches | lr 0.02 | ms/batch  8.07 | loss  4.94
INFO:root:| epoch   9 |   600/ 2070 batches | lr 0.02 | ms/batch  6.91 | loss  4.98
INFO:root:| epoch   9 |   800/ 2070 batches | lr 0.02 | ms/batch  6.58 | loss  4.85
INFO:root:| epoch   9 |  1000/ 2070 batches | lr 0.02 | ms/batch  6.97 | loss  4.95
INFO:root:| epoch   9 |  1200/ 2070 batches | lr 0.02 | ms/batch  7.78 | loss  4.95
INFO:root:| epoch   9 |  1400/ 2070 batches | lr 0.02 | ms/batch  6.67 | loss  4.87
INFO:root:| epoch   9 |  1600/ 2070 batches | lr 0.02 | ms/batch  6.54 | loss  4.98
INFO:root:| epoch   9 |  1800/ 2070 batches | lr 0.02 | ms/batch  7.96 | loss  4.91
INFO:root:| epoch   9 |  2000/ 2070 batches | lr 0.02 | ms/batch  6.98 | loss  4.90
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   9 | time: 14.77s | valid loss  4.93 | valid ppl   137.83
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  10 |   200/ 2070 batches | lr 0.02 | ms/batch  6.62 | loss  4.88
INFO:root:| epoch  10 |   400/ 2070 batches | lr 0.02 | ms/batch  7.80 | loss  4.90
INFO:root:| epoch  10 |   600/ 2070 batches | lr 0.02 | ms/batch  7.05 | loss  4.94
INFO:root:| epoch  10 |   800/ 2070 batches | lr 0.02 | ms/batch  6.64 | loss  4.82
INFO:root:| epoch  10 |  1000/ 2070 batches | lr 0.02 | ms/batch  6.64 | loss  4.91
INFO:root:| epoch  10 |  1200/ 2070 batches | lr 0.02 | ms/batch  8.06 | loss  4.91
INFO:root:| epoch  10 |  1400/ 2070 batches | lr 0.02 | ms/batch  6.64 | loss  4.83
INFO:root:| epoch  10 |  1600/ 2070 batches | lr 0.02 | ms/batch  6.56 | loss  4.94
INFO:root:| epoch  10 |  1800/ 2070 batches | lr 0.02 | ms/batch  7.62 | loss  4.86
INFO:root:| epoch  10 |  2000/ 2070 batches | lr 0.02 | ms/batch  7.15 | loss  4.86
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  10 | time: 14.74s | valid loss  4.89 | valid ppl   132.34
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:=========================================================================================
INFO:root:| End of training | test loss  5.10 | test ppl   163.31
INFO:root:=========================================================================================
INFO:root:----------- new value of n = 1, k = 4 -----------
INFO:root:Loading data
INFO:root:Vocab size 5005
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:| epoch   1 |   200/ 2250 batches | lr 0.02 | ms/batch  7.54 | loss  8.51
INFO:root:| epoch   1 |   400/ 2250 batches | lr 0.02 | ms/batch  8.98 | loss  8.34
INFO:root:| epoch   1 |   600/ 2250 batches | lr 0.02 | ms/batch  7.33 | loss  8.22
INFO:root:| epoch   1 |   800/ 2250 batches | lr 0.02 | ms/batch  7.61 | loss  8.10
INFO:root:| epoch   1 |  1000/ 2250 batches | lr 0.02 | ms/batch 10.55 | loss  7.98
INFO:root:| epoch   1 |  1200/ 2250 batches | lr 0.02 | ms/batch  8.21 | loss  7.85
INFO:root:| epoch   1 |  1400/ 2250 batches | lr 0.02 | ms/batch  9.58 | loss  7.72
INFO:root:| epoch   1 |  1600/ 2250 batches | lr 0.02 | ms/batch 12.07 | loss  7.59
INFO:root:| epoch   1 |  1800/ 2250 batches | lr 0.02 | ms/batch  8.75 | loss  7.45
INFO:root:| epoch   1 |  2000/ 2250 batches | lr 0.02 | ms/batch 10.38 | loss  7.31
INFO:root:| epoch   1 |  2200/ 2250 batches | lr 0.02 | ms/batch 10.67 | loss  7.16
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   1 | time: 21.26s | valid loss  7.05 | valid ppl  1155.97
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   2 |   200/ 2250 batches | lr 0.02 | ms/batch 15.21 | loss  7.02
INFO:root:| epoch   2 |   400/ 2250 batches | lr 0.02 | ms/batch  8.51 | loss  6.83
INFO:root:| epoch   2 |   600/ 2250 batches | lr 0.02 | ms/batch  9.76 | loss  6.70
INFO:root:| epoch   2 |   800/ 2250 batches | lr 0.02 | ms/batch  8.21 | loss  6.57
INFO:root:| epoch   2 |  1000/ 2250 batches | lr 0.02 | ms/batch  7.92 | loss  6.46
INFO:root:| epoch   2 |  1200/ 2250 batches | lr 0.02 | ms/batch  7.74 | loss  6.37
INFO:root:| epoch   2 |  1400/ 2250 batches | lr 0.02 | ms/batch  7.87 | loss  6.29
INFO:root:| epoch   2 |  1600/ 2250 batches | lr 0.02 | ms/batch  8.09 | loss  6.22
INFO:root:| epoch   2 |  1800/ 2250 batches | lr 0.02 | ms/batch  9.61 | loss  6.16
INFO:root:| epoch   2 |  2000/ 2250 batches | lr 0.02 | ms/batch  7.97 | loss  6.10
INFO:root:| epoch   2 |  2200/ 2250 batches | lr 0.02 | ms/batch  8.54 | loss  6.04
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   2 | time: 20.61s | valid loss  6.01 | valid ppl   405.56
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   3 |   200/ 2250 batches | lr 0.02 | ms/batch  7.86 | loss  6.01
INFO:root:| epoch   3 |   400/ 2250 batches | lr 0.02 | ms/batch  7.45 | loss  5.92
INFO:root:| epoch   3 |   600/ 2250 batches | lr 0.02 | ms/batch  7.76 | loss  5.88
INFO:root:| epoch   3 |   800/ 2250 batches | lr 0.02 | ms/batch  8.78 | loss  5.83
INFO:root:| epoch   3 |  1000/ 2250 batches | lr 0.02 | ms/batch  7.26 | loss  5.78
INFO:root:| epoch   3 |  1200/ 2250 batches | lr 0.02 | ms/batch  7.12 | loss  5.75
INFO:root:| epoch   3 |  1400/ 2250 batches | lr 0.02 | ms/batch  7.25 | loss  5.71
INFO:root:| epoch   3 |  1600/ 2250 batches | lr 0.02 | ms/batch  7.35 | loss  5.67
INFO:root:| epoch   3 |  1800/ 2250 batches | lr 0.02 | ms/batch  7.30 | loss  5.64
INFO:root:| epoch   3 |  2000/ 2250 batches | lr 0.02 | ms/batch  7.21 | loss  5.62
INFO:root:| epoch   3 |  2200/ 2250 batches | lr 0.02 | ms/batch  9.07 | loss  5.59
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   3 | time: 17.40s | valid loss  5.58 | valid ppl   265.98
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   4 |   200/ 2250 batches | lr 0.02 | ms/batch  7.32 | loss  5.60
INFO:root:| epoch   4 |   400/ 2250 batches | lr 0.02 | ms/batch  8.22 | loss  5.55
INFO:root:| epoch   4 |   600/ 2250 batches | lr 0.02 | ms/batch  8.65 | loss  5.54
INFO:root:| epoch   4 |   800/ 2250 batches | lr 0.02 | ms/batch  7.27 | loss  5.53
INFO:root:| epoch   4 |  1000/ 2250 batches | lr 0.02 | ms/batch  7.71 | loss  5.51
INFO:root:| epoch   4 |  1200/ 2250 batches | lr 0.02 | ms/batch  8.80 | loss  5.51
INFO:root:| epoch   4 |  1400/ 2250 batches | lr 0.02 | ms/batch  7.84 | loss  5.50
INFO:root:| epoch   4 |  1600/ 2250 batches | lr 0.02 | ms/batch  7.54 | loss  5.49
INFO:root:| epoch   4 |  1800/ 2250 batches | lr 0.02 | ms/batch 10.21 | loss  5.48
INFO:root:| epoch   4 |  2000/ 2250 batches | lr 0.02 | ms/batch  7.28 | loss  5.47
INFO:root:| epoch   4 |  2200/ 2250 batches | lr 0.02 | ms/batch  7.47 | loss  5.46
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   4 | time: 18.37s | valid loss  5.47 | valid ppl   236.84
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   5 |   200/ 2250 batches | lr 0.02 | ms/batch  8.32 | loss  5.48
INFO:root:| epoch   5 |   400/ 2250 batches | lr 0.02 | ms/batch  7.30 | loss  5.44
INFO:root:| epoch   5 |   600/ 2250 batches | lr 0.02 | ms/batch  8.00 | loss  5.44
INFO:root:| epoch   5 |   800/ 2250 batches | lr 0.02 | ms/batch  8.60 | loss  5.44
INFO:root:| epoch   5 |  1000/ 2250 batches | lr 0.02 | ms/batch  7.31 | loss  5.43
INFO:root:| epoch   5 |  1200/ 2250 batches | lr 0.02 | ms/batch  7.31 | loss  5.43
INFO:root:| epoch   5 |  1400/ 2250 batches | lr 0.02 | ms/batch  9.14 | loss  5.42
INFO:root:| epoch   5 |  1600/ 2250 batches | lr 0.02 | ms/batch  7.32 | loss  5.41
INFO:root:| epoch   5 |  1800/ 2250 batches | lr 0.02 | ms/batch  7.24 | loss  5.41
INFO:root:| epoch   5 |  2000/ 2250 batches | lr 0.02 | ms/batch  8.88 | loss  5.40
INFO:root:| epoch   5 |  2200/ 2250 batches | lr 0.02 | ms/batch  7.63 | loss  5.39
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   5 | time: 17.92s | valid loss  5.40 | valid ppl   221.79
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   6 |   200/ 2250 batches | lr 0.02 | ms/batch  7.34 | loss  5.41
INFO:root:| epoch   6 |   400/ 2250 batches | lr 0.02 | ms/batch  9.13 | loss  5.37
INFO:root:| epoch   6 |   600/ 2250 batches | lr 0.02 | ms/batch  7.35 | loss  5.37
INFO:root:| epoch   6 |   800/ 2250 batches | lr 0.02 | ms/batch  7.37 | loss  5.37
INFO:root:| epoch   6 |  1000/ 2250 batches | lr 0.02 | ms/batch  9.21 | loss  5.36
INFO:root:| epoch   6 |  1200/ 2250 batches | lr 0.02 | ms/batch  7.40 | loss  5.36
INFO:root:| epoch   6 |  1400/ 2250 batches | lr 0.02 | ms/batch  7.26 | loss  5.36
INFO:root:| epoch   6 |  1600/ 2250 batches | lr 0.02 | ms/batch  8.01 | loss  5.35
INFO:root:| epoch   6 |  1800/ 2250 batches | lr 0.02 | ms/batch  8.49 | loss  5.35
INFO:root:| epoch   6 |  2000/ 2250 batches | lr 0.02 | ms/batch  7.25 | loss  5.34
INFO:root:| epoch   6 |  2200/ 2250 batches | lr 0.02 | ms/batch  7.82 | loss  5.33
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   6 | time: 18.02s | valid loss  5.35 | valid ppl   210.10
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   7 |   200/ 2250 batches | lr 0.02 | ms/batch  7.88 | loss  5.36
INFO:root:| epoch   7 |   400/ 2250 batches | lr 0.02 | ms/batch  7.26 | loss  5.32
INFO:root:| epoch   7 |   600/ 2250 batches | lr 0.02 | ms/batch  8.44 | loss  5.32
INFO:root:| epoch   7 |   800/ 2250 batches | lr 0.02 | ms/batch  8.04 | loss  5.32
INFO:root:| epoch   7 |  1000/ 2250 batches | lr 0.02 | ms/batch  7.24 | loss  5.31
INFO:root:| epoch   7 |  1200/ 2250 batches | lr 0.02 | ms/batch  7.96 | loss  5.31
INFO:root:| epoch   7 |  1400/ 2250 batches | lr 0.02 | ms/batch  8.51 | loss  5.30
INFO:root:| epoch   7 |  1600/ 2250 batches | lr 0.02 | ms/batch  7.41 | loss  5.30
INFO:root:| epoch   7 |  1800/ 2250 batches | lr 0.02 | ms/batch  7.35 | loss  5.29
INFO:root:| epoch   7 |  2000/ 2250 batches | lr 0.02 | ms/batch  8.49 | loss  5.28
INFO:root:| epoch   7 |  2200/ 2250 batches | lr 0.02 | ms/batch  8.86 | loss  5.27
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   7 | time: 18.01s | valid loss  5.30 | valid ppl   199.50
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   8 |   200/ 2250 batches | lr 0.02 | ms/batch  7.52 | loss  5.30
INFO:root:| epoch   8 |   400/ 2250 batches | lr 0.02 | ms/batch  7.31 | loss  5.26
INFO:root:| epoch   8 |   600/ 2250 batches | lr 0.02 | ms/batch  7.33 | loss  5.26
INFO:root:| epoch   8 |   800/ 2250 batches | lr 0.02 | ms/batch  7.67 | loss  5.26
INFO:root:| epoch   8 |  1000/ 2250 batches | lr 0.02 | ms/batch  8.80 | loss  5.25
INFO:root:| epoch   8 |  1200/ 2250 batches | lr 0.02 | ms/batch  7.87 | loss  5.25
INFO:root:| epoch   8 |  1400/ 2250 batches | lr 0.02 | ms/batch  8.37 | loss  5.24
INFO:root:| epoch   8 |  1600/ 2250 batches | lr 0.02 | ms/batch  8.92 | loss  5.24
INFO:root:| epoch   8 |  1800/ 2250 batches | lr 0.02 | ms/batch  7.62 | loss  5.23
INFO:root:| epoch   8 |  2000/ 2250 batches | lr 0.02 | ms/batch  7.56 | loss  5.22
INFO:root:| epoch   8 |  2200/ 2250 batches | lr 0.02 | ms/batch  8.88 | loss  5.21
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   8 | time: 18.08s | valid loss  5.24 | valid ppl   187.81
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   9 |   200/ 2250 batches | lr 0.02 | ms/batch  7.43 | loss  5.23
INFO:root:| epoch   9 |   400/ 2250 batches | lr 0.02 | ms/batch  8.27 | loss  5.19
INFO:root:| epoch   9 |   600/ 2250 batches | lr 0.02 | ms/batch  8.39 | loss  5.19
INFO:root:| epoch   9 |   800/ 2250 batches | lr 0.02 | ms/batch  7.28 | loss  5.19
INFO:root:| epoch   9 |  1000/ 2250 batches | lr 0.02 | ms/batch  7.97 | loss  5.18
INFO:root:| epoch   9 |  1200/ 2250 batches | lr 0.02 | ms/batch  9.14 | loss  5.18
INFO:root:| epoch   9 |  1400/ 2250 batches | lr 0.02 | ms/batch  7.70 | loss  5.17
INFO:root:| epoch   9 |  1600/ 2250 batches | lr 0.02 | ms/batch  9.31 | loss  5.16
INFO:root:| epoch   9 |  1800/ 2250 batches | lr 0.02 | ms/batch  7.34 | loss  5.15
INFO:root:| epoch   9 |  2000/ 2250 batches | lr 0.02 | ms/batch  7.30 | loss  5.14
INFO:root:| epoch   9 |  2200/ 2250 batches | lr 0.02 | ms/batch  9.09 | loss  5.13
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   9 | time: 18.35s | valid loss  5.16 | valid ppl   173.67
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  10 |   200/ 2250 batches | lr 0.02 | ms/batch  7.40 | loss  5.15
INFO:root:| epoch  10 |   400/ 2250 batches | lr 0.02 | ms/batch  7.66 | loss  5.11
INFO:root:| epoch  10 |   600/ 2250 batches | lr 0.02 | ms/batch  8.97 | loss  5.10
INFO:root:| epoch  10 |   800/ 2250 batches | lr 0.02 | ms/batch  7.46 | loss  5.10
INFO:root:| epoch  10 |  1000/ 2250 batches | lr 0.02 | ms/batch  8.78 | loss  5.09
INFO:root:| epoch  10 |  1200/ 2250 batches | lr 0.02 | ms/batch  8.16 | loss  5.09
INFO:root:| epoch  10 |  1400/ 2250 batches | lr 0.02 | ms/batch  8.72 | loss  5.07
INFO:root:| epoch  10 |  1600/ 2250 batches | lr 0.02 | ms/batch  8.09 | loss  5.07
INFO:root:| epoch  10 |  1800/ 2250 batches | lr 0.02 | ms/batch  9.30 | loss  5.05
INFO:root:| epoch  10 |  2000/ 2250 batches | lr 0.02 | ms/batch  8.46 | loss  5.04
INFO:root:| epoch  10 |  2200/ 2250 batches | lr 0.02 | ms/batch  7.91 | loss  5.02
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  10 | time: 18.81s | valid loss  5.05 | valid ppl   156.70
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:=========================================================================================
INFO:root:| End of training | test loss  5.25 | test ppl   191.28
INFO:root:=========================================================================================
INFO:root:----------- new value of n = 2, k = 1 -----------
INFO:root:Loading data
INFO:root:Vocab size 2005
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:| epoch   1 |   200/ 1710 batches | lr 0.02 | ms/batch  7.26 | loss  7.54
INFO:root:| epoch   1 |   400/ 1710 batches | lr 0.02 | ms/batch  7.01 | loss  7.29
INFO:root:| epoch   1 |   600/ 1710 batches | lr 0.02 | ms/batch  6.32 | loss  7.07
INFO:root:| epoch   1 |   800/ 1710 batches | lr 0.02 | ms/batch  8.17 | loss  6.84
INFO:root:| epoch   1 |  1000/ 1710 batches | lr 0.02 | ms/batch  6.62 | loss  6.57
INFO:root:| epoch   1 |  1200/ 1710 batches | lr 0.02 | ms/batch  6.50 | loss  6.30
INFO:root:| epoch   1 |  1400/ 1710 batches | lr 0.02 | ms/batch  6.92 | loss  5.99
INFO:root:| epoch   1 |  1600/ 1710 batches | lr 0.02 | ms/batch  7.21 | loss  5.67
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   1 | time: 11.97s | valid loss  5.38 | valid ppl   218.08
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   2 |   200/ 1710 batches | lr 0.02 | ms/batch  6.13 | loss  5.26
INFO:root:| epoch   2 |   400/ 1710 batches | lr 0.02 | ms/batch  6.44 | loss  5.02
INFO:root:| epoch   2 |   600/ 1710 batches | lr 0.02 | ms/batch  7.62 | loss  4.86
INFO:root:| epoch   2 |   800/ 1710 batches | lr 0.02 | ms/batch  6.15 | loss  4.76
INFO:root:| epoch   2 |  1000/ 1710 batches | lr 0.02 | ms/batch  6.03 | loss  4.62
INFO:root:| epoch   2 |  1200/ 1710 batches | lr 0.02 | ms/batch  6.92 | loss  4.56
INFO:root:| epoch   2 |  1400/ 1710 batches | lr 0.02 | ms/batch  7.01 | loss  4.45
INFO:root:| epoch   2 |  1600/ 1710 batches | lr 0.02 | ms/batch  5.93 | loss  4.36
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   2 | time: 11.22s | valid loss  4.33 | valid ppl    75.82
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   3 |   200/ 1710 batches | lr 0.02 | ms/batch  6.11 | loss  4.28
INFO:root:| epoch   3 |   400/ 1710 batches | lr 0.02 | ms/batch  5.92 | loss  4.19
INFO:root:| epoch   3 |   600/ 1710 batches | lr 0.02 | ms/batch  7.73 | loss  4.15
INFO:root:| epoch   3 |   800/ 1710 batches | lr 0.02 | ms/batch  6.30 | loss  4.14
INFO:root:| epoch   3 |  1000/ 1710 batches | lr 0.02 | ms/batch  5.98 | loss  4.08
INFO:root:| epoch   3 |  1200/ 1710 batches | lr 0.02 | ms/batch  6.17 | loss  4.10
INFO:root:| epoch   3 |  1400/ 1710 batches | lr 0.02 | ms/batch  7.79 | loss  4.07
INFO:root:| epoch   3 |  1600/ 1710 batches | lr 0.02 | ms/batch  6.08 | loss  4.06
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   3 | time: 11.19s | valid loss  4.09 | valid ppl    59.84
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   4 |   200/ 1710 batches | lr 0.02 | ms/batch  6.14 | loss  4.07
INFO:root:| epoch   4 |   400/ 1710 batches | lr 0.02 | ms/batch  8.03 | loss  4.03
INFO:root:| epoch   4 |   600/ 1710 batches | lr 0.02 | ms/batch  6.07 | loss  4.02
INFO:root:| epoch   4 |   800/ 1710 batches | lr 0.02 | ms/batch  5.99 | loss  4.03
INFO:root:| epoch   4 |  1000/ 1710 batches | lr 0.02 | ms/batch  6.44 | loss  3.98
INFO:root:| epoch   4 |  1200/ 1710 batches | lr 0.02 | ms/batch  8.51 | loss  4.03
INFO:root:| epoch   4 |  1400/ 1710 batches | lr 0.02 | ms/batch  6.09 | loss  4.01
INFO:root:| epoch   4 |  1600/ 1710 batches | lr 0.02 | ms/batch  6.00 | loss  4.01
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   4 | time: 11.44s | valid loss  4.04 | valid ppl    56.98
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   5 |   200/ 1710 batches | lr 0.02 | ms/batch  8.02 | loss  4.02
INFO:root:| epoch   5 |   400/ 1710 batches | lr 0.02 | ms/batch  6.04 | loss  3.98
INFO:root:| epoch   5 |   600/ 1710 batches | lr 0.02 | ms/batch  6.03 | loss  3.98
INFO:root:| epoch   5 |   800/ 1710 batches | lr 0.02 | ms/batch  6.62 | loss  4.00
INFO:root:| epoch   5 |  1000/ 1710 batches | lr 0.02 | ms/batch  7.50 | loss  3.95
INFO:root:| epoch   5 |  1200/ 1710 batches | lr 0.02 | ms/batch  5.88 | loss  4.00
INFO:root:| epoch   5 |  1400/ 1710 batches | lr 0.02 | ms/batch  5.82 | loss  3.98
INFO:root:| epoch   5 |  1600/ 1710 batches | lr 0.02 | ms/batch  6.80 | loss  3.98
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   5 | time: 11.58s | valid loss  4.02 | valid ppl    55.70
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   6 |   200/ 1710 batches | lr 0.02 | ms/batch  6.57 | loss  4.00
INFO:root:| epoch   6 |   400/ 1710 batches | lr 0.02 | ms/batch  6.05 | loss  3.96
INFO:root:| epoch   6 |   600/ 1710 batches | lr 0.02 | ms/batch  6.81 | loss  3.96
INFO:root:| epoch   6 |   800/ 1710 batches | lr 0.02 | ms/batch  7.85 | loss  3.97
INFO:root:| epoch   6 |  1000/ 1710 batches | lr 0.02 | ms/batch  6.08 | loss  3.93
INFO:root:| epoch   6 |  1200/ 1710 batches | lr 0.02 | ms/batch  5.96 | loss  3.98
INFO:root:| epoch   6 |  1400/ 1710 batches | lr 0.02 | ms/batch  6.21 | loss  3.95
INFO:root:| epoch   6 |  1600/ 1710 batches | lr 0.02 | ms/batch  6.81 | loss  3.96
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   6 | time: 11.25s | valid loss  4.00 | valid ppl    54.53
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   7 |   200/ 1710 batches | lr 0.02 | ms/batch  6.09 | loss  3.97
INFO:root:| epoch   7 |   400/ 1710 batches | lr 0.02 | ms/batch  6.00 | loss  3.93
INFO:root:| epoch   7 |   600/ 1710 batches | lr 0.02 | ms/batch  6.05 | loss  3.93
INFO:root:| epoch   7 |   800/ 1710 batches | lr 0.02 | ms/batch  5.91 | loss  3.94
INFO:root:| epoch   7 |  1000/ 1710 batches | lr 0.02 | ms/batch  5.82 | loss  3.90
INFO:root:| epoch   7 |  1200/ 1710 batches | lr 0.02 | ms/batch  6.52 | loss  3.95
INFO:root:| epoch   7 |  1400/ 1710 batches | lr 0.02 | ms/batch  8.19 | loss  3.92
INFO:root:| epoch   7 |  1600/ 1710 batches | lr 0.02 | ms/batch  6.23 | loss  3.92
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   7 | time: 10.94s | valid loss  3.96 | valid ppl    52.66
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   8 |   200/ 1710 batches | lr 0.02 | ms/batch  6.74 | loss  3.94
INFO:root:| epoch   8 |   400/ 1710 batches | lr 0.02 | ms/batch  7.53 | loss  3.89
INFO:root:| epoch   8 |   600/ 1710 batches | lr 0.02 | ms/batch  5.95 | loss  3.88
INFO:root:| epoch   8 |   800/ 1710 batches | lr 0.02 | ms/batch  5.85 | loss  3.89
INFO:root:| epoch   8 |  1000/ 1710 batches | lr 0.02 | ms/batch  5.86 | loss  3.84
INFO:root:| epoch   8 |  1200/ 1710 batches | lr 0.02 | ms/batch  6.03 | loss  3.89
INFO:root:| epoch   8 |  1400/ 1710 batches | lr 0.02 | ms/batch  6.02 | loss  3.85
INFO:root:| epoch   8 |  1600/ 1710 batches | lr 0.02 | ms/batch  6.14 | loss  3.85
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   8 | time: 10.80s | valid loss  3.89 | valid ppl    49.10
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   9 |   200/ 1710 batches | lr 0.02 | ms/batch  6.09 | loss  3.86
INFO:root:| epoch   9 |   400/ 1710 batches | lr 0.02 | ms/batch  5.98 | loss  3.81
INFO:root:| epoch   9 |   600/ 1710 batches | lr 0.02 | ms/batch  5.93 | loss  3.79
INFO:root:| epoch   9 |   800/ 1710 batches | lr 0.02 | ms/batch  5.88 | loss  3.80
INFO:root:| epoch   9 |  1000/ 1710 batches | lr 0.02 | ms/batch  7.77 | loss  3.74
INFO:root:| epoch   9 |  1200/ 1710 batches | lr 0.02 | ms/batch  6.48 | loss  3.78
INFO:root:| epoch   9 |  1400/ 1710 batches | lr 0.02 | ms/batch  6.03 | loss  3.74
INFO:root:| epoch   9 |  1600/ 1710 batches | lr 0.02 | ms/batch  6.14 | loss  3.74
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   9 | time: 11.13s | valid loss  3.78 | valid ppl    43.64
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  10 |   200/ 1710 batches | lr 0.02 | ms/batch  6.86 | loss  3.74
INFO:root:| epoch  10 |   400/ 1710 batches | lr 0.02 | ms/batch  5.99 | loss  3.69
INFO:root:| epoch  10 |   600/ 1710 batches | lr 0.02 | ms/batch  6.04 | loss  3.67
INFO:root:| epoch  10 |   800/ 1710 batches | lr 0.02 | ms/batch  6.09 | loss  3.68
INFO:root:| epoch  10 |  1000/ 1710 batches | lr 0.02 | ms/batch  6.01 | loss  3.62
INFO:root:| epoch  10 |  1200/ 1710 batches | lr 0.02 | ms/batch  5.91 | loss  3.66
INFO:root:| epoch  10 |  1400/ 1710 batches | lr 0.02 | ms/batch  5.87 | loss  3.62
INFO:root:| epoch  10 |  1600/ 1710 batches | lr 0.02 | ms/batch  5.85 | loss  3.62
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  10 | time: 10.55s | valid loss  3.66 | valid ppl    39.02
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:=========================================================================================
INFO:root:| End of training | test loss  3.77 | test ppl    43.29
INFO:root:=========================================================================================
INFO:root:----------- new value of n = 2, k = 2 -----------
INFO:root:Loading data
INFO:root:Vocab size 3005
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:| epoch   1 |   200/ 1890 batches | lr 0.02 | ms/batch  7.96 | loss  7.96
INFO:root:| epoch   1 |   400/ 1890 batches | lr 0.02 | ms/batch  7.08 | loss  7.74
INFO:root:| epoch   1 |   600/ 1890 batches | lr 0.02 | ms/batch  9.88 | loss  7.56
INFO:root:| epoch   1 |   800/ 1890 batches | lr 0.02 | ms/batch 12.14 | loss  7.37
INFO:root:| epoch   1 |  1000/ 1890 batches | lr 0.02 | ms/batch 14.33 | loss  7.15
INFO:root:| epoch   1 |  1200/ 1890 batches | lr 0.02 | ms/batch  9.74 | loss  6.91
INFO:root:| epoch   1 |  1400/ 1890 batches | lr 0.02 | ms/batch 11.01 | loss  6.66
INFO:root:| epoch   1 |  1600/ 1890 batches | lr 0.02 | ms/batch 15.38 | loss  6.38
INFO:root:| epoch   1 |  1800/ 1890 batches | lr 0.02 | ms/batch  9.98 | loss  6.11
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   1 | time: 20.44s | valid loss  5.83 | valid ppl   341.78
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   2 |   200/ 1890 batches | lr 0.02 | ms/batch  8.08 | loss  5.78
INFO:root:| epoch   2 |   400/ 1890 batches | lr 0.02 | ms/batch  7.23 | loss  5.57
INFO:root:| epoch   2 |   600/ 1890 batches | lr 0.02 | ms/batch  9.84 | loss  5.45
INFO:root:| epoch   2 |   800/ 1890 batches | lr 0.02 | ms/batch  8.57 | loss  5.36
INFO:root:| epoch   2 |  1000/ 1890 batches | lr 0.02 | ms/batch 10.73 | loss  5.24
INFO:root:| epoch   2 |  1200/ 1890 batches | lr 0.02 | ms/batch  9.90 | loss  5.13
INFO:root:| epoch   2 |  1400/ 1890 batches | lr 0.02 | ms/batch 10.54 | loss  5.05
INFO:root:| epoch   2 |  1600/ 1890 batches | lr 0.02 | ms/batch 20.68 | loss  4.98
INFO:root:| epoch   2 |  1800/ 1890 batches | lr 0.02 | ms/batch 19.47 | loss  4.90
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   2 | time: 22.75s | valid loss  4.81 | valid ppl   123.13
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   3 |   200/ 1890 batches | lr 0.02 | ms/batch 11.46 | loss  4.82
INFO:root:| epoch   3 |   400/ 1890 batches | lr 0.02 | ms/batch  8.96 | loss  4.75
INFO:root:| epoch   3 |   600/ 1890 batches | lr 0.02 | ms/batch 13.82 | loss  4.73
INFO:root:| epoch   3 |   800/ 1890 batches | lr 0.02 | ms/batch 11.01 | loss  4.73
INFO:root:| epoch   3 |  1000/ 1890 batches | lr 0.02 | ms/batch  9.32 | loss  4.68
INFO:root:| epoch   3 |  1200/ 1890 batches | lr 0.02 | ms/batch 14.19 | loss  4.65
INFO:root:| epoch   3 |  1400/ 1890 batches | lr 0.02 | ms/batch  7.40 | loss  4.63
INFO:root:| epoch   3 |  1600/ 1890 batches | lr 0.02 | ms/batch  8.35 | loss  4.65
INFO:root:| epoch   3 |  1800/ 1890 batches | lr 0.02 | ms/batch  7.99 | loss  4.63
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   3 | time: 19.45s | valid loss  4.60 | valid ppl    99.61
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   4 |   200/ 1890 batches | lr 0.02 | ms/batch  8.64 | loss  4.63
INFO:root:| epoch   4 |   400/ 1890 batches | lr 0.02 | ms/batch 11.09 | loss  4.59
INFO:root:| epoch   4 |   600/ 1890 batches | lr 0.02 | ms/batch  9.47 | loss  4.60
INFO:root:| epoch   4 |   800/ 1890 batches | lr 0.02 | ms/batch 10.11 | loss  4.63
INFO:root:| epoch   4 |  1000/ 1890 batches | lr 0.02 | ms/batch  9.48 | loss  4.59
INFO:root:| epoch   4 |  1200/ 1890 batches | lr 0.02 | ms/batch 13.87 | loss  4.57
INFO:root:| epoch   4 |  1400/ 1890 batches | lr 0.02 | ms/batch  9.85 | loss  4.56
INFO:root:| epoch   4 |  1600/ 1890 batches | lr 0.02 | ms/batch  7.05 | loss  4.58
INFO:root:| epoch   4 |  1800/ 1890 batches | lr 0.02 | ms/batch  7.54 | loss  4.56
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   4 | time: 18.22s | valid loss  4.55 | valid ppl    94.53
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   5 |   200/ 1890 batches | lr 0.02 | ms/batch  7.10 | loss  4.57
INFO:root:| epoch   5 |   400/ 1890 batches | lr 0.02 | ms/batch  7.48 | loss  4.54
INFO:root:| epoch   5 |   600/ 1890 batches | lr 0.02 | ms/batch  6.98 | loss  4.55
INFO:root:| epoch   5 |   800/ 1890 batches | lr 0.02 | ms/batch  9.23 | loss  4.58
INFO:root:| epoch   5 |  1000/ 1890 batches | lr 0.02 | ms/batch  7.41 | loss  4.54
INFO:root:| epoch   5 |  1200/ 1890 batches | lr 0.02 | ms/batch  7.63 | loss  4.54
INFO:root:| epoch   5 |  1400/ 1890 batches | lr 0.02 | ms/batch 16.20 | loss  4.52
INFO:root:| epoch   5 |  1600/ 1890 batches | lr 0.02 | ms/batch 10.05 | loss  4.55
INFO:root:| epoch   5 |  1800/ 1890 batches | lr 0.02 | ms/batch  7.52 | loss  4.53
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   5 | time: 16.69s | valid loss  4.52 | valid ppl    92.13
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   6 |   200/ 1890 batches | lr 0.02 | ms/batch  7.20 | loss  4.54
INFO:root:| epoch   6 |   400/ 1890 batches | lr 0.02 | ms/batch  6.83 | loss  4.51
INFO:root:| epoch   6 |   600/ 1890 batches | lr 0.02 | ms/batch  6.83 | loss  4.52
INFO:root:| epoch   6 |   800/ 1890 batches | lr 0.02 | ms/batch  6.71 | loss  4.56
INFO:root:| epoch   6 |  1000/ 1890 batches | lr 0.02 | ms/batch  6.83 | loss  4.52
INFO:root:| epoch   6 |  1200/ 1890 batches | lr 0.02 | ms/batch  7.17 | loss  4.51
INFO:root:| epoch   6 |  1400/ 1890 batches | lr 0.02 | ms/batch  8.61 | loss  4.49
INFO:root:| epoch   6 |  1600/ 1890 batches | lr 0.02 | ms/batch  6.74 | loss  4.53
INFO:root:| epoch   6 |  1800/ 1890 batches | lr 0.02 | ms/batch  6.78 | loss  4.50
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   6 | time: 13.68s | valid loss  4.50 | valid ppl    90.23
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   7 |   200/ 1890 batches | lr 0.02 | ms/batch  8.14 | loss  4.52
INFO:root:| epoch   7 |   400/ 1890 batches | lr 0.02 | ms/batch  6.94 | loss  4.49
INFO:root:| epoch   7 |   600/ 1890 batches | lr 0.02 | ms/batch  6.79 | loss  4.49
INFO:root:| epoch   7 |   800/ 1890 batches | lr 0.02 | ms/batch  6.68 | loss  4.53
INFO:root:| epoch   7 |  1000/ 1890 batches | lr 0.02 | ms/batch  6.72 | loss  4.49
INFO:root:| epoch   7 |  1200/ 1890 batches | lr 0.02 | ms/batch  6.73 | loss  4.48
INFO:root:| epoch   7 |  1400/ 1890 batches | lr 0.02 | ms/batch  6.70 | loss  4.47
INFO:root:| epoch   7 |  1600/ 1890 batches | lr 0.02 | ms/batch  6.65 | loss  4.50
INFO:root:| epoch   7 |  1800/ 1890 batches | lr 0.02 | ms/batch  6.71 | loss  4.47
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   7 | time: 13.16s | valid loss  4.48 | valid ppl    88.03
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   8 |   200/ 1890 batches | lr 0.02 | ms/batch  6.96 | loss  4.49
INFO:root:| epoch   8 |   400/ 1890 batches | lr 0.02 | ms/batch  8.46 | loss  4.46
INFO:root:| epoch   8 |   600/ 1890 batches | lr 0.02 | ms/batch  7.63 | loss  4.46
INFO:root:| epoch   8 |   800/ 1890 batches | lr 0.02 | ms/batch  7.45 | loss  4.50
INFO:root:| epoch   8 |  1000/ 1890 batches | lr 0.02 | ms/batch  8.09 | loss  4.46
INFO:root:| epoch   8 |  1200/ 1890 batches | lr 0.02 | ms/batch  7.88 | loss  4.45
INFO:root:| epoch   8 |  1400/ 1890 batches | lr 0.02 | ms/batch  6.93 | loss  4.43
INFO:root:| epoch   8 |  1600/ 1890 batches | lr 0.02 | ms/batch  7.32 | loss  4.46
INFO:root:| epoch   8 |  1800/ 1890 batches | lr 0.02 | ms/batch  8.75 | loss  4.44
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   8 | time: 14.65s | valid loss  4.44 | valid ppl    85.11
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   9 |   200/ 1890 batches | lr 0.02 | ms/batch  7.01 | loss  4.45
INFO:root:| epoch   9 |   400/ 1890 batches | lr 0.02 | ms/batch  6.78 | loss  4.42
INFO:root:| epoch   9 |   600/ 1890 batches | lr 0.02 | ms/batch  6.71 | loss  4.42
INFO:root:| epoch   9 |   800/ 1890 batches | lr 0.02 | ms/batch  6.74 | loss  4.45
INFO:root:| epoch   9 |  1000/ 1890 batches | lr 0.02 | ms/batch  6.71 | loss  4.41
INFO:root:| epoch   9 |  1200/ 1890 batches | lr 0.02 | ms/batch  8.46 | loss  4.41
INFO:root:| epoch   9 |  1400/ 1890 batches | lr 0.02 | ms/batch  7.52 | loss  4.39
INFO:root:| epoch   9 |  1600/ 1890 batches | lr 0.02 | ms/batch  6.94 | loss  4.41
INFO:root:| epoch   9 |  1800/ 1890 batches | lr 0.02 | ms/batch  7.79 | loss  4.38
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   9 | time: 13.90s | valid loss  4.40 | valid ppl    81.08
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  10 |   200/ 1890 batches | lr 0.02 | ms/batch  6.98 | loss  4.39
INFO:root:| epoch  10 |   400/ 1890 batches | lr 0.02 | ms/batch  6.95 | loss  4.36
INFO:root:| epoch  10 |   600/ 1890 batches | lr 0.02 | ms/batch  8.44 | loss  4.36
INFO:root:| epoch  10 |   800/ 1890 batches | lr 0.02 | ms/batch  7.33 | loss  4.39
INFO:root:| epoch  10 |  1000/ 1890 batches | lr 0.02 | ms/batch  6.83 | loss  4.35
INFO:root:| epoch  10 |  1200/ 1890 batches | lr 0.02 | ms/batch  6.78 | loss  4.34
INFO:root:| epoch  10 |  1400/ 1890 batches | lr 0.02 | ms/batch  6.79 | loss  4.32
INFO:root:| epoch  10 |  1600/ 1890 batches | lr 0.02 | ms/batch  6.80 | loss  4.35
INFO:root:| epoch  10 |  1800/ 1890 batches | lr 0.02 | ms/batch  6.74 | loss  4.32
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  10 | time: 13.49s | valid loss  4.33 | valid ppl    76.05
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:=========================================================================================
INFO:root:| End of training | test loss  4.50 | test ppl    90.38
INFO:root:=========================================================================================
INFO:root:----------- new value of n = 2, k = 3 -----------
INFO:root:Loading data
INFO:root:Vocab size 4005
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:| epoch   1 |   200/ 2070 batches | lr 0.02 | ms/batch  9.84 | loss  8.28
INFO:root:| epoch   1 |   400/ 2070 batches | lr 0.02 | ms/batch  8.17 | loss  8.10
INFO:root:| epoch   1 |   600/ 2070 batches | lr 0.02 | ms/batch  9.19 | loss  7.97
INFO:root:| epoch   1 |   800/ 2070 batches | lr 0.02 | ms/batch  8.69 | loss  7.81
INFO:root:| epoch   1 |  1000/ 2070 batches | lr 0.02 | ms/batch  8.05 | loss  7.67
INFO:root:| epoch   1 |  1200/ 2070 batches | lr 0.02 | ms/batch  9.56 | loss  7.50
INFO:root:| epoch   1 |  1400/ 2070 batches | lr 0.02 | ms/batch  8.60 | loss  7.31
INFO:root:| epoch   1 |  1600/ 2070 batches | lr 0.02 | ms/batch  8.08 | loss  7.14
INFO:root:| epoch   1 |  1800/ 2070 batches | lr 0.02 | ms/batch  7.96 | loss  6.89
INFO:root:| epoch   1 |  2000/ 2070 batches | lr 0.02 | ms/batch  7.94 | loss  6.69
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   1 | time: 17.95s | valid loss  6.50 | valid ppl   666.72
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   2 |   200/ 2070 batches | lr 0.02 | ms/batch  7.91 | loss  6.38
INFO:root:| epoch   2 |   400/ 2070 batches | lr 0.02 | ms/batch  9.85 | loss  6.15
INFO:root:| epoch   2 |   600/ 2070 batches | lr 0.02 | ms/batch  8.89 | loss  6.02
INFO:root:| epoch   2 |   800/ 2070 batches | lr 0.02 | ms/batch  8.35 | loss  5.76
INFO:root:| epoch   2 |  1000/ 2070 batches | lr 0.02 | ms/batch  9.53 | loss  5.76
INFO:root:| epoch   2 |  1200/ 2070 batches | lr 0.02 | ms/batch  7.89 | loss  5.62
INFO:root:| epoch   2 |  1400/ 2070 batches | lr 0.02 | ms/batch  7.95 | loss  5.50
INFO:root:| epoch   2 |  1600/ 2070 batches | lr 0.02 | ms/batch  7.76 | loss  5.50
INFO:root:| epoch   2 |  1800/ 2070 batches | lr 0.02 | ms/batch  7.78 | loss  5.33
INFO:root:| epoch   2 |  2000/ 2070 batches | lr 0.02 | ms/batch  7.76 | loss  5.34
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   2 | time: 17.44s | valid loss  5.31 | valid ppl   203.29
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   3 |   200/ 2070 batches | lr 0.02 | ms/batch  7.85 | loss  5.23
INFO:root:| epoch   3 |   400/ 2070 batches | lr 0.02 | ms/batch  7.80 | loss  5.22
INFO:root:| epoch   3 |   600/ 2070 batches | lr 0.02 | ms/batch  7.80 | loss  5.26
INFO:root:| epoch   3 |   800/ 2070 batches | lr 0.02 | ms/batch 10.21 | loss  5.08
INFO:root:| epoch   3 |  1000/ 2070 batches | lr 0.02 | ms/batch  7.97 | loss  5.21
INFO:root:| epoch   3 |  1200/ 2070 batches | lr 0.02 | ms/batch  7.87 | loss  5.15
INFO:root:| epoch   3 |  1400/ 2070 batches | lr 0.02 | ms/batch  9.71 | loss  5.09
INFO:root:| epoch   3 |  1600/ 2070 batches | lr 0.02 | ms/batch  7.97 | loss  5.18
INFO:root:| epoch   3 |  1800/ 2070 batches | lr 0.02 | ms/batch  7.92 | loss  5.05
INFO:root:| epoch   3 |  2000/ 2070 batches | lr 0.02 | ms/batch  7.69 | loss  5.12
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   3 | time: 17.28s | valid loss  5.13 | valid ppl   169.45
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   4 |   200/ 2070 batches | lr 0.02 | ms/batch  7.86 | loss  5.06
INFO:root:| epoch   4 |   400/ 2070 batches | lr 0.02 | ms/batch  7.69 | loss  5.08
INFO:root:| epoch   4 |   600/ 2070 batches | lr 0.02 | ms/batch  8.19 | loss  5.14
INFO:root:| epoch   4 |   800/ 2070 batches | lr 0.02 | ms/batch  7.92 | loss  4.97
INFO:root:| epoch   4 |  1000/ 2070 batches | lr 0.02 | ms/batch  8.52 | loss  5.12
INFO:root:| epoch   4 |  1200/ 2070 batches | lr 0.02 | ms/batch  9.24 | loss  5.06
INFO:root:| epoch   4 |  1400/ 2070 batches | lr 0.02 | ms/batch  7.92 | loss  5.00
INFO:root:| epoch   4 |  1600/ 2070 batches | lr 0.02 | ms/batch  8.85 | loss  5.10
INFO:root:| epoch   4 |  1800/ 2070 batches | lr 0.02 | ms/batch  9.19 | loss  4.98
INFO:root:| epoch   4 |  2000/ 2070 batches | lr 0.02 | ms/batch  7.95 | loss  5.04
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   4 | time: 17.38s | valid loss  5.07 | valid ppl   159.60
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   5 |   200/ 2070 batches | lr 0.02 | ms/batch  7.85 | loss  4.99
INFO:root:| epoch   5 |   400/ 2070 batches | lr 0.02 | ms/batch  7.91 | loss  5.02
INFO:root:| epoch   5 |   600/ 2070 batches | lr 0.02 | ms/batch  7.89 | loss  5.08
INFO:root:| epoch   5 |   800/ 2070 batches | lr 0.02 | ms/batch  7.71 | loss  4.91
INFO:root:| epoch   5 |  1000/ 2070 batches | lr 0.02 | ms/batch  7.73 | loss  5.07
INFO:root:| epoch   5 |  1200/ 2070 batches | lr 0.02 | ms/batch  7.80 | loss  5.01
INFO:root:| epoch   5 |  1400/ 2070 batches | lr 0.02 | ms/batch  8.72 | loss  4.95
INFO:root:| epoch   5 |  1600/ 2070 batches | lr 0.02 | ms/batch 10.40 | loss  5.06
INFO:root:| epoch   5 |  1800/ 2070 batches | lr 0.02 | ms/batch  8.19 | loss  4.94
INFO:root:| epoch   5 |  2000/ 2070 batches | lr 0.02 | ms/batch 10.64 | loss  5.00
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   5 | time: 17.75s | valid loss  5.04 | valid ppl   153.83
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   6 |   200/ 2070 batches | lr 0.02 | ms/batch  8.21 | loss  4.95
INFO:root:| epoch   6 |   400/ 2070 batches | lr 0.02 | ms/batch  8.89 | loss  4.97
INFO:root:| epoch   6 |   600/ 2070 batches | lr 0.02 | ms/batch  9.05 | loss  5.04
INFO:root:| epoch   6 |   800/ 2070 batches | lr 0.02 | ms/batch  7.91 | loss  4.87
INFO:root:| epoch   6 |  1000/ 2070 batches | lr 0.02 | ms/batch  7.88 | loss  5.03
INFO:root:| epoch   6 |  1200/ 2070 batches | lr 0.02 | ms/batch  8.00 | loss  4.97
INFO:root:| epoch   6 |  1400/ 2070 batches | lr 0.02 | ms/batch  7.70 | loss  4.92
INFO:root:| epoch   6 |  1600/ 2070 batches | lr 0.02 | ms/batch  8.36 | loss  5.02
INFO:root:| epoch   6 |  1800/ 2070 batches | lr 0.02 | ms/batch  9.44 | loss  4.90
INFO:root:| epoch   6 |  2000/ 2070 batches | lr 0.02 | ms/batch  7.95 | loss  4.96
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   6 | time: 17.45s | valid loss  5.01 | valid ppl   149.38
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   7 |   200/ 2070 batches | lr 0.02 | ms/batch 10.09 | loss  4.92
INFO:root:| epoch   7 |   400/ 2070 batches | lr 0.02 | ms/batch  7.97 | loss  4.94
INFO:root:| epoch   7 |   600/ 2070 batches | lr 0.02 | ms/batch  7.89 | loss  5.01
INFO:root:| epoch   7 |   800/ 2070 batches | lr 0.02 | ms/batch  9.75 | loss  4.84
INFO:root:| epoch   7 |  1000/ 2070 batches | lr 0.02 | ms/batch  7.96 | loss  4.99
INFO:root:| epoch   7 |  1200/ 2070 batches | lr 0.02 | ms/batch  7.96 | loss  4.94
INFO:root:| epoch   7 |  1400/ 2070 batches | lr 0.02 | ms/batch  7.86 | loss  4.88
INFO:root:| epoch   7 |  1600/ 2070 batches | lr 0.02 | ms/batch  7.75 | loss  4.98
INFO:root:| epoch   7 |  1800/ 2070 batches | lr 0.02 | ms/batch  7.73 | loss  4.87
INFO:root:| epoch   7 |  2000/ 2070 batches | lr 0.02 | ms/batch  8.65 | loss  4.93
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   7 | time: 17.72s | valid loss  4.98 | valid ppl   145.10
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   8 |   200/ 2070 batches | lr 0.02 | ms/batch  8.05 | loss  4.88
INFO:root:| epoch   8 |   400/ 2070 batches | lr 0.02 | ms/batch  7.95 | loss  4.90
INFO:root:| epoch   8 |   600/ 2070 batches | lr 0.02 | ms/batch 10.16 | loss  4.97
INFO:root:| epoch   8 |   800/ 2070 batches | lr 0.02 | ms/batch  8.47 | loss  4.80
INFO:root:| epoch   8 |  1000/ 2070 batches | lr 0.02 | ms/batch  8.63 | loss  4.96
INFO:root:| epoch   8 |  1200/ 2070 batches | lr 0.02 | ms/batch  9.65 | loss  4.90
INFO:root:| epoch   8 |  1400/ 2070 batches | lr 0.02 | ms/batch  7.88 | loss  4.85
INFO:root:| epoch   8 |  1600/ 2070 batches | lr 0.02 | ms/batch  7.91 | loss  4.94
INFO:root:| epoch   8 |  1800/ 2070 batches | lr 0.02 | ms/batch  7.96 | loss  4.83
INFO:root:| epoch   8 |  2000/ 2070 batches | lr 0.02 | ms/batch  8.43 | loss  4.89
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   8 | time: 17.74s | valid loss  4.95 | valid ppl   140.71
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   9 |   200/ 2070 batches | lr 0.02 | ms/batch  9.75 | loss  4.84
INFO:root:| epoch   9 |   400/ 2070 batches | lr 0.02 | ms/batch  8.90 | loss  4.87
INFO:root:| epoch   9 |   600/ 2070 batches | lr 0.02 | ms/batch  8.05 | loss  4.93
INFO:root:| epoch   9 |   800/ 2070 batches | lr 0.02 | ms/batch 10.02 | loss  4.76
INFO:root:| epoch   9 |  1000/ 2070 batches | lr 0.02 | ms/batch  7.98 | loss  4.91
INFO:root:| epoch   9 |  1200/ 2070 batches | lr 0.02 | ms/batch  7.93 | loss  4.86
INFO:root:| epoch   9 |  1400/ 2070 batches | lr 0.02 | ms/batch  7.98 | loss  4.81
INFO:root:| epoch   9 |  1600/ 2070 batches | lr 0.02 | ms/batch  7.78 | loss  4.90
INFO:root:| epoch   9 |  1800/ 2070 batches | lr 0.02 | ms/batch  7.67 | loss  4.79
INFO:root:| epoch   9 |  2000/ 2070 batches | lr 0.02 | ms/batch  7.74 | loss  4.85
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   9 | time: 17.54s | valid loss  4.91 | valid ppl   136.17
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  10 |   200/ 2070 batches | lr 0.02 | ms/batch  8.22 | loss  4.80
INFO:root:| epoch  10 |   400/ 2070 batches | lr 0.02 | ms/batch 10.00 | loss  4.83
INFO:root:| epoch  10 |   600/ 2070 batches | lr 0.02 | ms/batch  7.94 | loss  4.89
INFO:root:| epoch  10 |   800/ 2070 batches | lr 0.02 | ms/batch  8.46 | loss  4.72
INFO:root:| epoch  10 |  1000/ 2070 batches | lr 0.02 | ms/batch  9.47 | loss  4.87
INFO:root:| epoch  10 |  1200/ 2070 batches | lr 0.02 | ms/batch  8.02 | loss  4.82
INFO:root:| epoch  10 |  1400/ 2070 batches | lr 0.02 | ms/batch  8.72 | loss  4.77
INFO:root:| epoch  10 |  1600/ 2070 batches | lr 0.02 | ms/batch  9.24 | loss  4.86
INFO:root:| epoch  10 |  1800/ 2070 batches | lr 0.02 | ms/batch  7.96 | loss  4.75
INFO:root:| epoch  10 |  2000/ 2070 batches | lr 0.02 | ms/batch  8.93 | loss  4.81
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  10 | time: 18.13s | valid loss  4.88 | valid ppl   131.50
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:=========================================================================================
INFO:root:| End of training | test loss  5.08 | test ppl   160.33
INFO:root:=========================================================================================
INFO:root:----------- new value of n = 2, k = 4 -----------
INFO:root:Loading data
INFO:root:Vocab size 5005
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:| epoch   1 |   200/ 2250 batches | lr 0.02 | ms/batch  8.53 | loss  8.50
INFO:root:| epoch   1 |   400/ 2250 batches | lr 0.02 | ms/batch  8.27 | loss  8.33
INFO:root:| epoch   1 |   600/ 2250 batches | lr 0.02 | ms/batch  8.36 | loss  8.20
INFO:root:| epoch   1 |   800/ 2250 batches | lr 0.02 | ms/batch 10.46 | loss  8.06
INFO:root:| epoch   1 |  1000/ 2250 batches | lr 0.02 | ms/batch  8.32 | loss  7.91
INFO:root:| epoch   1 |  1200/ 2250 batches | lr 0.02 | ms/batch  8.47 | loss  7.76
INFO:root:| epoch   1 |  1400/ 2250 batches | lr 0.02 | ms/batch 10.36 | loss  7.58
INFO:root:| epoch   1 |  1600/ 2250 batches | lr 0.02 | ms/batch  8.33 | loss  7.39
INFO:root:| epoch   1 |  1800/ 2250 batches | lr 0.02 | ms/batch  8.33 | loss  7.19
INFO:root:| epoch   1 |  2000/ 2250 batches | lr 0.02 | ms/batch  8.40 | loss  6.98
INFO:root:| epoch   1 |  2200/ 2250 batches | lr 0.02 | ms/batch  8.36 | loss  6.76
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   1 | time: 19.86s | valid loss  6.63 | valid ppl   760.08
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   2 |   200/ 2250 batches | lr 0.02 | ms/batch  8.62 | loss  6.56
INFO:root:| epoch   2 |   400/ 2250 batches | lr 0.02 | ms/batch  8.39 | loss  6.37
INFO:root:| epoch   2 |   600/ 2250 batches | lr 0.02 | ms/batch  9.04 | loss  6.25
INFO:root:| epoch   2 |   800/ 2250 batches | lr 0.02 | ms/batch  9.87 | loss  6.16
INFO:root:| epoch   2 |  1000/ 2250 batches | lr 0.02 | ms/batch 11.85 | loss  6.06
INFO:root:| epoch   2 |  1200/ 2250 batches | lr 0.02 | ms/batch  8.69 | loss  5.99
INFO:root:| epoch   2 |  1400/ 2250 batches | lr 0.02 | ms/batch 10.63 | loss  5.91
INFO:root:| epoch   2 |  1600/ 2250 batches | lr 0.02 | ms/batch  8.41 | loss  5.84
INFO:root:| epoch   2 |  1800/ 2250 batches | lr 0.02 | ms/batch  8.94 | loss  5.78
INFO:root:| epoch   2 |  2000/ 2250 batches | lr 0.02 | ms/batch 10.23 | loss  5.72
INFO:root:| epoch   2 |  2200/ 2250 batches | lr 0.02 | ms/batch  8.75 | loss  5.66
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   2 | time: 21.32s | valid loss  5.67 | valid ppl   289.73
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   3 |   200/ 2250 batches | lr 0.02 | ms/batch 10.89 | loss  5.64
INFO:root:| epoch   3 |   400/ 2250 batches | lr 0.02 | ms/batch 12.80 | loss  5.58
INFO:root:| epoch   3 |   600/ 2250 batches | lr 0.02 | ms/batch 11.35 | loss  5.55
INFO:root:| epoch   3 |   800/ 2250 batches | lr 0.02 | ms/batch  9.33 | loss  5.54
INFO:root:| epoch   3 |  1000/ 2250 batches | lr 0.02 | ms/batch 10.33 | loss  5.51
INFO:root:| epoch   3 |  1200/ 2250 batches | lr 0.02 | ms/batch  9.51 | loss  5.50
INFO:root:| epoch   3 |  1400/ 2250 batches | lr 0.02 | ms/batch  8.49 | loss  5.49
INFO:root:| epoch   3 |  1600/ 2250 batches | lr 0.02 | ms/batch 10.65 | loss  5.48
INFO:root:| epoch   3 |  1800/ 2250 batches | lr 0.02 | ms/batch  8.88 | loss  5.47
INFO:root:| epoch   3 |  2000/ 2250 batches | lr 0.02 | ms/batch  8.56 | loss  5.46
INFO:root:| epoch   3 |  2200/ 2250 batches | lr 0.02 | ms/batch  8.33 | loss  5.45
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   3 | time: 22.47s | valid loss  5.49 | valid ppl   241.94
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   4 |   200/ 2250 batches | lr 0.02 | ms/batch  8.66 | loss  5.47
INFO:root:| epoch   4 |   400/ 2250 batches | lr 0.02 | ms/batch  9.44 | loss  5.43
INFO:root:| epoch   4 |   600/ 2250 batches | lr 0.02 | ms/batch 10.04 | loss  5.42
INFO:root:| epoch   4 |   800/ 2250 batches | lr 0.02 | ms/batch  8.73 | loss  5.42
INFO:root:| epoch   4 |  1000/ 2250 batches | lr 0.02 | ms/batch 10.30 | loss  5.40
INFO:root:| epoch   4 |  1200/ 2250 batches | lr 0.02 | ms/batch  8.63 | loss  5.40
INFO:root:| epoch   4 |  1400/ 2250 batches | lr 0.02 | ms/batch  8.55 | loss  5.39
INFO:root:| epoch   4 |  1600/ 2250 batches | lr 0.02 | ms/batch 14.51 | loss  5.39
INFO:root:| epoch   4 |  1800/ 2250 batches | lr 0.02 | ms/batch 17.16 | loss  5.38
INFO:root:| epoch   4 |  2000/ 2250 batches | lr 0.02 | ms/batch 11.74 | loss  5.37
INFO:root:| epoch   4 |  2200/ 2250 batches | lr 0.02 | ms/batch  9.35 | loss  5.37
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   4 | time: 24.31s | valid loss  5.42 | valid ppl   224.94
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   5 |   200/ 2250 batches | lr 0.02 | ms/batch  9.27 | loss  5.39
INFO:root:| epoch   5 |   400/ 2250 batches | lr 0.02 | ms/batch  8.52 | loss  5.35
INFO:root:| epoch   5 |   600/ 2250 batches | lr 0.02 | ms/batch 10.69 | loss  5.35
INFO:root:| epoch   5 |   800/ 2250 batches | lr 0.02 | ms/batch  8.68 | loss  5.35
INFO:root:| epoch   5 |  1000/ 2250 batches | lr 0.02 | ms/batch  8.93 | loss  5.33
INFO:root:| epoch   5 |  1200/ 2250 batches | lr 0.02 | ms/batch 10.01 | loss  5.33
INFO:root:| epoch   5 |  1400/ 2250 batches | lr 0.02 | ms/batch  8.46 | loss  5.33
INFO:root:| epoch   5 |  1600/ 2250 batches | lr 0.02 | ms/batch  8.40 | loss  5.32
INFO:root:| epoch   5 |  1800/ 2250 batches | lr 0.02 | ms/batch  9.66 | loss  5.32
INFO:root:| epoch   5 |  2000/ 2250 batches | lr 0.02 | ms/batch  9.81 | loss  5.31
INFO:root:| epoch   5 |  2200/ 2250 batches | lr 0.02 | ms/batch  8.83 | loss  5.30
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   5 | time: 21.03s | valid loss  5.36 | valid ppl   213.23
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   6 |   200/ 2250 batches | lr 0.02 | ms/batch  9.95 | loss  5.33
INFO:root:| epoch   6 |   400/ 2250 batches | lr 0.02 | ms/batch  8.42 | loss  5.29
INFO:root:| epoch   6 |   600/ 2250 batches | lr 0.02 | ms/batch 10.06 | loss  5.28
INFO:root:| epoch   6 |   800/ 2250 batches | lr 0.02 | ms/batch  9.38 | loss  5.29
INFO:root:| epoch   6 |  1000/ 2250 batches | lr 0.02 | ms/batch  8.61 | loss  5.27
INFO:root:| epoch   6 |  1200/ 2250 batches | lr 0.02 | ms/batch 10.50 | loss  5.27
INFO:root:| epoch   6 |  1400/ 2250 batches | lr 0.02 | ms/batch  8.49 | loss  5.27
INFO:root:| epoch   6 |  1600/ 2250 batches | lr 0.02 | ms/batch  8.44 | loss  5.27
INFO:root:| epoch   6 |  1800/ 2250 batches | lr 0.02 | ms/batch  8.46 | loss  5.26
INFO:root:| epoch   6 |  2000/ 2250 batches | lr 0.02 | ms/batch  8.40 | loss  5.25
INFO:root:| epoch   6 |  2200/ 2250 batches | lr 0.02 | ms/batch 10.94 | loss  5.24
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   6 | time: 20.99s | valid loss  5.31 | valid ppl   202.71
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   7 |   200/ 2250 batches | lr 0.02 | ms/batch  8.75 | loss  5.27
INFO:root:| epoch   7 |   400/ 2250 batches | lr 0.02 | ms/batch 10.81 | loss  5.23
INFO:root:| epoch   7 |   600/ 2250 batches | lr 0.02 | ms/batch  8.94 | loss  5.22
INFO:root:| epoch   7 |   800/ 2250 batches | lr 0.02 | ms/batch  8.90 | loss  5.23
INFO:root:| epoch   7 |  1000/ 2250 batches | lr 0.02 | ms/batch 10.24 | loss  5.21
INFO:root:| epoch   7 |  1200/ 2250 batches | lr 0.02 | ms/batch  8.79 | loss  5.21
INFO:root:| epoch   7 |  1400/ 2250 batches | lr 0.02 | ms/batch  9.68 | loss  5.21
INFO:root:| epoch   7 |  1600/ 2250 batches | lr 0.02 | ms/batch 10.70 | loss  5.21
INFO:root:| epoch   7 |  1800/ 2250 batches | lr 0.02 | ms/batch  8.92 | loss  5.20
INFO:root:| epoch   7 |  2000/ 2250 batches | lr 0.02 | ms/batch 11.15 | loss  5.19
INFO:root:| epoch   7 |  2200/ 2250 batches | lr 0.02 | ms/batch  8.54 | loss  5.18
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   7 | time: 21.72s | valid loss  5.26 | valid ppl   192.13
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   8 |   200/ 2250 batches | lr 0.02 | ms/batch 10.56 | loss  5.21
INFO:root:| epoch   8 |   400/ 2250 batches | lr 0.02 | ms/batch  8.91 | loss  5.16
INFO:root:| epoch   8 |   600/ 2250 batches | lr 0.02 | ms/batch  8.76 | loss  5.16
INFO:root:| epoch   8 |   800/ 2250 batches | lr 0.02 | ms/batch 10.42 | loss  5.16
INFO:root:| epoch   8 |  1000/ 2250 batches | lr 0.02 | ms/batch  8.47 | loss  5.14
INFO:root:| epoch   8 |  1200/ 2250 batches | lr 0.02 | ms/batch  9.40 | loss  5.15
INFO:root:| epoch   8 |  1400/ 2250 batches | lr 0.02 | ms/batch  9.83 | loss  5.14
INFO:root:| epoch   8 |  1600/ 2250 batches | lr 0.02 | ms/batch  8.58 | loss  5.14
INFO:root:| epoch   8 |  1800/ 2250 batches | lr 0.02 | ms/batch  9.22 | loss  5.13
INFO:root:| epoch   8 |  2000/ 2250 batches | lr 0.02 | ms/batch  9.71 | loss  5.12
INFO:root:| epoch   8 |  2200/ 2250 batches | lr 0.02 | ms/batch  8.49 | loss  5.11
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   8 | time: 21.13s | valid loss  5.20 | valid ppl   181.44
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   9 |   200/ 2250 batches | lr 0.02 | ms/batch 11.12 | loss  5.14
INFO:root:| epoch   9 |   400/ 2250 batches | lr 0.02 | ms/batch  8.60 | loss  5.09
INFO:root:| epoch   9 |   600/ 2250 batches | lr 0.02 | ms/batch  9.52 | loss  5.08
INFO:root:| epoch   9 |   800/ 2250 batches | lr 0.02 | ms/batch  9.38 | loss  5.09
INFO:root:| epoch   9 |  1000/ 2250 batches | lr 0.02 | ms/batch  8.43 | loss  5.07
INFO:root:| epoch   9 |  1200/ 2250 batches | lr 0.02 | ms/batch 10.60 | loss  5.08
INFO:root:| epoch   9 |  1400/ 2250 batches | lr 0.02 | ms/batch  8.90 | loss  5.07
INFO:root:| epoch   9 |  1600/ 2250 batches | lr 0.02 | ms/batch  8.46 | loss  5.07
INFO:root:| epoch   9 |  1800/ 2250 batches | lr 0.02 | ms/batch 10.55 | loss  5.06
INFO:root:| epoch   9 |  2000/ 2250 batches | lr 0.02 | ms/batch  8.54 | loss  5.05
INFO:root:| epoch   9 |  2200/ 2250 batches | lr 0.02 | ms/batch  8.72 | loss  5.04
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   9 | time: 21.47s | valid loss  5.14 | valid ppl   170.90
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  10 |   200/ 2250 batches | lr 0.02 | ms/batch  9.51 | loss  5.07
INFO:root:| epoch  10 |   400/ 2250 batches | lr 0.02 | ms/batch  8.59 | loss  5.02
INFO:root:| epoch  10 |   600/ 2250 batches | lr 0.02 | ms/batch  9.46 | loss  5.01
INFO:root:| epoch  10 |   800/ 2250 batches | lr 0.02 | ms/batch  9.82 | loss  5.02
INFO:root:| epoch  10 |  1000/ 2250 batches | lr 0.02 | ms/batch  8.45 | loss  5.00
INFO:root:| epoch  10 |  1200/ 2250 batches | lr 0.02 | ms/batch 11.34 | loss  5.00
INFO:root:| epoch  10 |  1400/ 2250 batches | lr 0.02 | ms/batch  8.82 | loss  5.00
INFO:root:| epoch  10 |  1600/ 2250 batches | lr 0.02 | ms/batch  8.81 | loss  5.00
INFO:root:| epoch  10 |  1800/ 2250 batches | lr 0.02 | ms/batch 10.32 | loss  4.98
INFO:root:| epoch  10 |  2000/ 2250 batches | lr 0.02 | ms/batch  8.43 | loss  4.98
INFO:root:| epoch  10 |  2200/ 2250 batches | lr 0.02 | ms/batch  9.76 | loss  4.96
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  10 | time: 21.52s | valid loss  5.08 | valid ppl   160.92
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:=========================================================================================
INFO:root:| End of training | test loss  5.27 | test ppl   194.95
INFO:root:=========================================================================================
INFO:root:----------- new value of n = 3, k = 1 -----------
INFO:root:Loading data
INFO:root:Vocab size 2005
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:| epoch   1 |   200/ 1710 batches | lr 0.02 | ms/batch  7.68 | loss  7.52
INFO:root:| epoch   1 |   400/ 1710 batches | lr 0.02 | ms/batch  7.18 | loss  7.25
INFO:root:| epoch   1 |   600/ 1710 batches | lr 0.02 | ms/batch  8.66 | loss  7.01
INFO:root:| epoch   1 |   800/ 1710 batches | lr 0.02 | ms/batch  8.06 | loss  6.73
INFO:root:| epoch   1 |  1000/ 1710 batches | lr 0.02 | ms/batch  7.33 | loss  6.41
INFO:root:| epoch   1 |  1200/ 1710 batches | lr 0.02 | ms/batch  8.70 | loss  6.03
INFO:root:| epoch   1 |  1400/ 1710 batches | lr 0.02 | ms/batch  8.16 | loss  5.63
INFO:root:| epoch   1 |  1600/ 1710 batches | lr 0.02 | ms/batch  7.12 | loss  5.25
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   1 | time: 13.52s | valid loss  5.05 | valid ppl   155.88
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   2 |   200/ 1710 batches | lr 0.02 | ms/batch 10.38 | loss  4.90
INFO:root:| epoch   2 |   400/ 1710 batches | lr 0.02 | ms/batch  7.91 | loss  4.70
INFO:root:| epoch   2 |   600/ 1710 batches | lr 0.02 | ms/batch  8.16 | loss  4.61
INFO:root:| epoch   2 |   800/ 1710 batches | lr 0.02 | ms/batch  9.76 | loss  4.46
INFO:root:| epoch   2 |  1000/ 1710 batches | lr 0.02 | ms/batch  7.64 | loss  4.36
INFO:root:| epoch   2 |  1200/ 1710 batches | lr 0.02 | ms/batch  7.65 | loss  4.26
INFO:root:| epoch   2 |  1400/ 1710 batches | lr 0.02 | ms/batch 10.51 | loss  4.19
INFO:root:| epoch   2 |  1600/ 1710 batches | lr 0.02 | ms/batch  7.74 | loss  4.13
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   2 | time: 14.96s | valid loss  4.20 | valid ppl    66.63
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   3 |   200/ 1710 batches | lr 0.02 | ms/batch  7.69 | loss  4.12
INFO:root:| epoch   3 |   400/ 1710 batches | lr 0.02 | ms/batch  7.63 | loss  4.05
INFO:root:| epoch   3 |   600/ 1710 batches | lr 0.02 | ms/batch  8.16 | loss  4.07
INFO:root:| epoch   3 |   800/ 1710 batches | lr 0.02 | ms/batch  9.44 | loss  4.05
INFO:root:| epoch   3 |  1000/ 1710 batches | lr 0.02 | ms/batch  8.05 | loss  4.04
INFO:root:| epoch   3 |  1200/ 1710 batches | lr 0.02 | ms/batch  8.65 | loss  4.03
INFO:root:| epoch   3 |  1400/ 1710 batches | lr 0.02 | ms/batch  9.30 | loss  4.02
INFO:root:| epoch   3 |  1600/ 1710 batches | lr 0.02 | ms/batch  7.94 | loss  4.01
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   3 | time: 14.36s | valid loss  4.10 | valid ppl    60.29
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   4 |   200/ 1710 batches | lr 0.02 | ms/batch  7.92 | loss  4.03
INFO:root:| epoch   4 |   400/ 1710 batches | lr 0.02 | ms/batch 10.09 | loss  3.99
INFO:root:| epoch   4 |   600/ 1710 batches | lr 0.02 | ms/batch  8.12 | loss  4.02
INFO:root:| epoch   4 |   800/ 1710 batches | lr 0.02 | ms/batch  8.25 | loss  4.01
INFO:root:| epoch   4 |  1000/ 1710 batches | lr 0.02 | ms/batch  9.77 | loss  4.00
INFO:root:| epoch   4 |  1200/ 1710 batches | lr 0.02 | ms/batch  7.82 | loss  4.00
INFO:root:| epoch   4 |  1400/ 1710 batches | lr 0.02 | ms/batch  8.42 | loss  3.99
INFO:root:| epoch   4 |  1600/ 1710 batches | lr 0.02 | ms/batch  9.40 | loss  3.98
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   4 | time: 14.95s | valid loss  4.08 | valid ppl    58.98
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   5 |   200/ 1710 batches | lr 0.02 | ms/batch  7.93 | loss  4.01
INFO:root:| epoch   5 |   400/ 1710 batches | lr 0.02 | ms/batch 10.12 | loss  3.97
INFO:root:| epoch   5 |   600/ 1710 batches | lr 0.02 | ms/batch  7.95 | loss  4.00
INFO:root:| epoch   5 |   800/ 1710 batches | lr 0.02 | ms/batch  7.99 | loss  3.99
INFO:root:| epoch   5 |  1000/ 1710 batches | lr 0.02 | ms/batch  9.76 | loss  3.98
INFO:root:| epoch   5 |  1200/ 1710 batches | lr 0.02 | ms/batch  7.77 | loss  3.99
INFO:root:| epoch   5 |  1400/ 1710 batches | lr 0.02 | ms/batch  8.09 | loss  3.98
INFO:root:| epoch   5 |  1600/ 1710 batches | lr 0.02 | ms/batch  9.81 | loss  3.97
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   5 | time: 14.90s | valid loss  4.07 | valid ppl    58.55
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   6 |   200/ 1710 batches | lr 0.02 | ms/batch  7.82 | loss  4.00
INFO:root:| epoch   6 |   400/ 1710 batches | lr 0.02 | ms/batch  9.97 | loss  3.96
INFO:root:| epoch   6 |   600/ 1710 batches | lr 0.02 | ms/batch  7.61 | loss  3.99
INFO:root:| epoch   6 |   800/ 1710 batches | lr 0.02 | ms/batch  7.68 | loss  3.98
INFO:root:| epoch   6 |  1000/ 1710 batches | lr 0.02 | ms/batch 10.13 | loss  3.97
INFO:root:| epoch   6 |  1200/ 1710 batches | lr 0.02 | ms/batch  7.93 | loss  3.98
INFO:root:| epoch   6 |  1400/ 1710 batches | lr 0.02 | ms/batch  7.76 | loss  3.97
INFO:root:| epoch   6 |  1600/ 1710 batches | lr 0.02 | ms/batch  8.50 | loss  3.96
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   6 | time: 14.79s | valid loss  4.07 | valid ppl    58.29
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   7 |   200/ 1710 batches | lr 0.02 | ms/batch  8.26 | loss  3.99
INFO:root:| epoch   7 |   400/ 1710 batches | lr 0.02 | ms/batch  7.97 | loss  3.95
INFO:root:| epoch   7 |   600/ 1710 batches | lr 0.02 | ms/batch  7.74 | loss  3.98
INFO:root:| epoch   7 |   800/ 1710 batches | lr 0.02 | ms/batch  9.94 | loss  3.97
INFO:root:| epoch   7 |  1000/ 1710 batches | lr 0.02 | ms/batch  7.72 | loss  3.96
INFO:root:| epoch   7 |  1200/ 1710 batches | lr 0.02 | ms/batch  7.76 | loss  3.97
INFO:root:| epoch   7 |  1400/ 1710 batches | lr 0.02 | ms/batch 10.00 | loss  3.96
INFO:root:| epoch   7 |  1600/ 1710 batches | lr 0.02 | ms/batch  7.98 | loss  3.95
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   7 | time: 14.47s | valid loss  4.06 | valid ppl    58.05
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   8 |   200/ 1710 batches | lr 0.02 | ms/batch  7.77 | loss  3.98
INFO:root:| epoch   8 |   400/ 1710 batches | lr 0.02 | ms/batch  8.15 | loss  3.94
INFO:root:| epoch   8 |   600/ 1710 batches | lr 0.02 | ms/batch  8.84 | loss  3.97
INFO:root:| epoch   8 |   800/ 1710 batches | lr 0.02 | ms/batch 10.02 | loss  3.96
INFO:root:| epoch   8 |  1000/ 1710 batches | lr 0.02 | ms/batch  7.79 | loss  3.95
INFO:root:| epoch   8 |  1200/ 1710 batches | lr 0.02 | ms/batch 10.88 | loss  3.96
INFO:root:| epoch   8 |  1400/ 1710 batches | lr 0.02 | ms/batch  8.58 | loss  3.95
INFO:root:| epoch   8 |  1600/ 1710 batches | lr 0.02 | ms/batch  7.88 | loss  3.94
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   8 | time: 15.31s | valid loss  4.06 | valid ppl    57.81
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   9 |   200/ 1710 batches | lr 0.02 | ms/batch  8.51 | loss  3.97
INFO:root:| epoch   9 |   400/ 1710 batches | lr 0.02 | ms/batch  7.74 | loss  3.93
INFO:root:| epoch   9 |   600/ 1710 batches | lr 0.02 | ms/batch  9.51 | loss  3.96
INFO:root:| epoch   9 |   800/ 1710 batches | lr 0.02 | ms/batch  8.57 | loss  3.96
INFO:root:| epoch   9 |  1000/ 1710 batches | lr 0.02 | ms/batch  7.85 | loss  3.94
INFO:root:| epoch   9 |  1200/ 1710 batches | lr 0.02 | ms/batch  9.97 | loss  3.95
INFO:root:| epoch   9 |  1400/ 1710 batches | lr 0.02 | ms/batch  7.87 | loss  3.94
INFO:root:| epoch   9 |  1600/ 1710 batches | lr 0.02 | ms/batch  7.72 | loss  3.94
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   9 | time: 14.82s | valid loss  4.05 | valid ppl    57.57
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  10 |   200/ 1710 batches | lr 0.02 | ms/batch  8.78 | loss  3.96
INFO:root:| epoch  10 |   400/ 1710 batches | lr 0.02 | ms/batch  7.93 | loss  3.93
INFO:root:| epoch  10 |   600/ 1710 batches | lr 0.02 | ms/batch  9.41 | loss  3.95
INFO:root:| epoch  10 |   800/ 1710 batches | lr 0.02 | ms/batch  8.31 | loss  3.95
INFO:root:| epoch  10 |  1000/ 1710 batches | lr 0.02 | ms/batch  7.81 | loss  3.93
INFO:root:| epoch  10 |  1200/ 1710 batches | lr 0.02 | ms/batch  9.55 | loss  3.94
INFO:root:| epoch  10 |  1400/ 1710 batches | lr 0.02 | ms/batch  8.14 | loss  3.93
INFO:root:| epoch  10 |  1600/ 1710 batches | lr 0.02 | ms/batch  8.97 | loss  3.93
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  10 | time: 15.05s | valid loss  4.05 | valid ppl    57.32
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:=========================================================================================
INFO:root:| End of training | test loss  4.21 | test ppl    67.53
INFO:root:=========================================================================================
INFO:root:----------- new value of n = 3, k = 2 -----------
INFO:root:Loading data
INFO:root:Vocab size 3005
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:| epoch   1 |   200/ 1890 batches | lr 0.02 | ms/batch 10.05 | loss  7.95
INFO:root:| epoch   1 |   400/ 1890 batches | lr 0.02 | ms/batch  9.26 | loss  7.71
INFO:root:| epoch   1 |   600/ 1890 batches | lr 0.02 | ms/batch  9.19 | loss  7.51
INFO:root:| epoch   1 |   800/ 1890 batches | lr 0.02 | ms/batch  9.05 | loss  7.27
INFO:root:| epoch   1 |  1000/ 1890 batches | lr 0.02 | ms/batch 11.03 | loss  7.01
INFO:root:| epoch   1 |  1200/ 1890 batches | lr 0.02 | ms/batch  9.42 | loss  6.69
INFO:root:| epoch   1 |  1400/ 1890 batches | lr 0.02 | ms/batch  9.81 | loss  6.33
INFO:root:| epoch   1 |  1600/ 1890 batches | lr 0.02 | ms/batch 10.77 | loss  6.01
INFO:root:| epoch   1 |  1800/ 1890 batches | lr 0.02 | ms/batch  9.85 | loss  5.71
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   1 | time: 18.71s | valid loss  5.50 | valid ppl   245.14
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   2 |   200/ 1890 batches | lr 0.02 | ms/batch 12.56 | loss  5.45
INFO:root:| epoch   2 |   400/ 1890 batches | lr 0.02 | ms/batch  9.62 | loss  5.28
INFO:root:| epoch   2 |   600/ 1890 batches | lr 0.02 | ms/batch 11.16 | loss  5.17
INFO:root:| epoch   2 |   800/ 1890 batches | lr 0.02 | ms/batch  9.30 | loss  5.06
INFO:root:| epoch   2 |  1000/ 1890 batches | lr 0.02 | ms/batch  9.52 | loss  4.96
INFO:root:| epoch   2 |  1200/ 1890 batches | lr 0.02 | ms/batch 10.95 | loss  4.86
INFO:root:| epoch   2 |  1400/ 1890 batches | lr 0.02 | ms/batch  9.19 | loss  4.77
INFO:root:| epoch   2 |  1600/ 1890 batches | lr 0.02 | ms/batch 11.13 | loss  4.77
INFO:root:| epoch   2 |  1800/ 1890 batches | lr 0.02 | ms/batch  9.28 | loss  4.73
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   2 | time: 19.54s | valid loss  4.72 | valid ppl   112.65
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   3 |   200/ 1890 batches | lr 0.02 | ms/batch 11.37 | loss  4.71
INFO:root:| epoch   3 |   400/ 1890 batches | lr 0.02 | ms/batch  9.15 | loss  4.64
INFO:root:| epoch   3 |   600/ 1890 batches | lr 0.02 | ms/batch 10.22 | loss  4.64
INFO:root:| epoch   3 |   800/ 1890 batches | lr 0.02 | ms/batch 10.62 | loss  4.63
INFO:root:| epoch   3 |  1000/ 1890 batches | lr 0.02 | ms/batch  9.25 | loss  4.62
INFO:root:| epoch   3 |  1200/ 1890 batches | lr 0.02 | ms/batch 11.11 | loss  4.61
INFO:root:| epoch   3 |  1400/ 1890 batches | lr 0.02 | ms/batch  9.66 | loss  4.57
INFO:root:| epoch   3 |  1600/ 1890 batches | lr 0.02 | ms/batch  9.66 | loss  4.62
INFO:root:| epoch   3 |  1800/ 1890 batches | lr 0.02 | ms/batch 11.13 | loss  4.60
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   3 | time: 19.47s | valid loss  4.63 | valid ppl   102.73
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   4 |   200/ 1890 batches | lr 0.02 | ms/batch  9.31 | loss  4.62
INFO:root:| epoch   4 |   400/ 1890 batches | lr 0.02 | ms/batch 11.38 | loss  4.57
INFO:root:| epoch   4 |   600/ 1890 batches | lr 0.02 | ms/batch  9.24 | loss  4.57
INFO:root:| epoch   4 |   800/ 1890 batches | lr 0.02 | ms/batch 10.54 | loss  4.57
INFO:root:| epoch   4 |  1000/ 1890 batches | lr 0.02 | ms/batch 10.08 | loss  4.56
INFO:root:| epoch   4 |  1200/ 1890 batches | lr 0.02 | ms/batch  9.09 | loss  4.56
INFO:root:| epoch   4 |  1400/ 1890 batches | lr 0.02 | ms/batch 11.40 | loss  4.53
INFO:root:| epoch   4 |  1600/ 1890 batches | lr 0.02 | ms/batch  9.16 | loss  4.58
INFO:root:| epoch   4 |  1800/ 1890 batches | lr 0.02 | ms/batch 10.59 | loss  4.56
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   4 | time: 19.34s | valid loss  4.60 | valid ppl    99.86
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   5 |   200/ 1890 batches | lr 0.02 | ms/batch  9.26 | loss  4.58
INFO:root:| epoch   5 |   400/ 1890 batches | lr 0.02 | ms/batch 10.93 | loss  4.53
INFO:root:| epoch   5 |   600/ 1890 batches | lr 0.02 | ms/batch 10.47 | loss  4.54
INFO:root:| epoch   5 |   800/ 1890 batches | lr 0.02 | ms/batch  9.21 | loss  4.54
INFO:root:| epoch   5 |  1000/ 1890 batches | lr 0.02 | ms/batch 11.37 | loss  4.53
INFO:root:| epoch   5 |  1200/ 1890 batches | lr 0.02 | ms/batch  9.11 | loss  4.54
INFO:root:| epoch   5 |  1400/ 1890 batches | lr 0.02 | ms/batch 10.45 | loss  4.50
INFO:root:| epoch   5 |  1600/ 1890 batches | lr 0.02 | ms/batch 10.02 | loss  4.56
INFO:root:| epoch   5 |  1800/ 1890 batches | lr 0.02 | ms/batch  9.17 | loss  4.54
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   5 | time: 19.32s | valid loss  4.59 | valid ppl    98.33
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   6 |   200/ 1890 batches | lr 0.02 | ms/batch  9.96 | loss  4.56
INFO:root:| epoch   6 |   400/ 1890 batches | lr 0.02 | ms/batch  9.08 | loss  4.51
INFO:root:| epoch   6 |   600/ 1890 batches | lr 0.02 | ms/batch 11.23 | loss  4.52
INFO:root:| epoch   6 |   800/ 1890 batches | lr 0.02 | ms/batch  9.14 | loss  4.52
INFO:root:| epoch   6 |  1000/ 1890 batches | lr 0.02 | ms/batch  9.94 | loss  4.51
INFO:root:| epoch   6 |  1200/ 1890 batches | lr 0.02 | ms/batch 10.15 | loss  4.52
INFO:root:| epoch   6 |  1400/ 1890 batches | lr 0.02 | ms/batch  9.21 | loss  4.48
INFO:root:| epoch   6 |  1600/ 1890 batches | lr 0.02 | ms/batch 11.42 | loss  4.54
INFO:root:| epoch   6 |  1800/ 1890 batches | lr 0.02 | ms/batch  9.16 | loss  4.52
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   6 | time: 18.88s | valid loss  4.57 | valid ppl    96.96
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   7 |   200/ 1890 batches | lr 0.02 | ms/batch 11.72 | loss  4.54
INFO:root:| epoch   7 |   400/ 1890 batches | lr 0.02 | ms/batch  9.07 | loss  4.49
INFO:root:| epoch   7 |   600/ 1890 batches | lr 0.02 | ms/batch 10.11 | loss  4.50
INFO:root:| epoch   7 |   800/ 1890 batches | lr 0.02 | ms/batch 10.81 | loss  4.50
INFO:root:| epoch   7 |  1000/ 1890 batches | lr 0.02 | ms/batch  9.59 | loss  4.49
INFO:root:| epoch   7 |  1200/ 1890 batches | lr 0.02 | ms/batch  9.20 | loss  4.50
INFO:root:| epoch   7 |  1400/ 1890 batches | lr 0.02 | ms/batch  9.09 | loss  4.46
INFO:root:| epoch   7 |  1600/ 1890 batches | lr 0.02 | ms/batch 10.72 | loss  4.52
INFO:root:| epoch   7 |  1800/ 1890 batches | lr 0.02 | ms/batch  9.56 | loss  4.50
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   7 | time: 18.98s | valid loss  4.56 | valid ppl    95.61
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   8 |   200/ 1890 batches | lr 0.02 | ms/batch 11.32 | loss  4.52
INFO:root:| epoch   8 |   400/ 1890 batches | lr 0.02 | ms/batch  9.41 | loss  4.47
INFO:root:| epoch   8 |   600/ 1890 batches | lr 0.02 | ms/batch 10.19 | loss  4.48
INFO:root:| epoch   8 |   800/ 1890 batches | lr 0.02 | ms/batch 12.00 | loss  4.48
INFO:root:| epoch   8 |  1000/ 1890 batches | lr 0.02 | ms/batch  9.13 | loss  4.47
INFO:root:| epoch   8 |  1200/ 1890 batches | lr 0.02 | ms/batch 11.35 | loss  4.48
INFO:root:| epoch   8 |  1400/ 1890 batches | lr 0.02 | ms/batch  9.13 | loss  4.44
INFO:root:| epoch   8 |  1600/ 1890 batches | lr 0.02 | ms/batch  9.12 | loss  4.50
INFO:root:| epoch   8 |  1800/ 1890 batches | lr 0.02 | ms/batch 11.49 | loss  4.48
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   8 | time: 19.63s | valid loss  4.55 | valid ppl    94.24
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   9 |   200/ 1890 batches | lr 0.02 | ms/batch  9.23 | loss  4.50
INFO:root:| epoch   9 |   400/ 1890 batches | lr 0.02 | ms/batch 11.30 | loss  4.45
INFO:root:| epoch   9 |   600/ 1890 batches | lr 0.02 | ms/batch  9.17 | loss  4.45
INFO:root:| epoch   9 |   800/ 1890 batches | lr 0.02 | ms/batch  9.26 | loss  4.45
INFO:root:| epoch   9 |  1000/ 1890 batches | lr 0.02 | ms/batch 11.33 | loss  4.45
INFO:root:| epoch   9 |  1200/ 1890 batches | lr 0.02 | ms/batch  9.14 | loss  4.46
INFO:root:| epoch   9 |  1400/ 1890 batches | lr 0.02 | ms/batch  9.10 | loss  4.42
INFO:root:| epoch   9 |  1600/ 1890 batches | lr 0.02 | ms/batch  8.89 | loss  4.48
INFO:root:| epoch   9 |  1800/ 1890 batches | lr 0.02 | ms/batch  8.87 | loss  4.45
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   9 | time: 18.59s | valid loss  4.53 | valid ppl    92.86
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  10 |   200/ 1890 batches | lr 0.02 | ms/batch 10.04 | loss  4.48
INFO:root:| epoch  10 |   400/ 1890 batches | lr 0.02 | ms/batch  9.14 | loss  4.43
INFO:root:| epoch  10 |   600/ 1890 batches | lr 0.02 | ms/batch 11.35 | loss  4.43
INFO:root:| epoch  10 |   800/ 1890 batches | lr 0.02 | ms/batch  9.26 | loss  4.43
INFO:root:| epoch  10 |  1000/ 1890 batches | lr 0.02 | ms/batch  9.07 | loss  4.42
INFO:root:| epoch  10 |  1200/ 1890 batches | lr 0.02 | ms/batch 11.32 | loss  4.44
INFO:root:| epoch  10 |  1400/ 1890 batches | lr 0.02 | ms/batch  9.15 | loss  4.40
INFO:root:| epoch  10 |  1600/ 1890 batches | lr 0.02 | ms/batch 10.54 | loss  4.45
INFO:root:| epoch  10 |  1800/ 1890 batches | lr 0.02 | ms/batch  9.89 | loss  4.43
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  10 | time: 18.95s | valid loss  4.52 | valid ppl    91.43
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:=========================================================================================
INFO:root:| End of training | test loss  4.71 | test ppl   110.66
INFO:root:=========================================================================================
INFO:root:----------- new value of n = 3, k = 3 -----------
INFO:root:Loading data
INFO:root:Vocab size 4005
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:| epoch   1 |   200/ 2070 batches | lr 0.02 | ms/batch 11.30 | loss  8.25
INFO:root:| epoch   1 |   400/ 2070 batches | lr 0.02 | ms/batch  8.63 | loss  8.06
INFO:root:| epoch   1 |   600/ 2070 batches | lr 0.02 | ms/batch  9.36 | loss  7.90
INFO:root:| epoch   1 |   800/ 2070 batches | lr 0.02 | ms/batch 10.32 | loss  7.71
INFO:root:| epoch   1 |  1000/ 2070 batches | lr 0.02 | ms/batch  9.55 | loss  7.53
INFO:root:| epoch   1 |  1200/ 2070 batches | lr 0.02 | ms/batch 10.82 | loss  7.29
INFO:root:| epoch   1 |  1400/ 2070 batches | lr 0.02 | ms/batch  9.06 | loss  7.02
INFO:root:| epoch   1 |  1600/ 2070 batches | lr 0.02 | ms/batch  8.97 | loss  6.77
INFO:root:| epoch   1 |  1800/ 2070 batches | lr 0.02 | ms/batch 10.58 | loss  6.42
INFO:root:| epoch   1 |  2000/ 2070 batches | lr 0.02 | ms/batch  8.72 | loss  6.16
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   1 | time: 20.28s | valid loss  6.03 | valid ppl   415.82
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   2 |   200/ 2070 batches | lr 0.02 | ms/batch 11.06 | loss  5.84
INFO:root:| epoch   2 |   400/ 2070 batches | lr 0.02 | ms/batch  9.15 | loss  5.71
INFO:root:| epoch   2 |   600/ 2070 batches | lr 0.02 | ms/batch  9.29 | loss  5.60
INFO:root:| epoch   2 |   800/ 2070 batches | lr 0.02 | ms/batch 10.73 | loss  5.42
INFO:root:| epoch   2 |  1000/ 2070 batches | lr 0.02 | ms/batch  9.05 | loss  5.43
INFO:root:| epoch   2 |  1200/ 2070 batches | lr 0.02 | ms/batch 10.16 | loss  5.30
INFO:root:| epoch   2 |  1400/ 2070 batches | lr 0.02 | ms/batch 10.35 | loss  5.24
INFO:root:| epoch   2 |  1600/ 2070 batches | lr 0.02 | ms/batch  8.98 | loss  5.26
INFO:root:| epoch   2 |  1800/ 2070 batches | lr 0.02 | ms/batch  8.84 | loss  5.13
INFO:root:| epoch   2 |  2000/ 2070 batches | lr 0.02 | ms/batch  9.06 | loss  5.16
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   2 | time: 20.17s | valid loss  5.24 | valid ppl   189.05
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   3 |   200/ 2070 batches | lr 0.02 | ms/batch 10.85 | loss  5.09
INFO:root:| epoch   3 |   400/ 2070 batches | lr 0.02 | ms/batch  9.06 | loss  5.14
INFO:root:| epoch   3 |   600/ 2070 batches | lr 0.02 | ms/batch  8.99 | loss  5.14
INFO:root:| epoch   3 |   800/ 2070 batches | lr 0.02 | ms/batch 11.02 | loss  5.03
INFO:root:| epoch   3 |  1000/ 2070 batches | lr 0.02 | ms/batch  8.99 | loss  5.14
INFO:root:| epoch   3 |  1200/ 2070 batches | lr 0.02 | ms/batch  8.72 | loss  5.06
INFO:root:| epoch   3 |  1400/ 2070 batches | lr 0.02 | ms/batch 11.04 | loss  5.06
INFO:root:| epoch   3 |  1600/ 2070 batches | lr 0.02 | ms/batch  8.86 | loss  5.10
INFO:root:| epoch   3 |  1800/ 2070 batches | lr 0.02 | ms/batch  8.76 | loss  5.01
INFO:root:| epoch   3 |  2000/ 2070 batches | lr 0.02 | ms/batch  8.82 | loss  5.05
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   3 | time: 19.85s | valid loss  5.15 | valid ppl   172.01
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   4 |   200/ 2070 batches | lr 0.02 | ms/batch 10.71 | loss  4.98
INFO:root:| epoch   4 |   400/ 2070 batches | lr 0.02 | ms/batch  9.61 | loss  5.05
INFO:root:| epoch   4 |   600/ 2070 batches | lr 0.02 | ms/batch  8.86 | loss  5.06
INFO:root:| epoch   4 |   800/ 2070 batches | lr 0.02 | ms/batch 11.80 | loss  4.95
INFO:root:| epoch   4 |  1000/ 2070 batches | lr 0.02 | ms/batch  9.29 | loss  5.07
INFO:root:| epoch   4 |  1200/ 2070 batches | lr 0.02 | ms/batch 16.66 | loss  4.99
INFO:root:| epoch   4 |  1400/ 2070 batches | lr 0.02 | ms/batch  8.83 | loss  4.98
INFO:root:| epoch   4 |  1600/ 2070 batches | lr 0.02 | ms/batch 10.43 | loss  5.04
INFO:root:| epoch   4 |  1800/ 2070 batches | lr 0.02 | ms/batch  9.68 | loss  4.95
INFO:root:| epoch   4 |  2000/ 2070 batches | lr 0.02 | ms/batch  8.88 | loss  4.99
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   4 | time: 21.79s | valid loss  5.10 | valid ppl   164.05
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   5 |   200/ 2070 batches | lr 0.02 | ms/batch 11.11 | loss  4.93
INFO:root:| epoch   5 |   400/ 2070 batches | lr 0.02 | ms/batch  8.83 | loss  5.00
INFO:root:| epoch   5 |   600/ 2070 batches | lr 0.02 | ms/batch  9.60 | loss  5.01
INFO:root:| epoch   5 |   800/ 2070 batches | lr 0.02 | ms/batch 10.45 | loss  4.90
INFO:root:| epoch   5 |  1000/ 2070 batches | lr 0.02 | ms/batch  8.77 | loss  5.02
INFO:root:| epoch   5 |  1200/ 2070 batches | lr 0.02 | ms/batch 11.05 | loss  4.95
INFO:root:| epoch   5 |  1400/ 2070 batches | lr 0.02 | ms/batch  9.15 | loss  4.94
INFO:root:| epoch   5 |  1600/ 2070 batches | lr 0.02 | ms/batch  9.31 | loss  5.00
INFO:root:| epoch   5 |  1800/ 2070 batches | lr 0.02 | ms/batch 10.55 | loss  4.91
INFO:root:| epoch   5 |  2000/ 2070 batches | lr 0.02 | ms/batch  8.97 | loss  4.94
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   5 | time: 20.44s | valid loss  5.07 | valid ppl   158.93
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   6 |   200/ 2070 batches | lr 0.02 | ms/batch 10.82 | loss  4.89
INFO:root:| epoch   6 |   400/ 2070 batches | lr 0.02 | ms/batch  8.86 | loss  4.96
INFO:root:| epoch   6 |   600/ 2070 batches | lr 0.02 | ms/batch 10.52 | loss  4.97
INFO:root:| epoch   6 |   800/ 2070 batches | lr 0.02 | ms/batch  9.67 | loss  4.86
INFO:root:| epoch   6 |  1000/ 2070 batches | lr 0.02 | ms/batch  8.76 | loss  4.98
INFO:root:| epoch   6 |  1200/ 2070 batches | lr 0.02 | ms/batch 10.95 | loss  4.91
INFO:root:| epoch   6 |  1400/ 2070 batches | lr 0.02 | ms/batch  8.81 | loss  4.90
INFO:root:| epoch   6 |  1600/ 2070 batches | lr 0.02 | ms/batch  9.91 | loss  4.96
INFO:root:| epoch   6 |  1800/ 2070 batches | lr 0.02 | ms/batch  9.88 | loss  4.87
INFO:root:| epoch   6 |  2000/ 2070 batches | lr 0.02 | ms/batch  8.76 | loss  4.91
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   6 | time: 20.41s | valid loss  5.04 | valid ppl   154.21
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   7 |   200/ 2070 batches | lr 0.02 | ms/batch 10.76 | loss  4.85
INFO:root:| epoch   7 |   400/ 2070 batches | lr 0.02 | ms/batch  9.36 | loss  4.92
INFO:root:| epoch   7 |   600/ 2070 batches | lr 0.02 | ms/batch 11.62 | loss  4.93
INFO:root:| epoch   7 |   800/ 2070 batches | lr 0.02 | ms/batch  8.92 | loss  4.82
INFO:root:| epoch   7 |  1000/ 2070 batches | lr 0.02 | ms/batch  9.72 | loss  4.94
INFO:root:| epoch   7 |  1200/ 2070 batches | lr 0.02 | ms/batch 10.20 | loss  4.87
INFO:root:| epoch   7 |  1400/ 2070 batches | lr 0.02 | ms/batch  8.89 | loss  4.86
INFO:root:| epoch   7 |  1600/ 2070 batches | lr 0.02 | ms/batch 11.17 | loss  4.91
INFO:root:| epoch   7 |  1800/ 2070 batches | lr 0.02 | ms/batch  9.03 | loss  4.83
INFO:root:| epoch   7 |  2000/ 2070 batches | lr 0.02 | ms/batch  8.77 | loss  4.86
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   7 | time: 20.52s | valid loss  5.01 | valid ppl   149.45
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   8 |   200/ 2070 batches | lr 0.02 | ms/batch  8.87 | loss  4.81
INFO:root:| epoch   8 |   400/ 2070 batches | lr 0.02 | ms/batch  8.84 | loss  4.87
INFO:root:| epoch   8 |   600/ 2070 batches | lr 0.02 | ms/batch  9.54 | loss  4.89
INFO:root:| epoch   8 |   800/ 2070 batches | lr 0.02 | ms/batch 11.17 | loss  4.78
INFO:root:| epoch   8 |  1000/ 2070 batches | lr 0.02 | ms/batch 11.90 | loss  4.89
INFO:root:| epoch   8 |  1200/ 2070 batches | lr 0.02 | ms/batch 10.34 | loss  4.82
INFO:root:| epoch   8 |  1400/ 2070 batches | lr 0.02 | ms/batch 11.02 | loss  4.82
INFO:root:| epoch   8 |  1600/ 2070 batches | lr 0.02 | ms/batch  9.38 | loss  4.87
INFO:root:| epoch   8 |  1800/ 2070 batches | lr 0.02 | ms/batch  9.06 | loss  4.79
INFO:root:| epoch   8 |  2000/ 2070 batches | lr 0.02 | ms/batch  8.76 | loss  4.82
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   8 | time: 20.61s | valid loss  4.97 | valid ppl   144.63
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   9 |   200/ 2070 batches | lr 0.02 | ms/batch  8.92 | loss  4.77
INFO:root:| epoch   9 |   400/ 2070 batches | lr 0.02 | ms/batch  9.49 | loss  4.83
INFO:root:| epoch   9 |   600/ 2070 batches | lr 0.02 | ms/batch  9.51 | loss  4.84
INFO:root:| epoch   9 |   800/ 2070 batches | lr 0.02 | ms/batch 12.09 | loss  4.73
INFO:root:| epoch   9 |  1000/ 2070 batches | lr 0.02 | ms/batch  9.82 | loss  4.84
INFO:root:| epoch   9 |  1200/ 2070 batches | lr 0.02 | ms/batch 10.41 | loss  4.78
INFO:root:| epoch   9 |  1400/ 2070 batches | lr 0.02 | ms/batch 10.21 | loss  4.77
INFO:root:| epoch   9 |  1600/ 2070 batches | lr 0.02 | ms/batch  8.73 | loss  4.82
INFO:root:| epoch   9 |  1800/ 2070 batches | lr 0.02 | ms/batch 11.33 | loss  4.74
INFO:root:| epoch   9 |  2000/ 2070 batches | lr 0.02 | ms/batch  8.77 | loss  4.77
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   9 | time: 20.77s | valid loss  4.94 | valid ppl   139.82
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  10 |   200/ 2070 batches | lr 0.02 | ms/batch  8.89 | loss  4.72
INFO:root:| epoch  10 |   400/ 2070 batches | lr 0.02 | ms/batch  9.52 | loss  4.78
INFO:root:| epoch  10 |   600/ 2070 batches | lr 0.02 | ms/batch 11.36 | loss  4.80
INFO:root:| epoch  10 |   800/ 2070 batches | lr 0.02 | ms/batch 13.65 | loss  4.68
INFO:root:| epoch  10 |  1000/ 2070 batches | lr 0.02 | ms/batch 12.77 | loss  4.80
INFO:root:| epoch  10 |  1200/ 2070 batches | lr 0.02 | ms/batch 12.70 | loss  4.73
INFO:root:| epoch  10 |  1400/ 2070 batches | lr 0.02 | ms/batch 12.28 | loss  4.72
INFO:root:| epoch  10 |  1600/ 2070 batches | lr 0.02 | ms/batch 12.36 | loss  4.78
INFO:root:| epoch  10 |  1800/ 2070 batches | lr 0.02 | ms/batch 11.35 | loss  4.69
INFO:root:| epoch  10 |  2000/ 2070 batches | lr 0.02 | ms/batch 11.24 | loss  4.73
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  10 | time: 24.25s | valid loss  4.91 | valid ppl   135.19
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:=========================================================================================
INFO:root:| End of training | test loss  5.10 | test ppl   163.71
INFO:root:=========================================================================================
INFO:root:----------- new value of n = 3, k = 4 -----------
INFO:root:Loading data
INFO:root:Vocab size 5005
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:| epoch   1 |   200/ 2250 batches | lr 0.02 | ms/batch 12.30 | loss  8.49
INFO:root:| epoch   1 |   400/ 2250 batches | lr 0.02 | ms/batch 13.23 | loss  8.30
INFO:root:| epoch   1 |   600/ 2250 batches | lr 0.02 | ms/batch 14.35 | loss  8.15
INFO:root:| epoch   1 |   800/ 2250 batches | lr 0.02 | ms/batch 11.91 | loss  7.99
INFO:root:| epoch   1 |  1000/ 2250 batches | lr 0.02 | ms/batch 10.82 | loss  7.80
INFO:root:| epoch   1 |  1200/ 2250 batches | lr 0.02 | ms/batch 10.76 | loss  7.59
INFO:root:| epoch   1 |  1400/ 2250 batches | lr 0.02 | ms/batch  9.46 | loss  7.34
INFO:root:| epoch   1 |  1600/ 2250 batches | lr 0.02 | ms/batch 11.70 | loss  7.07
INFO:root:| epoch   1 |  1800/ 2250 batches | lr 0.02 | ms/batch 10.21 | loss  6.79
INFO:root:| epoch   1 |  2000/ 2250 batches | lr 0.02 | ms/batch 11.07 | loss  6.53
INFO:root:| epoch   1 |  2200/ 2250 batches | lr 0.02 | ms/batch 10.45 | loss  6.34
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   1 | time: 26.10s | valid loss  6.30 | valid ppl   545.23
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   2 |   200/ 2250 batches | lr 0.02 | ms/batch 11.93 | loss  6.19
INFO:root:| epoch   2 |   400/ 2250 batches | lr 0.02 | ms/batch 10.73 | loss  6.06
INFO:root:| epoch   2 |   600/ 2250 batches | lr 0.02 | ms/batch 11.15 | loss  5.97
INFO:root:| epoch   2 |   800/ 2250 batches | lr 0.02 | ms/batch 11.00 | loss  5.87
INFO:root:| epoch   2 |  1000/ 2250 batches | lr 0.02 | ms/batch  9.73 | loss  5.79
INFO:root:| epoch   2 |  1200/ 2250 batches | lr 0.02 | ms/batch 10.08 | loss  5.72
INFO:root:| epoch   2 |  1400/ 2250 batches | lr 0.02 | ms/batch 10.19 | loss  5.65
INFO:root:| epoch   2 |  1600/ 2250 batches | lr 0.02 | ms/batch 11.78 | loss  5.61
INFO:root:| epoch   2 |  1800/ 2250 batches | lr 0.02 | ms/batch  9.75 | loss  5.57
INFO:root:| epoch   2 |  2000/ 2250 batches | lr 0.02 | ms/batch 11.80 | loss  5.54
INFO:root:| epoch   2 |  2200/ 2250 batches | lr 0.02 | ms/batch  9.61 | loss  5.53
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   2 | time: 24.30s | valid loss  5.60 | valid ppl   271.27
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   3 |   200/ 2250 batches | lr 0.02 | ms/batch 11.92 | loss  5.51
INFO:root:| epoch   3 |   400/ 2250 batches | lr 0.02 | ms/batch  9.75 | loss  5.49
INFO:root:| epoch   3 |   600/ 2250 batches | lr 0.02 | ms/batch  9.82 | loss  5.48
INFO:root:| epoch   3 |   800/ 2250 batches | lr 0.02 | ms/batch  9.84 | loss  5.46
INFO:root:| epoch   3 |  1000/ 2250 batches | lr 0.02 | ms/batch  9.84 | loss  5.46
INFO:root:| epoch   3 |  1200/ 2250 batches | lr 0.02 | ms/batch 10.32 | loss  5.45
INFO:root:| epoch   3 |  1400/ 2250 batches | lr 0.02 | ms/batch 11.42 | loss  5.43
INFO:root:| epoch   3 |  1600/ 2250 batches | lr 0.02 | ms/batch  9.88 | loss  5.43
INFO:root:| epoch   3 |  1800/ 2250 batches | lr 0.02 | ms/batch 12.09 | loss  5.42
INFO:root:| epoch   3 |  2000/ 2250 batches | lr 0.02 | ms/batch  9.81 | loss  5.40
INFO:root:| epoch   3 |  2200/ 2250 batches | lr 0.02 | ms/batch  9.74 | loss  5.40
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   3 | time: 23.63s | valid loss  5.50 | valid ppl   244.26
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   4 |   200/ 2250 batches | lr 0.02 | ms/batch  9.92 | loss  5.40
INFO:root:| epoch   4 |   400/ 2250 batches | lr 0.02 | ms/batch  9.73 | loss  5.38
INFO:root:| epoch   4 |   600/ 2250 batches | lr 0.02 | ms/batch  9.80 | loss  5.38
INFO:root:| epoch   4 |   800/ 2250 batches | lr 0.02 | ms/batch  9.76 | loss  5.36
INFO:root:| epoch   4 |  1000/ 2250 batches | lr 0.02 | ms/batch 12.05 | loss  5.37
INFO:root:| epoch   4 |  1200/ 2250 batches | lr 0.02 | ms/batch  9.82 | loss  5.36
INFO:root:| epoch   4 |  1400/ 2250 batches | lr 0.02 | ms/batch 11.25 | loss  5.35
INFO:root:| epoch   4 |  1600/ 2250 batches | lr 0.02 | ms/batch 10.50 | loss  5.35
INFO:root:| epoch   4 |  1800/ 2250 batches | lr 0.02 | ms/batch 10.11 | loss  5.34
INFO:root:| epoch   4 |  2000/ 2250 batches | lr 0.02 | ms/batch 11.61 | loss  5.32
INFO:root:| epoch   4 |  2200/ 2250 batches | lr 0.02 | ms/batch  9.78 | loss  5.33
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   4 | time: 23.63s | valid loss  5.43 | valid ppl   229.16
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   5 |   200/ 2250 batches | lr 0.02 | ms/batch 10.67 | loss  5.33
INFO:root:| epoch   5 |   400/ 2250 batches | lr 0.02 | ms/batch 11.49 | loss  5.30
INFO:root:| epoch   5 |   600/ 2250 batches | lr 0.02 | ms/batch 10.25 | loss  5.30
INFO:root:| epoch   5 |   800/ 2250 batches | lr 0.02 | ms/batch 10.49 | loss  5.29
INFO:root:| epoch   5 |  1000/ 2250 batches | lr 0.02 | ms/batch 11.44 | loss  5.29
INFO:root:| epoch   5 |  1200/ 2250 batches | lr 0.02 | ms/batch  9.82 | loss  5.30
INFO:root:| epoch   5 |  1400/ 2250 batches | lr 0.02 | ms/batch 11.85 | loss  5.28
INFO:root:| epoch   5 |  1600/ 2250 batches | lr 0.02 | ms/batch  9.74 | loss  5.28
INFO:root:| epoch   5 |  1800/ 2250 batches | lr 0.02 | ms/batch  9.83 | loss  5.27
INFO:root:| epoch   5 |  2000/ 2250 batches | lr 0.02 | ms/batch  9.79 | loss  5.26
INFO:root:| epoch   5 |  2200/ 2250 batches | lr 0.02 | ms/batch 11.00 | loss  5.26
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   5 | time: 24.05s | valid loss  5.38 | valid ppl   216.63
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   6 |   200/ 2250 batches | lr 0.02 | ms/batch  9.88 | loss  5.26
INFO:root:| epoch   6 |   400/ 2250 batches | lr 0.02 | ms/batch 11.29 | loss  5.23
INFO:root:| epoch   6 |   600/ 2250 batches | lr 0.02 | ms/batch 10.62 | loss  5.23
INFO:root:| epoch   6 |   800/ 2250 batches | lr 0.02 | ms/batch 10.39 | loss  5.22
INFO:root:| epoch   6 |  1000/ 2250 batches | lr 0.02 | ms/batch 11.30 | loss  5.22
INFO:root:| epoch   6 |  1200/ 2250 batches | lr 0.02 | ms/batch  9.74 | loss  5.22
INFO:root:| epoch   6 |  1400/ 2250 batches | lr 0.02 | ms/batch 11.93 | loss  5.20
INFO:root:| epoch   6 |  1600/ 2250 batches | lr 0.02 | ms/batch  9.79 | loss  5.21
INFO:root:| epoch   6 |  1800/ 2250 batches | lr 0.02 | ms/batch  9.75 | loss  5.20
INFO:root:| epoch   6 |  2000/ 2250 batches | lr 0.02 | ms/batch  9.82 | loss  5.18
INFO:root:| epoch   6 |  2200/ 2250 batches | lr 0.02 | ms/batch 11.91 | loss  5.18
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   6 | time: 24.04s | valid loss  5.32 | valid ppl   203.97
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   7 |   200/ 2250 batches | lr 0.02 | ms/batch 10.28 | loss  5.18
INFO:root:| epoch   7 |   400/ 2250 batches | lr 0.02 | ms/batch 11.71 | loss  5.16
INFO:root:| epoch   7 |   600/ 2250 batches | lr 0.02 | ms/batch 10.07 | loss  5.15
INFO:root:| epoch   7 |   800/ 2250 batches | lr 0.02 | ms/batch 11.88 | loss  5.14
INFO:root:| epoch   7 |  1000/ 2250 batches | lr 0.02 | ms/batch  9.86 | loss  5.14
INFO:root:| epoch   7 |  1200/ 2250 batches | lr 0.02 | ms/batch 10.55 | loss  5.15
INFO:root:| epoch   7 |  1400/ 2250 batches | lr 0.02 | ms/batch  9.93 | loss  5.12
INFO:root:| epoch   7 |  1600/ 2250 batches | lr 0.02 | ms/batch 13.11 | loss  5.13
INFO:root:| epoch   7 |  1800/ 2250 batches | lr 0.02 | ms/batch  9.75 | loss  5.12
INFO:root:| epoch   7 |  2000/ 2250 batches | lr 0.02 | ms/batch 11.32 | loss  5.10
INFO:root:| epoch   7 |  2200/ 2250 batches | lr 0.02 | ms/batch 10.62 | loss  5.10
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   7 | time: 24.62s | valid loss  5.25 | valid ppl   191.11
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   8 |   200/ 2250 batches | lr 0.02 | ms/batch 12.15 | loss  5.10
INFO:root:| epoch   8 |   400/ 2250 batches | lr 0.02 | ms/batch 10.21 | loss  5.07
INFO:root:| epoch   8 |   600/ 2250 batches | lr 0.02 | ms/batch 10.79 | loss  5.07
INFO:root:| epoch   8 |   800/ 2250 batches | lr 0.02 | ms/batch 10.25 | loss  5.06
INFO:root:| epoch   8 |  1000/ 2250 batches | lr 0.02 | ms/batch 10.55 | loss  5.06
INFO:root:| epoch   8 |  1200/ 2250 batches | lr 0.02 | ms/batch 10.01 | loss  5.06
INFO:root:| epoch   8 |  1400/ 2250 batches | lr 0.02 | ms/batch  9.79 | loss  5.04
INFO:root:| epoch   8 |  1600/ 2250 batches | lr 0.02 | ms/batch 12.09 | loss  5.05
INFO:root:| epoch   8 |  1800/ 2250 batches | lr 0.02 | ms/batch  9.90 | loss  5.03
INFO:root:| epoch   8 |  2000/ 2250 batches | lr 0.02 | ms/batch 11.34 | loss  5.01
INFO:root:| epoch   8 |  2200/ 2250 batches | lr 0.02 | ms/batch 10.44 | loss  5.01
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   8 | time: 24.35s | valid loss  5.19 | valid ppl   178.68
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   9 |   200/ 2250 batches | lr 0.02 | ms/batch  9.92 | loss  5.01
INFO:root:| epoch   9 |   400/ 2250 batches | lr 0.02 | ms/batch  9.86 | loss  4.98
INFO:root:| epoch   9 |   600/ 2250 batches | lr 0.02 | ms/batch  9.84 | loss  4.98
INFO:root:| epoch   9 |   800/ 2250 batches | lr 0.02 | ms/batch  9.78 | loss  4.97
INFO:root:| epoch   9 |  1000/ 2250 batches | lr 0.02 | ms/batch  9.55 | loss  4.97
INFO:root:| epoch   9 |  1200/ 2250 batches | lr 0.02 | ms/batch  9.62 | loss  4.98
INFO:root:| epoch   9 |  1400/ 2250 batches | lr 0.02 | ms/batch 11.93 | loss  4.95
INFO:root:| epoch   9 |  1600/ 2250 batches | lr 0.02 | ms/batch  9.81 | loss  4.96
INFO:root:| epoch   9 |  1800/ 2250 batches | lr 0.02 | ms/batch 11.46 | loss  4.95
INFO:root:| epoch   9 |  2000/ 2250 batches | lr 0.02 | ms/batch 10.24 | loss  4.93
INFO:root:| epoch   9 |  2200/ 2250 batches | lr 0.02 | ms/batch 10.40 | loss  4.92
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   9 | time: 23.34s | valid loss  5.12 | valid ppl   167.57
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  10 |   200/ 2250 batches | lr 0.02 | ms/batch  9.97 | loss  4.93
INFO:root:| epoch  10 |   400/ 2250 batches | lr 0.02 | ms/batch 12.73 | loss  4.90
INFO:root:| epoch  10 |   600/ 2250 batches | lr 0.02 | ms/batch 12.40 | loss  4.90
INFO:root:| epoch  10 |   800/ 2250 batches | lr 0.02 | ms/batch 12.80 | loss  4.89
INFO:root:| epoch  10 |  1000/ 2250 batches | lr 0.02 | ms/batch 17.87 | loss  4.89
INFO:root:| epoch  10 |  1200/ 2250 batches | lr 0.02 | ms/batch 26.64 | loss  4.91
INFO:root:| epoch  10 |  1400/ 2250 batches | lr 0.02 | ms/batch 16.65 | loss  4.88
INFO:root:| epoch  10 |  1600/ 2250 batches | lr 0.02 | ms/batch 13.32 | loss  4.89
INFO:root:| epoch  10 |  1800/ 2250 batches | lr 0.02 | ms/batch 13.09 | loss  4.87
INFO:root:| epoch  10 |  2000/ 2250 batches | lr 0.02 | ms/batch 12.76 | loss  4.85
INFO:root:| epoch  10 |  2200/ 2250 batches | lr 0.02 | ms/batch 15.02 | loss  4.85
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  10 | time: 33.53s | valid loss  5.07 | valid ppl   158.52
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:=========================================================================================
INFO:root:| End of training | test loss  5.25 | test ppl   190.07
INFO:root:=========================================================================================
INFO:root:----------- new value of n = 4, k = 1 -----------
INFO:root:Loading data
INFO:root:Vocab size 2005
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:| epoch   1 |   200/ 1710 batches | lr 0.02 | ms/batch 11.87 | loss  7.52
INFO:root:| epoch   1 |   400/ 1710 batches | lr 0.02 | ms/batch  9.10 | loss  7.24
INFO:root:| epoch   1 |   600/ 1710 batches | lr 0.02 | ms/batch 17.13 | loss  6.97
INFO:root:| epoch   1 |   800/ 1710 batches | lr 0.02 | ms/batch 13.01 | loss  6.65
INFO:root:| epoch   1 |  1000/ 1710 batches | lr 0.02 | ms/batch 12.62 | loss  6.26
INFO:root:| epoch   1 |  1200/ 1710 batches | lr 0.02 | ms/batch 10.57 | loss  5.80
INFO:root:| epoch   1 |  1400/ 1710 batches | lr 0.02 | ms/batch 11.24 | loss  5.37
INFO:root:| epoch   1 |  1600/ 1710 batches | lr 0.02 | ms/batch  8.20 | loss  5.02
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   1 | time: 19.84s | valid loss  4.95 | valid ppl   141.54
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   2 |   200/ 1710 batches | lr 0.02 | ms/batch 11.78 | loss  4.77
INFO:root:| epoch   2 |   400/ 1710 batches | lr 0.02 | ms/batch 13.31 | loss  4.60
INFO:root:| epoch   2 |   600/ 1710 batches | lr 0.02 | ms/batch 22.73 | loss  4.44
INFO:root:| epoch   2 |   800/ 1710 batches | lr 0.02 | ms/batch 12.50 | loss  4.33
INFO:root:| epoch   2 |  1000/ 1710 batches | lr 0.02 | ms/batch 10.78 | loss  4.21
INFO:root:| epoch   2 |  1200/ 1710 batches | lr 0.02 | ms/batch 11.29 | loss  4.16
INFO:root:| epoch   2 |  1400/ 1710 batches | lr 0.02 | ms/batch 13.70 | loss  4.13
INFO:root:| epoch   2 |  1600/ 1710 batches | lr 0.02 | ms/batch 12.24 | loss  4.06
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   2 | time: 23.49s | valid loss  4.23 | valid ppl    68.79
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   3 |   200/ 1710 batches | lr 0.02 | ms/batch 12.63 | loss  4.08
INFO:root:| epoch   3 |   400/ 1710 batches | lr 0.02 | ms/batch 10.58 | loss  4.06
INFO:root:| epoch   3 |   600/ 1710 batches | lr 0.02 | ms/batch 11.13 | loss  4.02
INFO:root:| epoch   3 |   800/ 1710 batches | lr 0.02 | ms/batch 12.50 | loss  4.03
INFO:root:| epoch   3 |  1000/ 1710 batches | lr 0.02 | ms/batch 12.45 | loss  3.99
INFO:root:| epoch   3 |  1200/ 1710 batches | lr 0.02 | ms/batch 13.62 | loss  4.02
INFO:root:| epoch   3 |  1400/ 1710 batches | lr 0.02 | ms/batch 13.63 | loss  4.02
INFO:root:| epoch   3 |  1600/ 1710 batches | lr 0.02 | ms/batch 10.86 | loss  3.99
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   3 | time: 20.82s | valid loss  4.17 | valid ppl    64.61
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   4 |   200/ 1710 batches | lr 0.02 | ms/batch 10.83 | loss  4.03
INFO:root:| epoch   4 |   400/ 1710 batches | lr 0.02 | ms/batch 11.06 | loss  4.01
INFO:root:| epoch   4 |   600/ 1710 batches | lr 0.02 | ms/batch 10.61 | loss  3.99
INFO:root:| epoch   4 |   800/ 1710 batches | lr 0.02 | ms/batch 11.73 | loss  4.00
INFO:root:| epoch   4 |  1000/ 1710 batches | lr 0.02 | ms/batch 14.59 | loss  3.97
INFO:root:| epoch   4 |  1200/ 1710 batches | lr 0.02 | ms/batch 10.36 | loss  3.99
INFO:root:| epoch   4 |  1400/ 1710 batches | lr 0.02 | ms/batch 11.87 | loss  4.00
INFO:root:| epoch   4 |  1600/ 1710 batches | lr 0.02 | ms/batch  8.66 | loss  3.97
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   4 | time: 19.32s | valid loss  4.16 | valid ppl    63.79
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   5 |   200/ 1710 batches | lr 0.02 | ms/batch 11.72 | loss  4.01
INFO:root:| epoch   5 |   400/ 1710 batches | lr 0.02 | ms/batch  9.94 | loss  4.00
INFO:root:| epoch   5 |   600/ 1710 batches | lr 0.02 | ms/batch 10.94 | loss  3.97
INFO:root:| epoch   5 |   800/ 1710 batches | lr 0.02 | ms/batch  9.23 | loss  3.99
INFO:root:| epoch   5 |  1000/ 1710 batches | lr 0.02 | ms/batch  8.81 | loss  3.95
INFO:root:| epoch   5 |  1200/ 1710 batches | lr 0.02 | ms/batch 10.98 | loss  3.98
INFO:root:| epoch   5 |  1400/ 1710 batches | lr 0.02 | ms/batch 13.05 | loss  3.99
INFO:root:| epoch   5 |  1600/ 1710 batches | lr 0.02 | ms/batch 14.44 | loss  3.96
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   5 | time: 19.39s | valid loss  4.15 | valid ppl    63.44
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   6 |   200/ 1710 batches | lr 0.02 | ms/batch 15.24 | loss  4.00
INFO:root:| epoch   6 |   400/ 1710 batches | lr 0.02 | ms/batch 12.23 | loss  3.99
INFO:root:| epoch   6 |   600/ 1710 batches | lr 0.02 | ms/batch 12.35 | loss  3.96
INFO:root:| epoch   6 |   800/ 1710 batches | lr 0.02 | ms/batch 11.57 | loss  3.98
INFO:root:| epoch   6 |  1000/ 1710 batches | lr 0.02 | ms/batch  9.66 | loss  3.94
INFO:root:| epoch   6 |  1200/ 1710 batches | lr 0.02 | ms/batch  8.53 | loss  3.97
INFO:root:| epoch   6 |  1400/ 1710 batches | lr 0.02 | ms/batch  8.68 | loss  3.98
INFO:root:| epoch   6 |  1600/ 1710 batches | lr 0.02 | ms/batch 10.79 | loss  3.95
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   6 | time: 18.91s | valid loss  4.15 | valid ppl    63.15
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   7 |   200/ 1710 batches | lr 0.02 | ms/batch  9.42 | loss  3.99
INFO:root:| epoch   7 |   400/ 1710 batches | lr 0.02 | ms/batch 10.67 | loss  3.98
INFO:root:| epoch   7 |   600/ 1710 batches | lr 0.02 | ms/batch  8.52 | loss  3.95
INFO:root:| epoch   7 |   800/ 1710 batches | lr 0.02 | ms/batch  8.31 | loss  3.97
INFO:root:| epoch   7 |  1000/ 1710 batches | lr 0.02 | ms/batch  9.74 | loss  3.93
INFO:root:| epoch   7 |  1200/ 1710 batches | lr 0.02 | ms/batch  9.36 | loss  3.96
INFO:root:| epoch   7 |  1400/ 1710 batches | lr 0.02 | ms/batch  8.40 | loss  3.96
INFO:root:| epoch   7 |  1600/ 1710 batches | lr 0.02 | ms/batch 10.81 | loss  3.94
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   7 | time: 16.16s | valid loss  4.14 | valid ppl    62.86
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   8 |   200/ 1710 batches | lr 0.02 | ms/batch  9.07 | loss  3.98
INFO:root:| epoch   8 |   400/ 1710 batches | lr 0.02 | ms/batch 10.89 | loss  3.97
INFO:root:| epoch   8 |   600/ 1710 batches | lr 0.02 | ms/batch  8.44 | loss  3.94
INFO:root:| epoch   8 |   800/ 1710 batches | lr 0.02 | ms/batch  9.67 | loss  3.96
INFO:root:| epoch   8 |  1000/ 1710 batches | lr 0.02 | ms/batch 10.53 | loss  3.92
INFO:root:| epoch   8 |  1200/ 1710 batches | lr 0.02 | ms/batch  8.60 | loss  3.95
INFO:root:| epoch   8 |  1400/ 1710 batches | lr 0.02 | ms/batch 10.33 | loss  3.95
INFO:root:| epoch   8 |  1600/ 1710 batches | lr 0.02 | ms/batch  9.01 | loss  3.92
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   8 | time: 16.41s | valid loss  4.14 | valid ppl    62.56
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   9 |   200/ 1710 batches | lr 0.02 | ms/batch  8.99 | loss  3.97
INFO:root:| epoch   9 |   400/ 1710 batches | lr 0.02 | ms/batch  8.71 | loss  3.96
INFO:root:| epoch   9 |   600/ 1710 batches | lr 0.02 | ms/batch  9.41 | loss  3.93
INFO:root:| epoch   9 |   800/ 1710 batches | lr 0.02 | ms/batch 10.13 | loss  3.94
INFO:root:| epoch   9 |  1000/ 1710 batches | lr 0.02 | ms/batch  8.42 | loss  3.91
INFO:root:| epoch   9 |  1200/ 1710 batches | lr 0.02 | ms/batch 10.61 | loss  3.94
INFO:root:| epoch   9 |  1400/ 1710 batches | lr 0.02 | ms/batch  9.00 | loss  3.94
INFO:root:| epoch   9 |  1600/ 1710 batches | lr 0.02 | ms/batch  8.77 | loss  3.91
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   9 | time: 15.91s | valid loss  4.13 | valid ppl    62.24
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  10 |   200/ 1710 batches | lr 0.02 | ms/batch  9.12 | loss  3.95
INFO:root:| epoch  10 |   400/ 1710 batches | lr 0.02 | ms/batch  8.41 | loss  3.95
INFO:root:| epoch  10 |   600/ 1710 batches | lr 0.02 | ms/batch  8.64 | loss  3.92
INFO:root:| epoch  10 |   800/ 1710 batches | lr 0.02 | ms/batch  8.48 | loss  3.93
INFO:root:| epoch  10 |  1000/ 1710 batches | lr 0.02 | ms/batch  8.46 | loss  3.89
INFO:root:| epoch  10 |  1200/ 1710 batches | lr 0.02 | ms/batch 10.48 | loss  3.92
INFO:root:| epoch  10 |  1400/ 1710 batches | lr 0.02 | ms/batch  9.44 | loss  3.93
INFO:root:| epoch  10 |  1600/ 1710 batches | lr 0.02 | ms/batch  8.69 | loss  3.90
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  10 | time: 15.86s | valid loss  4.12 | valid ppl    61.86
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:=========================================================================================
INFO:root:| End of training | test loss  4.28 | test ppl    72.39
INFO:root:=========================================================================================
INFO:root:----------- new value of n = 4, k = 2 -----------
INFO:root:Loading data
INFO:root:Vocab size 3005
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:| epoch   1 |   200/ 1890 batches | lr 0.02 | ms/batch  9.62 | loss  7.95
INFO:root:| epoch   1 |   400/ 1890 batches | lr 0.02 | ms/batch  9.16 | loss  7.71
INFO:root:| epoch   1 |   600/ 1890 batches | lr 0.02 | ms/batch  9.30 | loss  7.49
INFO:root:| epoch   1 |   800/ 1890 batches | lr 0.02 | ms/batch  9.16 | loss  7.24
INFO:root:| epoch   1 |  1000/ 1890 batches | lr 0.02 | ms/batch  9.03 | loss  6.94
INFO:root:| epoch   1 |  1200/ 1890 batches | lr 0.02 | ms/batch  8.99 | loss  6.57
INFO:root:| epoch   1 |  1400/ 1890 batches | lr 0.02 | ms/batch  9.08 | loss  6.16
INFO:root:| epoch   1 |  1600/ 1890 batches | lr 0.02 | ms/batch 11.13 | loss  5.80
INFO:root:| epoch   1 |  1800/ 1890 batches | lr 0.02 | ms/batch  9.98 | loss  5.55
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   1 | time: 18.16s | valid loss  5.41 | valid ppl   224.55
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   2 |   200/ 1890 batches | lr 0.02 | ms/batch 13.21 | loss  5.32
INFO:root:| epoch   2 |   400/ 1890 batches | lr 0.02 | ms/batch 13.25 | loss  5.12
INFO:root:| epoch   2 |   600/ 1890 batches | lr 0.02 | ms/batch 18.28 | loss  5.01
INFO:root:| epoch   2 |   800/ 1890 batches | lr 0.02 | ms/batch 10.22 | loss  4.91
INFO:root:| epoch   2 |  1000/ 1890 batches | lr 0.02 | ms/batch 11.46 | loss  4.82
INFO:root:| epoch   2 |  1200/ 1890 batches | lr 0.02 | ms/batch 10.99 | loss  4.73
INFO:root:| epoch   2 |  1400/ 1890 batches | lr 0.02 | ms/batch 14.14 | loss  4.67
INFO:root:| epoch   2 |  1600/ 1890 batches | lr 0.02 | ms/batch  9.48 | loss  4.68
INFO:root:| epoch   2 |  1800/ 1890 batches | lr 0.02 | ms/batch 11.83 | loss  4.68
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   2 | time: 23.61s | valid loss  4.75 | valid ppl   115.59
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   3 |   200/ 1890 batches | lr 0.02 | ms/batch  9.61 | loss  4.66
INFO:root:| epoch   3 |   400/ 1890 batches | lr 0.02 | ms/batch 11.62 | loss  4.59
INFO:root:| epoch   3 |   600/ 1890 batches | lr 0.02 | ms/batch  9.55 | loss  4.59
INFO:root:| epoch   3 |   800/ 1890 batches | lr 0.02 | ms/batch 11.90 | loss  4.60
INFO:root:| epoch   3 |  1000/ 1890 batches | lr 0.02 | ms/batch  9.49 | loss  4.59
INFO:root:| epoch   3 |  1200/ 1890 batches | lr 0.02 | ms/batch  9.12 | loss  4.57
INFO:root:| epoch   3 |  1400/ 1890 batches | lr 0.02 | ms/batch 11.80 | loss  4.54
INFO:root:| epoch   3 |  1600/ 1890 batches | lr 0.02 | ms/batch  9.48 | loss  4.59
INFO:root:| epoch   3 |  1800/ 1890 batches | lr 0.02 | ms/batch 11.53 | loss  4.59
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   3 | time: 19.95s | valid loss  4.69 | valid ppl   108.41
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   4 |   200/ 1890 batches | lr 0.02 | ms/batch  9.74 | loss  4.59
INFO:root:| epoch   4 |   400/ 1890 batches | lr 0.02 | ms/batch 11.51 | loss  4.53
INFO:root:| epoch   4 |   600/ 1890 batches | lr 0.02 | ms/batch 10.48 | loss  4.53
INFO:root:| epoch   4 |   800/ 1890 batches | lr 0.02 | ms/batch  9.91 | loss  4.56
INFO:root:| epoch   4 |  1000/ 1890 batches | lr 0.02 | ms/batch  9.21 | loss  4.54
INFO:root:| epoch   4 |  1200/ 1890 batches | lr 0.02 | ms/batch  9.90 | loss  4.53
INFO:root:| epoch   4 |  1400/ 1890 batches | lr 0.02 | ms/batch 11.12 | loss  4.51
INFO:root:| epoch   4 |  1600/ 1890 batches | lr 0.02 | ms/batch  9.49 | loss  4.56
INFO:root:| epoch   4 |  1800/ 1890 batches | lr 0.02 | ms/batch 12.65 | loss  4.56
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   4 | time: 19.88s | valid loss  4.66 | valid ppl   106.15
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   5 |   200/ 1890 batches | lr 0.02 | ms/batch 10.88 | loss  4.56
INFO:root:| epoch   5 |   400/ 1890 batches | lr 0.02 | ms/batch 11.08 | loss  4.51
INFO:root:| epoch   5 |   600/ 1890 batches | lr 0.02 | ms/batch  9.51 | loss  4.51
INFO:root:| epoch   5 |   800/ 1890 batches | lr 0.02 | ms/batch  9.47 | loss  4.53
INFO:root:| epoch   5 |  1000/ 1890 batches | lr 0.02 | ms/batch  9.18 | loss  4.52
INFO:root:| epoch   5 |  1200/ 1890 batches | lr 0.02 | ms/batch  9.16 | loss  4.51
INFO:root:| epoch   5 |  1400/ 1890 batches | lr 0.02 | ms/batch  9.28 | loss  4.48
INFO:root:| epoch   5 |  1600/ 1890 batches | lr 0.02 | ms/batch 12.22 | loss  4.53
INFO:root:| epoch   5 |  1800/ 1890 batches | lr 0.02 | ms/batch  9.75 | loss  4.54
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   5 | time: 19.80s | valid loss  4.65 | valid ppl   104.51
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   6 |   200/ 1890 batches | lr 0.02 | ms/batch 10.65 | loss  4.54
INFO:root:| epoch   6 |   400/ 1890 batches | lr 0.02 | ms/batch  9.75 | loss  4.48
INFO:root:| epoch   6 |   600/ 1890 batches | lr 0.02 | ms/batch 11.55 | loss  4.48
INFO:root:| epoch   6 |   800/ 1890 batches | lr 0.02 | ms/batch  9.52 | loss  4.51
INFO:root:| epoch   6 |  1000/ 1890 batches | lr 0.02 | ms/batch  9.45 | loss  4.49
INFO:root:| epoch   6 |  1200/ 1890 batches | lr 0.02 | ms/batch  9.22 | loss  4.49
INFO:root:| epoch   6 |  1400/ 1890 batches | lr 0.02 | ms/batch  9.19 | loss  4.46
INFO:root:| epoch   6 |  1600/ 1890 batches | lr 0.02 | ms/batch 11.36 | loss  4.51
INFO:root:| epoch   6 |  1800/ 1890 batches | lr 0.02 | ms/batch 10.21 | loss  4.51
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   6 | time: 19.26s | valid loss  4.63 | valid ppl   102.93
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   7 |   200/ 1890 batches | lr 0.02 | ms/batch 12.23 | loss  4.52
INFO:root:| epoch   7 |   400/ 1890 batches | lr 0.02 | ms/batch  9.43 | loss  4.46
INFO:root:| epoch   7 |   600/ 1890 batches | lr 0.02 | ms/batch 10.90 | loss  4.46
INFO:root:| epoch   7 |   800/ 1890 batches | lr 0.02 | ms/batch 10.43 | loss  4.48
INFO:root:| epoch   7 |  1000/ 1890 batches | lr 0.02 | ms/batch  9.54 | loss  4.47
INFO:root:| epoch   7 |  1200/ 1890 batches | lr 0.02 | ms/batch  9.17 | loss  4.46
INFO:root:| epoch   7 |  1400/ 1890 batches | lr 0.02 | ms/batch  9.70 | loss  4.44
INFO:root:| epoch   7 |  1600/ 1890 batches | lr 0.02 | ms/batch 10.46 | loss  4.48
INFO:root:| epoch   7 |  1800/ 1890 batches | lr 0.02 | ms/batch 11.86 | loss  4.48
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   7 | time: 19.86s | valid loss  4.62 | valid ppl   101.32
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   8 |   200/ 1890 batches | lr 0.02 | ms/batch 12.04 | loss  4.49
INFO:root:| epoch   8 |   400/ 1890 batches | lr 0.02 | ms/batch  9.82 | loss  4.43
INFO:root:| epoch   8 |   600/ 1890 batches | lr 0.02 | ms/batch 10.16 | loss  4.44
INFO:root:| epoch   8 |   800/ 1890 batches | lr 0.02 | ms/batch 11.21 | loss  4.45
INFO:root:| epoch   8 |  1000/ 1890 batches | lr 0.02 | ms/batch  9.45 | loss  4.44
INFO:root:| epoch   8 |  1200/ 1890 batches | lr 0.02 | ms/batch  9.47 | loss  4.44
INFO:root:| epoch   8 |  1400/ 1890 batches | lr 0.02 | ms/batch  9.50 | loss  4.41
INFO:root:| epoch   8 |  1600/ 1890 batches | lr 0.02 | ms/batch  9.15 | loss  4.46
INFO:root:| epoch   8 |  1800/ 1890 batches | lr 0.02 | ms/batch 11.74 | loss  4.46
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   8 | time: 19.60s | valid loss  4.60 | valid ppl    99.65
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   9 |   200/ 1890 batches | lr 0.02 | ms/batch  9.84 | loss  4.46
INFO:root:| epoch   9 |   400/ 1890 batches | lr 0.02 | ms/batch 11.81 | loss  4.40
INFO:root:| epoch   9 |   600/ 1890 batches | lr 0.02 | ms/batch  9.52 | loss  4.41
INFO:root:| epoch   9 |   800/ 1890 batches | lr 0.02 | ms/batch 11.58 | loss  4.42
INFO:root:| epoch   9 |  1000/ 1890 batches | lr 0.02 | ms/batch  9.99 | loss  4.41
INFO:root:| epoch   9 |  1200/ 1890 batches | lr 0.02 | ms/batch  9.43 | loss  4.41
INFO:root:| epoch   9 |  1400/ 1890 batches | lr 0.02 | ms/batch  9.45 | loss  4.38
INFO:root:| epoch   9 |  1600/ 1890 batches | lr 0.02 | ms/batch  9.37 | loss  4.43
INFO:root:| epoch   9 |  1800/ 1890 batches | lr 0.02 | ms/batch 10.99 | loss  4.43
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   9 | time: 19.64s | valid loss  4.58 | valid ppl    97.89
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  10 |   200/ 1890 batches | lr 0.02 | ms/batch  9.88 | loss  4.43
INFO:root:| epoch  10 |   400/ 1890 batches | lr 0.02 | ms/batch 11.88 | loss  4.37
INFO:root:| epoch  10 |   600/ 1890 batches | lr 0.02 | ms/batch  9.94 | loss  4.38
INFO:root:| epoch  10 |   800/ 1890 batches | lr 0.02 | ms/batch 10.95 | loss  4.39
INFO:root:| epoch  10 |  1000/ 1890 batches | lr 0.02 | ms/batch 10.74 | loss  4.38
INFO:root:| epoch  10 |  1200/ 1890 batches | lr 0.02 | ms/batch  9.50 | loss  4.38
INFO:root:| epoch  10 |  1400/ 1890 batches | lr 0.02 | ms/batch  9.37 | loss  4.35
INFO:root:| epoch  10 |  1600/ 1890 batches | lr 0.02 | ms/batch 11.81 | loss  4.39
INFO:root:| epoch  10 |  1800/ 1890 batches | lr 0.02 | ms/batch 10.19 | loss  4.39
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  10 | time: 20.14s | valid loss  4.56 | valid ppl    95.99
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:=========================================================================================
INFO:root:| End of training | test loss  4.74 | test ppl   114.48
INFO:root:=========================================================================================
INFO:root:----------- new value of n = 4, k = 3 -----------
INFO:root:Loading data
INFO:root:Vocab size 4005
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:| epoch   1 |   200/ 2070 batches | lr 0.02 | ms/batch 12.38 | loss  8.26
INFO:root:| epoch   1 |   400/ 2070 batches | lr 0.02 | ms/batch 12.48 | loss  8.08
INFO:root:| epoch   1 |   600/ 2070 batches | lr 0.02 | ms/batch 11.46 | loss  7.92
INFO:root:| epoch   1 |   800/ 2070 batches | lr 0.02 | ms/batch 11.93 | loss  7.74
INFO:root:| epoch   1 |  1000/ 2070 batches | lr 0.02 | ms/batch 11.56 | loss  7.55
INFO:root:| epoch   1 |  1200/ 2070 batches | lr 0.02 | ms/batch 10.27 | loss  7.28
INFO:root:| epoch   1 |  1400/ 2070 batches | lr 0.02 | ms/batch 10.04 | loss  7.02
INFO:root:| epoch   1 |  1600/ 2070 batches | lr 0.02 | ms/batch 11.94 | loss  6.69
INFO:root:| epoch   1 |  1800/ 2070 batches | lr 0.02 | ms/batch 10.96 | loss  6.34
INFO:root:| epoch   1 |  2000/ 2070 batches | lr 0.02 | ms/batch 11.42 | loss  6.06
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   1 | time: 24.11s | valid loss  5.97 | valid ppl   391.81
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   2 |   200/ 2070 batches | lr 0.02 | ms/batch 10.87 | loss  5.72
INFO:root:| epoch   2 |   400/ 2070 batches | lr 0.02 | ms/batch 12.55 | loss  5.65
INFO:root:| epoch   2 |   600/ 2070 batches | lr 0.02 | ms/batch 10.02 | loss  5.51
INFO:root:| epoch   2 |   800/ 2070 batches | lr 0.02 | ms/batch  9.93 | loss  5.36
INFO:root:| epoch   2 |  1000/ 2070 batches | lr 0.02 | ms/batch  9.93 | loss  5.37
INFO:root:| epoch   2 |  1200/ 2070 batches | lr 0.02 | ms/batch  9.89 | loss  5.21
INFO:root:| epoch   2 |  1400/ 2070 batches | lr 0.02 | ms/batch 12.52 | loss  5.25
INFO:root:| epoch   2 |  1600/ 2070 batches | lr 0.02 | ms/batch  9.88 | loss  5.19
INFO:root:| epoch   2 |  1800/ 2070 batches | lr 0.02 | ms/batch 11.51 | loss  5.14
INFO:root:| epoch   2 |  2000/ 2070 batches | lr 0.02 | ms/batch 10.71 | loss  5.18
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   2 | time: 22.50s | valid loss  5.30 | valid ppl   199.85
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   3 |   200/ 2070 batches | lr 0.02 | ms/batch 13.14 | loss  5.06
INFO:root:| epoch   3 |   400/ 2070 batches | lr 0.02 | ms/batch 10.20 | loss  5.18
INFO:root:| epoch   3 |   600/ 2070 batches | lr 0.02 | ms/batch  9.89 | loss  5.13
INFO:root:| epoch   3 |   800/ 2070 batches | lr 0.02 | ms/batch 10.07 | loss  5.05
INFO:root:| epoch   3 |  1000/ 2070 batches | lr 0.02 | ms/batch 10.02 | loss  5.14
INFO:root:| epoch   3 |  1200/ 2070 batches | lr 0.02 | ms/batch 12.98 | loss  5.03
INFO:root:| epoch   3 |  1400/ 2070 batches | lr 0.02 | ms/batch 10.03 | loss  5.09
INFO:root:| epoch   3 |  1600/ 2070 batches | lr 0.02 | ms/batch 12.25 | loss  5.06
INFO:root:| epoch   3 |  1800/ 2070 batches | lr 0.02 | ms/batch  9.95 | loss  5.03
INFO:root:| epoch   3 |  2000/ 2070 batches | lr 0.02 | ms/batch 11.41 | loss  5.06
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   3 | time: 23.26s | valid loss  5.21 | valid ppl   182.60
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   4 |   200/ 2070 batches | lr 0.02 | ms/batch 10.73 | loss  4.96
INFO:root:| epoch   4 |   400/ 2070 batches | lr 0.02 | ms/batch  9.98 | loss  5.08
INFO:root:| epoch   4 |   600/ 2070 batches | lr 0.02 | ms/batch  9.95 | loss  5.04
INFO:root:| epoch   4 |   800/ 2070 batches | lr 0.02 | ms/batch 10.26 | loss  4.96
INFO:root:| epoch   4 |  1000/ 2070 batches | lr 0.02 | ms/batch 12.16 | loss  5.06
INFO:root:| epoch   4 |  1200/ 2070 batches | lr 0.02 | ms/batch  9.95 | loss  4.95
INFO:root:| epoch   4 |  1400/ 2070 batches | lr 0.02 | ms/batch 12.43 | loss  5.02
INFO:root:| epoch   4 |  1600/ 2070 batches | lr 0.02 | ms/batch  9.89 | loss  4.99
INFO:root:| epoch   4 |  1800/ 2070 batches | lr 0.02 | ms/batch 14.35 | loss  4.97
INFO:root:| epoch   4 |  2000/ 2070 batches | lr 0.02 | ms/batch 11.01 | loss  5.00
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   4 | time: 23.11s | valid loss  5.16 | valid ppl   174.38
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   5 |   200/ 2070 batches | lr 0.02 | ms/batch 10.26 | loss  4.91
INFO:root:| epoch   5 |   400/ 2070 batches | lr 0.02 | ms/batch  9.99 | loss  5.03
INFO:root:| epoch   5 |   600/ 2070 batches | lr 0.02 | ms/batch 12.52 | loss  4.99
INFO:root:| epoch   5 |   800/ 2070 batches | lr 0.02 | ms/batch 10.04 | loss  4.91
INFO:root:| epoch   5 |  1000/ 2070 batches | lr 0.02 | ms/batch 11.87 | loss  5.01
INFO:root:| epoch   5 |  1200/ 2070 batches | lr 0.02 | ms/batch 10.69 | loss  4.90
INFO:root:| epoch   5 |  1400/ 2070 batches | lr 0.02 | ms/batch 11.16 | loss  4.97
INFO:root:| epoch   5 |  1600/ 2070 batches | lr 0.02 | ms/batch 11.79 | loss  4.94
INFO:root:| epoch   5 |  1800/ 2070 batches | lr 0.02 | ms/batch  9.91 | loss  4.92
INFO:root:| epoch   5 |  2000/ 2070 batches | lr 0.02 | ms/batch 10.28 | loss  4.96
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   5 | time: 23.05s | valid loss  5.13 | valid ppl   168.96
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   6 |   200/ 2070 batches | lr 0.02 | ms/batch 11.93 | loss  4.86
INFO:root:| epoch   6 |   400/ 2070 batches | lr 0.02 | ms/batch 12.25 | loss  4.98
INFO:root:| epoch   6 |   600/ 2070 batches | lr 0.02 | ms/batch 11.49 | loss  4.95
INFO:root:| epoch   6 |   800/ 2070 batches | lr 0.02 | ms/batch 11.36 | loss  4.87
INFO:root:| epoch   6 |  1000/ 2070 batches | lr 0.02 | ms/batch 10.97 | loss  4.97
INFO:root:| epoch   6 |  1200/ 2070 batches | lr 0.02 | ms/batch 10.84 | loss  4.86
INFO:root:| epoch   6 |  1400/ 2070 batches | lr 0.02 | ms/batch 11.93 | loss  4.93
INFO:root:| epoch   6 |  1600/ 2070 batches | lr 0.02 | ms/batch 10.18 | loss  4.90
INFO:root:| epoch   6 |  1800/ 2070 batches | lr 0.02 | ms/batch 10.05 | loss  4.88
INFO:root:| epoch   6 |  2000/ 2070 batches | lr 0.02 | ms/batch 10.02 | loss  4.91
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   6 | time: 23.16s | valid loss  5.10 | valid ppl   163.79
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   7 |   200/ 2070 batches | lr 0.02 | ms/batch 12.96 | loss  4.82
INFO:root:| epoch   7 |   400/ 2070 batches | lr 0.02 | ms/batch 10.57 | loss  4.94
INFO:root:| epoch   7 |   600/ 2070 batches | lr 0.02 | ms/batch 12.43 | loss  4.91
INFO:root:| epoch   7 |   800/ 2070 batches | lr 0.02 | ms/batch 10.06 | loss  4.82
INFO:root:| epoch   7 |  1000/ 2070 batches | lr 0.02 | ms/batch 11.82 | loss  4.92
INFO:root:| epoch   7 |  1200/ 2070 batches | lr 0.02 | ms/batch 10.98 | loss  4.81
INFO:root:| epoch   7 |  1400/ 2070 batches | lr 0.02 | ms/batch 10.01 | loss  4.88
INFO:root:| epoch   7 |  1600/ 2070 batches | lr 0.02 | ms/batch  9.92 | loss  4.85
INFO:root:| epoch   7 |  1800/ 2070 batches | lr 0.02 | ms/batch 10.10 | loss  4.83
INFO:root:| epoch   7 |  2000/ 2070 batches | lr 0.02 | ms/batch 12.21 | loss  4.86
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   7 | time: 23.35s | valid loss  5.07 | valid ppl   158.57
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   8 |   200/ 2070 batches | lr 0.02 | ms/batch 10.59 | loss  4.77
INFO:root:| epoch   8 |   400/ 2070 batches | lr 0.02 | ms/batch 12.60 | loss  4.89
INFO:root:| epoch   8 |   600/ 2070 batches | lr 0.02 | ms/batch 10.03 | loss  4.86
INFO:root:| epoch   8 |   800/ 2070 batches | lr 0.02 | ms/batch 12.73 | loss  4.77
INFO:root:| epoch   8 |  1000/ 2070 batches | lr 0.02 | ms/batch 10.26 | loss  4.87
INFO:root:| epoch   8 |  1200/ 2070 batches | lr 0.02 | ms/batch 10.41 | loss  4.77
INFO:root:| epoch   8 |  1400/ 2070 batches | lr 0.02 | ms/batch 11.44 | loss  4.83
INFO:root:| epoch   8 |  1600/ 2070 batches | lr 0.02 | ms/batch 10.22 | loss  4.80
INFO:root:| epoch   8 |  1800/ 2070 batches | lr 0.02 | ms/batch 12.79 | loss  4.78
INFO:root:| epoch   8 |  2000/ 2070 batches | lr 0.02 | ms/batch 10.17 | loss  4.81
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   8 | time: 23.40s | valid loss  5.03 | valid ppl   153.33
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   9 |   200/ 2070 batches | lr 0.02 | ms/batch 12.59 | loss  4.72
INFO:root:| epoch   9 |   400/ 2070 batches | lr 0.02 | ms/batch 10.55 | loss  4.83
INFO:root:| epoch   9 |   600/ 2070 batches | lr 0.02 | ms/batch 12.39 | loss  4.81
INFO:root:| epoch   9 |   800/ 2070 batches | lr 0.02 | ms/batch  9.94 | loss  4.72
INFO:root:| epoch   9 |  1000/ 2070 batches | lr 0.02 | ms/batch  9.93 | loss  4.81
INFO:root:| epoch   9 |  1200/ 2070 batches | lr 0.02 | ms/batch 10.08 | loss  4.71
INFO:root:| epoch   9 |  1400/ 2070 batches | lr 0.02 | ms/batch 10.81 | loss  4.78
INFO:root:| epoch   9 |  1600/ 2070 batches | lr 0.02 | ms/batch 12.02 | loss  4.74
INFO:root:| epoch   9 |  1800/ 2070 batches | lr 0.02 | ms/batch 10.32 | loss  4.73
INFO:root:| epoch   9 |  2000/ 2070 batches | lr 0.02 | ms/batch 12.29 | loss  4.76
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   9 | time: 23.16s | valid loss  5.00 | valid ppl   148.22
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  10 |   200/ 2070 batches | lr 0.02 | ms/batch 12.00 | loss  4.67
INFO:root:| epoch  10 |   400/ 2070 batches | lr 0.02 | ms/batch 11.43 | loss  4.78
INFO:root:| epoch  10 |   600/ 2070 batches | lr 0.02 | ms/batch 16.54 | loss  4.76
INFO:root:| epoch  10 |   800/ 2070 batches | lr 0.02 | ms/batch 14.34 | loss  4.66
INFO:root:| epoch  10 |  1000/ 2070 batches | lr 0.02 | ms/batch 13.05 | loss  4.76
INFO:root:| epoch  10 |  1200/ 2070 batches | lr 0.02 | ms/batch 13.15 | loss  4.66
INFO:root:| epoch  10 |  1400/ 2070 batches | lr 0.02 | ms/batch  9.98 | loss  4.72
INFO:root:| epoch  10 |  1600/ 2070 batches | lr 0.02 | ms/batch 10.70 | loss  4.69
INFO:root:| epoch  10 |  1800/ 2070 batches | lr 0.02 | ms/batch 12.06 | loss  4.67
INFO:root:| epoch  10 |  2000/ 2070 batches | lr 0.02 | ms/batch 10.25 | loss  4.71
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  10 | time: 25.66s | valid loss  4.97 | valid ppl   143.46
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:=========================================================================================
INFO:root:| End of training | test loss  5.15 | test ppl   173.25
INFO:root:=========================================================================================
INFO:root:----------- new value of n = 4, k = 4 -----------
INFO:root:Loading data
INFO:root:Vocab size 5005
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:| epoch   1 |   200/ 2250 batches | lr 0.02 | ms/batch 14.38 | loss  8.48
INFO:root:| epoch   1 |   400/ 2250 batches | lr 0.02 | ms/batch 11.56 | loss  8.30
INFO:root:| epoch   1 |   600/ 2250 batches | lr 0.02 | ms/batch 13.10 | loss  8.13
INFO:root:| epoch   1 |   800/ 2250 batches | lr 0.02 | ms/batch 11.21 | loss  7.95
INFO:root:| epoch   1 |  1000/ 2250 batches | lr 0.02 | ms/batch 12.91 | loss  7.73
INFO:root:| epoch   1 |  1200/ 2250 batches | lr 0.02 | ms/batch 11.15 | loss  7.47
INFO:root:| epoch   1 |  1400/ 2250 batches | lr 0.02 | ms/batch 13.55 | loss  7.17
INFO:root:| epoch   1 |  1600/ 2250 batches | lr 0.02 | ms/batch 10.76 | loss  6.84
INFO:root:| epoch   1 |  1800/ 2250 batches | lr 0.02 | ms/batch 10.67 | loss  6.54
INFO:root:| epoch   1 |  2000/ 2250 batches | lr 0.02 | ms/batch 10.80 | loss  6.32
INFO:root:| epoch   1 |  2200/ 2250 batches | lr 0.02 | ms/batch 11.10 | loss  6.16
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   1 | time: 27.47s | valid loss  6.18 | valid ppl   482.86
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   2 |   200/ 2250 batches | lr 0.02 | ms/batch 12.82 | loss  6.04
INFO:root:| epoch   2 |   400/ 2250 batches | lr 0.02 | ms/batch 13.65 | loss  5.90
INFO:root:| epoch   2 |   600/ 2250 batches | lr 0.02 | ms/batch 11.24 | loss  5.79
INFO:root:| epoch   2 |   800/ 2250 batches | lr 0.02 | ms/batch 13.06 | loss  5.71
INFO:root:| epoch   2 |  1000/ 2250 batches | lr 0.02 | ms/batch 10.78 | loss  5.65
INFO:root:| epoch   2 |  1200/ 2250 batches | lr 0.02 | ms/batch 11.02 | loss  5.60
INFO:root:| epoch   2 |  1400/ 2250 batches | lr 0.02 | ms/batch 11.10 | loss  5.57
INFO:root:| epoch   2 |  1600/ 2250 batches | lr 0.02 | ms/batch 11.12 | loss  5.55
INFO:root:| epoch   2 |  1800/ 2250 batches | lr 0.02 | ms/batch 12.97 | loss  5.52
INFO:root:| epoch   2 |  2000/ 2250 batches | lr 0.02 | ms/batch 11.19 | loss  5.50
INFO:root:| epoch   2 |  2200/ 2250 batches | lr 0.02 | ms/batch 13.28 | loss  5.48
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   2 | time: 27.30s | valid loss  5.62 | valid ppl   276.22
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   3 |   200/ 2250 batches | lr 0.02 | ms/batch 12.56 | loss  5.49
INFO:root:| epoch   3 |   400/ 2250 batches | lr 0.02 | ms/batch 12.36 | loss  5.45
INFO:root:| epoch   3 |   600/ 2250 batches | lr 0.02 | ms/batch 15.55 | loss  5.43
INFO:root:| epoch   3 |   800/ 2250 batches | lr 0.02 | ms/batch 14.36 | loss  5.43
INFO:root:| epoch   3 |  1000/ 2250 batches | lr 0.02 | ms/batch 11.31 | loss  5.42
INFO:root:| epoch   3 |  1200/ 2250 batches | lr 0.02 | ms/batch 13.21 | loss  5.41
INFO:root:| epoch   3 |  1400/ 2250 batches | lr 0.02 | ms/batch 10.98 | loss  5.41
INFO:root:| epoch   3 |  1600/ 2250 batches | lr 0.02 | ms/batch 13.41 | loss  5.40
INFO:root:| epoch   3 |  1800/ 2250 batches | lr 0.02 | ms/batch 11.12 | loss  5.39
INFO:root:| epoch   3 |  2000/ 2250 batches | lr 0.02 | ms/batch 13.42 | loss  5.38
INFO:root:| epoch   3 |  2200/ 2250 batches | lr 0.02 | ms/batch 10.81 | loss  5.36
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   3 | time: 28.66s | valid loss  5.52 | valid ppl   249.76
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   4 |   200/ 2250 batches | lr 0.02 | ms/batch 11.48 | loss  5.38
INFO:root:| epoch   4 |   400/ 2250 batches | lr 0.02 | ms/batch 13.30 | loss  5.34
INFO:root:| epoch   4 |   600/ 2250 batches | lr 0.02 | ms/batch 11.35 | loss  5.32
INFO:root:| epoch   4 |   800/ 2250 batches | lr 0.02 | ms/batch 12.87 | loss  5.33
INFO:root:| epoch   4 |  1000/ 2250 batches | lr 0.02 | ms/batch 11.20 | loss  5.32
INFO:root:| epoch   4 |  1200/ 2250 batches | lr 0.02 | ms/batch 12.95 | loss  5.32
INFO:root:| epoch   4 |  1400/ 2250 batches | lr 0.02 | ms/batch 11.31 | loss  5.32
INFO:root:| epoch   4 |  1600/ 2250 batches | lr 0.02 | ms/batch 10.76 | loss  5.32
INFO:root:| epoch   4 |  1800/ 2250 batches | lr 0.02 | ms/batch 12.24 | loss  5.30
INFO:root:| epoch   4 |  2000/ 2250 batches | lr 0.02 | ms/batch 12.58 | loss  5.29
INFO:root:| epoch   4 |  2200/ 2250 batches | lr 0.02 | ms/batch 12.78 | loss  5.28
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   4 | time: 27.61s | valid loss  5.46 | valid ppl   234.10
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   5 |   200/ 2250 batches | lr 0.02 | ms/batch 12.74 | loss  5.30
INFO:root:| epoch   5 |   400/ 2250 batches | lr 0.02 | ms/batch 13.43 | loss  5.26
INFO:root:| epoch   5 |   600/ 2250 batches | lr 0.02 | ms/batch 10.86 | loss  5.24
INFO:root:| epoch   5 |   800/ 2250 batches | lr 0.02 | ms/batch 13.21 | loss  5.25
INFO:root:| epoch   5 |  1000/ 2250 batches | lr 0.02 | ms/batch 11.97 | loss  5.24
INFO:root:| epoch   5 |  1200/ 2250 batches | lr 0.02 | ms/batch 13.85 | loss  5.24
INFO:root:| epoch   5 |  1400/ 2250 batches | lr 0.02 | ms/batch 10.83 | loss  5.24
INFO:root:| epoch   5 |  1600/ 2250 batches | lr 0.02 | ms/batch 13.23 | loss  5.24
INFO:root:| epoch   5 |  1800/ 2250 batches | lr 0.02 | ms/batch 11.18 | loss  5.22
INFO:root:| epoch   5 |  2000/ 2250 batches | lr 0.02 | ms/batch 13.45 | loss  5.21
INFO:root:| epoch   5 |  2200/ 2250 batches | lr 0.02 | ms/batch 11.12 | loss  5.19
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   5 | time: 28.22s | valid loss  5.39 | valid ppl   219.70
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   6 |   200/ 2250 batches | lr 0.02 | ms/batch 13.53 | loss  5.22
INFO:root:| epoch   6 |   400/ 2250 batches | lr 0.02 | ms/batch 11.90 | loss  5.18
INFO:root:| epoch   6 |   600/ 2250 batches | lr 0.02 | ms/batch 12.66 | loss  5.15
INFO:root:| epoch   6 |   800/ 2250 batches | lr 0.02 | ms/batch 11.70 | loss  5.16
INFO:root:| epoch   6 |  1000/ 2250 batches | lr 0.02 | ms/batch 12.87 | loss  5.16
INFO:root:| epoch   6 |  1200/ 2250 batches | lr 0.02 | ms/batch 11.76 | loss  5.16
INFO:root:| epoch   6 |  1400/ 2250 batches | lr 0.02 | ms/batch 12.95 | loss  5.15
INFO:root:| epoch   6 |  1600/ 2250 batches | lr 0.02 | ms/batch 11.06 | loss  5.15
INFO:root:| epoch   6 |  1800/ 2250 batches | lr 0.02 | ms/batch 12.95 | loss  5.13
INFO:root:| epoch   6 |  2000/ 2250 batches | lr 0.02 | ms/batch 11.20 | loss  5.12
INFO:root:| epoch   6 |  2200/ 2250 batches | lr 0.02 | ms/batch 11.14 | loss  5.10
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   6 | time: 27.92s | valid loss  5.32 | valid ppl   205.01
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   7 |   200/ 2250 batches | lr 0.02 | ms/batch 13.74 | loss  5.12
INFO:root:| epoch   7 |   400/ 2250 batches | lr 0.02 | ms/batch 13.14 | loss  5.08
INFO:root:| epoch   7 |   600/ 2250 batches | lr 0.02 | ms/batch 11.61 | loss  5.06
INFO:root:| epoch   7 |   800/ 2250 batches | lr 0.02 | ms/batch 10.67 | loss  5.07
INFO:root:| epoch   7 |  1000/ 2250 batches | lr 0.02 | ms/batch 13.33 | loss  5.06
INFO:root:| epoch   7 |  1200/ 2250 batches | lr 0.02 | ms/batch 11.74 | loss  5.06
INFO:root:| epoch   7 |  1400/ 2250 batches | lr 0.02 | ms/batch 11.25 | loss  5.06
INFO:root:| epoch   7 |  1600/ 2250 batches | lr 0.02 | ms/batch 17.65 | loss  5.06
INFO:root:| epoch   7 |  1800/ 2250 batches | lr 0.02 | ms/batch 11.06 | loss  5.03
INFO:root:| epoch   7 |  2000/ 2250 batches | lr 0.02 | ms/batch 13.47 | loss  5.03
INFO:root:| epoch   7 |  2200/ 2250 batches | lr 0.02 | ms/batch 10.99 | loss  5.00
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   7 | time: 28.79s | valid loss  5.25 | valid ppl   190.77
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   8 |   200/ 2250 batches | lr 0.02 | ms/batch 13.16 | loss  5.03
INFO:root:| epoch   8 |   400/ 2250 batches | lr 0.02 | ms/batch 12.11 | loss  4.98
INFO:root:| epoch   8 |   600/ 2250 batches | lr 0.02 | ms/batch 12.82 | loss  4.96
INFO:root:| epoch   8 |   800/ 2250 batches | lr 0.02 | ms/batch 12.19 | loss  4.97
INFO:root:| epoch   8 |  1000/ 2250 batches | lr 0.02 | ms/batch 12.47 | loss  4.97
INFO:root:| epoch   8 |  1200/ 2250 batches | lr 0.02 | ms/batch 11.33 | loss  4.97
INFO:root:| epoch   8 |  1400/ 2250 batches | lr 0.02 | ms/batch 12.88 | loss  4.96
INFO:root:| epoch   8 |  1600/ 2250 batches | lr 0.02 | ms/batch 11.04 | loss  4.97
INFO:root:| epoch   8 |  1800/ 2250 batches | lr 0.02 | ms/batch 10.92 | loss  4.94
INFO:root:| epoch   8 |  2000/ 2250 batches | lr 0.02 | ms/batch 13.23 | loss  4.93
INFO:root:| epoch   8 |  2200/ 2250 batches | lr 0.02 | ms/batch 11.09 | loss  4.91
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   8 | time: 27.53s | valid loss  5.18 | valid ppl   178.36
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   9 |   200/ 2250 batches | lr 0.02 | ms/batch 13.79 | loss  4.94
INFO:root:| epoch   9 |   400/ 2250 batches | lr 0.02 | ms/batch 11.28 | loss  4.89
INFO:root:| epoch   9 |   600/ 2250 batches | lr 0.02 | ms/batch 13.20 | loss  4.87
INFO:root:| epoch   9 |   800/ 2250 batches | lr 0.02 | ms/batch 11.10 | loss  4.88
INFO:root:| epoch   9 |  1000/ 2250 batches | lr 0.02 | ms/batch 11.02 | loss  4.88
INFO:root:| epoch   9 |  1200/ 2250 batches | lr 0.02 | ms/batch 10.91 | loss  4.89
INFO:root:| epoch   9 |  1400/ 2250 batches | lr 0.02 | ms/batch 12.59 | loss  4.88
INFO:root:| epoch   9 |  1600/ 2250 batches | lr 0.02 | ms/batch 12.80 | loss  4.89
INFO:root:| epoch   9 |  1800/ 2250 batches | lr 0.02 | ms/batch 13.34 | loss  4.86
INFO:root:| epoch   9 |  2000/ 2250 batches | lr 0.02 | ms/batch 11.27 | loss  4.86
INFO:root:| epoch   9 |  2200/ 2250 batches | lr 0.02 | ms/batch 13.20 | loss  4.84
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   9 | time: 27.84s | valid loss  5.13 | valid ppl   168.64
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  10 |   200/ 2250 batches | lr 0.02 | ms/batch 11.46 | loss  4.87
INFO:root:| epoch  10 |   400/ 2250 batches | lr 0.02 | ms/batch 10.82 | loss  4.82
INFO:root:| epoch  10 |   600/ 2250 batches | lr 0.02 | ms/batch 11.07 | loss  4.80
INFO:root:| epoch  10 |   800/ 2250 batches | lr 0.02 | ms/batch 13.01 | loss  4.81
INFO:root:| epoch  10 |  1000/ 2250 batches | lr 0.02 | ms/batch 11.61 | loss  4.81
INFO:root:| epoch  10 |  1200/ 2250 batches | lr 0.02 | ms/batch 12.65 | loss  4.82
INFO:root:| epoch  10 |  1400/ 2250 batches | lr 0.02 | ms/batch 11.59 | loss  4.82
INFO:root:| epoch  10 |  1600/ 2250 batches | lr 0.02 | ms/batch 12.66 | loss  4.83
INFO:root:| epoch  10 |  1800/ 2250 batches | lr 0.02 | ms/batch 11.98 | loss  4.80
INFO:root:| epoch  10 |  2000/ 2250 batches | lr 0.02 | ms/batch 11.15 | loss  4.80
INFO:root:| epoch  10 |  2200/ 2250 batches | lr 0.02 | ms/batch 10.78 | loss  4.78
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  10 | time: 26.60s | valid loss  5.08 | valid ppl   161.46
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:=========================================================================================
INFO:root:| End of training | test loss  5.26 | test ppl   192.27
INFO:root:=========================================================================================
INFO:root:----------- new value of n = 5, k = 1 -----------
INFO:root:Loading data
INFO:root:Vocab size 2005
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:| epoch   1 |   200/ 1710 batches | lr 0.02 | ms/batch 12.38 | loss  7.52
INFO:root:| epoch   1 |   400/ 1710 batches | lr 0.02 | ms/batch  9.94 | loss  7.23
INFO:root:| epoch   1 |   600/ 1710 batches | lr 0.02 | ms/batch  9.36 | loss  6.94
INFO:root:| epoch   1 |   800/ 1710 batches | lr 0.02 | ms/batch 11.81 | loss  6.57
INFO:root:| epoch   1 |  1000/ 1710 batches | lr 0.02 | ms/batch 10.22 | loss  6.11
INFO:root:| epoch   1 |  1200/ 1710 batches | lr 0.02 | ms/batch 11.12 | loss  5.60
INFO:root:| epoch   1 |  1400/ 1710 batches | lr 0.02 | ms/batch 10.72 | loss  5.15
INFO:root:| epoch   1 |  1600/ 1710 batches | lr 0.02 | ms/batch  9.09 | loss  4.82
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   1 | time: 18.12s | valid loss  4.83 | valid ppl   125.66
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   2 |   200/ 1710 batches | lr 0.02 | ms/batch 10.23 | loss  4.59
INFO:root:| epoch   2 |   400/ 1710 batches | lr 0.02 | ms/batch 10.80 | loss  4.41
INFO:root:| epoch   2 |   600/ 1710 batches | lr 0.02 | ms/batch 11.73 | loss  4.30
INFO:root:| epoch   2 |   800/ 1710 batches | lr 0.02 | ms/batch  9.43 | loss  4.19
INFO:root:| epoch   2 |  1000/ 1710 batches | lr 0.02 | ms/batch 12.26 | loss  4.13
INFO:root:| epoch   2 |  1200/ 1710 batches | lr 0.02 | ms/batch  9.52 | loss  4.11
INFO:root:| epoch   2 |  1400/ 1710 batches | lr 0.02 | ms/batch 11.26 | loss  4.11
INFO:root:| epoch   2 |  1600/ 1710 batches | lr 0.02 | ms/batch 10.30 | loss  4.04
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   2 | time: 18.32s | valid loss  4.27 | valid ppl    71.38
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   3 |   200/ 1710 batches | lr 0.02 | ms/batch  9.56 | loss  4.07
INFO:root:| epoch   3 |   400/ 1710 batches | lr 0.02 | ms/batch  9.42 | loss  4.04
INFO:root:| epoch   3 |   600/ 1710 batches | lr 0.02 | ms/batch  9.38 | loss  4.03
INFO:root:| epoch   3 |   800/ 1710 batches | lr 0.02 | ms/batch 12.26 | loss  4.01
INFO:root:| epoch   3 |  1000/ 1710 batches | lr 0.02 | ms/batch  9.41 | loss  3.99
INFO:root:| epoch   3 |  1200/ 1710 batches | lr 0.02 | ms/batch 11.03 | loss  4.01
INFO:root:| epoch   3 |  1400/ 1710 batches | lr 0.02 | ms/batch 10.45 | loss  4.03
INFO:root:| epoch   3 |  1600/ 1710 batches | lr 0.02 | ms/batch  9.11 | loss  3.98
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   3 | time: 17.90s | valid loss  4.21 | valid ppl    67.33
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   4 |   200/ 1710 batches | lr 0.02 | ms/batch  9.86 | loss  4.02
INFO:root:| epoch   4 |   400/ 1710 batches | lr 0.02 | ms/batch  9.42 | loss  4.00
INFO:root:| epoch   4 |   600/ 1710 batches | lr 0.02 | ms/batch  9.41 | loss  3.99
INFO:root:| epoch   4 |   800/ 1710 batches | lr 0.02 | ms/batch  9.38 | loss  3.98
INFO:root:| epoch   4 |  1000/ 1710 batches | lr 0.02 | ms/batch 11.64 | loss  3.97
INFO:root:| epoch   4 |  1200/ 1710 batches | lr 0.02 | ms/batch 10.13 | loss  3.99
INFO:root:| epoch   4 |  1400/ 1710 batches | lr 0.02 | ms/batch  9.99 | loss  4.01
INFO:root:| epoch   4 |  1600/ 1710 batches | lr 0.02 | ms/batch 11.11 | loss  3.96
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   4 | time: 17.43s | valid loss  4.20 | valid ppl    66.52
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   5 |   200/ 1710 batches | lr 0.02 | ms/batch 12.32 | loss  4.01
INFO:root:| epoch   5 |   400/ 1710 batches | lr 0.02 | ms/batch 10.07 | loss  3.99
INFO:root:| epoch   5 |   600/ 1710 batches | lr 0.02 | ms/batch  9.42 | loss  3.98
INFO:root:| epoch   5 |   800/ 1710 batches | lr 0.02 | ms/batch  9.52 | loss  3.97
INFO:root:| epoch   5 |  1000/ 1710 batches | lr 0.02 | ms/batch  9.29 | loss  3.95
INFO:root:| epoch   5 |  1200/ 1710 batches | lr 0.02 | ms/batch 11.83 | loss  3.98
INFO:root:| epoch   5 |  1400/ 1710 batches | lr 0.02 | ms/batch 10.46 | loss  4.00
INFO:root:| epoch   5 |  1600/ 1710 batches | lr 0.02 | ms/batch 10.38 | loss  3.95
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   5 | time: 18.22s | valid loss  4.19 | valid ppl    66.18
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   6 |   200/ 1710 batches | lr 0.02 | ms/batch  9.79 | loss  4.00
INFO:root:| epoch   6 |   400/ 1710 batches | lr 0.02 | ms/batch 12.02 | loss  3.98
INFO:root:| epoch   6 |   600/ 1710 batches | lr 0.02 | ms/batch  9.74 | loss  3.97
INFO:root:| epoch   6 |   800/ 1710 batches | lr 0.02 | ms/batch  9.68 | loss  3.96
INFO:root:| epoch   6 |  1000/ 1710 batches | lr 0.02 | ms/batch  9.40 | loss  3.94
INFO:root:| epoch   6 |  1200/ 1710 batches | lr 0.02 | ms/batch  9.26 | loss  3.97
INFO:root:| epoch   6 |  1400/ 1710 batches | lr 0.02 | ms/batch 10.74 | loss  3.99
INFO:root:| epoch   6 |  1600/ 1710 batches | lr 0.02 | ms/batch 10.57 | loss  3.94
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   6 | time: 17.47s | valid loss  4.19 | valid ppl    65.92
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   7 |   200/ 1710 batches | lr 0.02 | ms/batch 12.47 | loss  3.99
INFO:root:| epoch   7 |   400/ 1710 batches | lr 0.02 | ms/batch  9.38 | loss  3.97
INFO:root:| epoch   7 |   600/ 1710 batches | lr 0.02 | ms/batch 10.86 | loss  3.96
INFO:root:| epoch   7 |   800/ 1710 batches | lr 0.02 | ms/batch 10.81 | loss  3.95
INFO:root:| epoch   7 |  1000/ 1710 batches | lr 0.02 | ms/batch  9.42 | loss  3.93
INFO:root:| epoch   7 |  1200/ 1710 batches | lr 0.02 | ms/batch  9.42 | loss  3.96
INFO:root:| epoch   7 |  1400/ 1710 batches | lr 0.02 | ms/batch  9.32 | loss  3.98
INFO:root:| epoch   7 |  1600/ 1710 batches | lr 0.02 | ms/batch  9.12 | loss  3.93
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   7 | time: 17.81s | valid loss  4.18 | valid ppl    65.69
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   8 |   200/ 1710 batches | lr 0.02 | ms/batch 10.56 | loss  3.98
INFO:root:| epoch   8 |   400/ 1710 batches | lr 0.02 | ms/batch  9.68 | loss  3.96
INFO:root:| epoch   8 |   600/ 1710 batches | lr 0.02 | ms/batch 11.92 | loss  3.96
INFO:root:| epoch   8 |   800/ 1710 batches | lr 0.02 | ms/batch  9.74 | loss  3.94
INFO:root:| epoch   8 |  1000/ 1710 batches | lr 0.02 | ms/batch 12.08 | loss  3.92
INFO:root:| epoch   8 |  1200/ 1710 batches | lr 0.02 | ms/batch  9.37 | loss  3.95
INFO:root:| epoch   8 |  1400/ 1710 batches | lr 0.02 | ms/batch  9.94 | loss  3.97
INFO:root:| epoch   8 |  1600/ 1710 batches | lr 0.02 | ms/batch  9.29 | loss  3.92
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   8 | time: 17.87s | valid loss  4.18 | valid ppl    65.49
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   9 |   200/ 1710 batches | lr 0.02 | ms/batch 11.15 | loss  3.97
INFO:root:| epoch   9 |   400/ 1710 batches | lr 0.02 | ms/batch 10.93 | loss  3.95
INFO:root:| epoch   9 |   600/ 1710 batches | lr 0.02 | ms/batch  9.44 | loss  3.95
INFO:root:| epoch   9 |   800/ 1710 batches | lr 0.02 | ms/batch 12.00 | loss  3.93
INFO:root:| epoch   9 |  1000/ 1710 batches | lr 0.02 | ms/batch  9.48 | loss  3.91
INFO:root:| epoch   9 |  1200/ 1710 batches | lr 0.02 | ms/batch 12.14 | loss  3.94
INFO:root:| epoch   9 |  1400/ 1710 batches | lr 0.02 | ms/batch  9.52 | loss  3.96
INFO:root:| epoch   9 |  1600/ 1710 batches | lr 0.02 | ms/batch  9.41 | loss  3.91
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   9 | time: 18.05s | valid loss  4.18 | valid ppl    65.30
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  10 |   200/ 1710 batches | lr 0.02 | ms/batch  9.65 | loss  3.96
INFO:root:| epoch  10 |   400/ 1710 batches | lr 0.02 | ms/batch  9.41 | loss  3.94
INFO:root:| epoch  10 |   600/ 1710 batches | lr 0.02 | ms/batch 12.05 | loss  3.94
INFO:root:| epoch  10 |   800/ 1710 batches | lr 0.02 | ms/batch  9.37 | loss  3.92
INFO:root:| epoch  10 |  1000/ 1710 batches | lr 0.02 | ms/batch 12.11 | loss  3.90
INFO:root:| epoch  10 |  1200/ 1710 batches | lr 0.02 | ms/batch 10.87 | loss  3.93
INFO:root:| epoch  10 |  1400/ 1710 batches | lr 0.02 | ms/batch 11.32 | loss  3.95
INFO:root:| epoch  10 |  1600/ 1710 batches | lr 0.02 | ms/batch 10.36 | loss  3.90
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  10 | time: 18.26s | valid loss  4.18 | valid ppl    65.14
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:=========================================================================================
INFO:root:| End of training | test loss  4.33 | test ppl    75.89
INFO:root:=========================================================================================
INFO:root:----------- new value of n = 5, k = 2 -----------
INFO:root:Loading data
INFO:root:Vocab size 3005
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:| epoch   1 |   200/ 1890 batches | lr 0.02 | ms/batch 10.68 | loss  7.96
INFO:root:| epoch   1 |   400/ 1890 batches | lr 0.02 | ms/batch 10.03 | loss  7.71
INFO:root:| epoch   1 |   600/ 1890 batches | lr 0.02 | ms/batch 12.84 | loss  7.46
INFO:root:| epoch   1 |   800/ 1890 batches | lr 0.02 | ms/batch 10.73 | loss  7.18
INFO:root:| epoch   1 |  1000/ 1890 batches | lr 0.02 | ms/batch 12.06 | loss  6.83
INFO:root:| epoch   1 |  1200/ 1890 batches | lr 0.02 | ms/batch 11.12 | loss  6.37
INFO:root:| epoch   1 |  1400/ 1890 batches | lr 0.02 | ms/batch 11.32 | loss  5.93
INFO:root:| epoch   1 |  1600/ 1890 batches | lr 0.02 | ms/batch 11.90 | loss  5.60
INFO:root:| epoch   1 |  1800/ 1890 batches | lr 0.02 | ms/batch 10.41 | loss  5.41
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   1 | time: 21.40s | valid loss  5.31 | valid ppl   202.81
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   2 |   200/ 1890 batches | lr 0.02 | ms/batch 12.60 | loss  5.17
INFO:root:| epoch   2 |   400/ 1890 batches | lr 0.02 | ms/batch 16.11 | loss  5.01
INFO:root:| epoch   2 |   600/ 1890 batches | lr 0.02 | ms/batch 10.95 | loss  4.86
INFO:root:| epoch   2 |   800/ 1890 batches | lr 0.02 | ms/batch 13.58 | loss  4.81
INFO:root:| epoch   2 |  1000/ 1890 batches | lr 0.02 | ms/batch 11.26 | loss  4.74
INFO:root:| epoch   2 |  1200/ 1890 batches | lr 0.02 | ms/batch 13.49 | loss  4.65
INFO:root:| epoch   2 |  1400/ 1890 batches | lr 0.02 | ms/batch 10.72 | loss  4.63
INFO:root:| epoch   2 |  1600/ 1890 batches | lr 0.02 | ms/batch 10.82 | loss  4.66
INFO:root:| epoch   2 |  1800/ 1890 batches | lr 0.02 | ms/batch 10.79 | loss  4.66
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   2 | time: 23.31s | valid loss  4.75 | valid ppl   115.99
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   3 |   200/ 1890 batches | lr 0.02 | ms/batch 14.09 | loss  4.61
INFO:root:| epoch   3 |   400/ 1890 batches | lr 0.02 | ms/batch 11.17 | loss  4.59
INFO:root:| epoch   3 |   600/ 1890 batches | lr 0.02 | ms/batch 13.81 | loss  4.55
INFO:root:| epoch   3 |   800/ 1890 batches | lr 0.02 | ms/batch 11.14 | loss  4.60
INFO:root:| epoch   3 |  1000/ 1890 batches | lr 0.02 | ms/batch 13.48 | loss  4.59
INFO:root:| epoch   3 |  1200/ 1890 batches | lr 0.02 | ms/batch 11.27 | loss  4.55
INFO:root:| epoch   3 |  1400/ 1890 batches | lr 0.02 | ms/batch 11.17 | loss  4.54
INFO:root:| epoch   3 |  1600/ 1890 batches | lr 0.02 | ms/batch 10.76 | loss  4.59
INFO:root:| epoch   3 |  1800/ 1890 batches | lr 0.02 | ms/batch 10.93 | loss  4.60
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   3 | time: 23.13s | valid loss  4.71 | valid ppl   111.25
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   4 |   200/ 1890 batches | lr 0.02 | ms/batch 12.65 | loss  4.56
INFO:root:| epoch   4 |   400/ 1890 batches | lr 0.02 | ms/batch 12.05 | loss  4.55
INFO:root:| epoch   4 |   600/ 1890 batches | lr 0.02 | ms/batch 12.94 | loss  4.51
INFO:root:| epoch   4 |   800/ 1890 batches | lr 0.02 | ms/batch 11.83 | loss  4.57
INFO:root:| epoch   4 |  1000/ 1890 batches | lr 0.02 | ms/batch 12.89 | loss  4.56
INFO:root:| epoch   4 |  1200/ 1890 batches | lr 0.02 | ms/batch 11.02 | loss  4.52
INFO:root:| epoch   4 |  1400/ 1890 batches | lr 0.02 | ms/batch 11.66 | loss  4.51
INFO:root:| epoch   4 |  1600/ 1890 batches | lr 0.02 | ms/batch 10.71 | loss  4.57
INFO:root:| epoch   4 |  1800/ 1890 batches | lr 0.02 | ms/batch 13.52 | loss  4.57
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   4 | time: 23.10s | valid loss  4.70 | valid ppl   109.50
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   5 |   200/ 1890 batches | lr 0.02 | ms/batch 13.67 | loss  4.53
INFO:root:| epoch   5 |   400/ 1890 batches | lr 0.02 | ms/batch 12.35 | loss  4.53
INFO:root:| epoch   5 |   600/ 1890 batches | lr 0.02 | ms/batch 12.71 | loss  4.49
INFO:root:| epoch   5 |   800/ 1890 batches | lr 0.02 | ms/batch 11.73 | loss  4.54
INFO:root:| epoch   5 |  1000/ 1890 batches | lr 0.02 | ms/batch 10.76 | loss  4.53
INFO:root:| epoch   5 |  1200/ 1890 batches | lr 0.02 | ms/batch 10.81 | loss  4.50
INFO:root:| epoch   5 |  1400/ 1890 batches | lr 0.02 | ms/batch 11.27 | loss  4.49
INFO:root:| epoch   5 |  1600/ 1890 batches | lr 0.02 | ms/batch 13.74 | loss  4.54
INFO:root:| epoch   5 |  1800/ 1890 batches | lr 0.02 | ms/batch 11.07 | loss  4.55
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   5 | time: 23.25s | valid loss  4.68 | valid ppl   108.04
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   6 |   200/ 1890 batches | lr 0.02 | ms/batch 12.55 | loss  4.51
INFO:root:| epoch   6 |   400/ 1890 batches | lr 0.02 | ms/batch 13.31 | loss  4.50
INFO:root:| epoch   6 |   600/ 1890 batches | lr 0.02 | ms/batch 11.53 | loss  4.46
INFO:root:| epoch   6 |   800/ 1890 batches | lr 0.02 | ms/batch 10.92 | loss  4.52
INFO:root:| epoch   6 |  1000/ 1890 batches | lr 0.02 | ms/batch 10.95 | loss  4.51
INFO:root:| epoch   6 |  1200/ 1890 batches | lr 0.02 | ms/batch 11.19 | loss  4.48
INFO:root:| epoch   6 |  1400/ 1890 batches | lr 0.02 | ms/batch 14.01 | loss  4.47
INFO:root:| epoch   6 |  1600/ 1890 batches | lr 0.02 | ms/batch 11.75 | loss  4.52
INFO:root:| epoch   6 |  1800/ 1890 batches | lr 0.02 | ms/batch 13.33 | loss  4.52
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   6 | time: 23.15s | valid loss  4.67 | valid ppl   106.66
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   7 |   200/ 1890 batches | lr 0.02 | ms/batch 14.00 | loss  4.49
INFO:root:| epoch   7 |   400/ 1890 batches | lr 0.02 | ms/batch 17.34 | loss  4.48
INFO:root:| epoch   7 |   600/ 1890 batches | lr 0.02 | ms/batch 18.32 | loss  4.44
INFO:root:| epoch   7 |   800/ 1890 batches | lr 0.02 | ms/batch 12.20 | loss  4.49
INFO:root:| epoch   7 |  1000/ 1890 batches | lr 0.02 | ms/batch 12.94 | loss  4.49
INFO:root:| epoch   7 |  1200/ 1890 batches | lr 0.02 | ms/batch 11.36 | loss  4.45
INFO:root:| epoch   7 |  1400/ 1890 batches | lr 0.02 | ms/batch 12.90 | loss  4.44
INFO:root:| epoch   7 |  1600/ 1890 batches | lr 0.02 | ms/batch 11.25 | loss  4.50
INFO:root:| epoch   7 |  1800/ 1890 batches | lr 0.02 | ms/batch 13.38 | loss  4.50
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   7 | time: 25.94s | valid loss  4.66 | valid ppl   105.31
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   8 |   200/ 1890 batches | lr 0.02 | ms/batch 10.86 | loss  4.46
INFO:root:| epoch   8 |   400/ 1890 batches | lr 0.02 | ms/batch 10.94 | loss  4.46
INFO:root:| epoch   8 |   600/ 1890 batches | lr 0.02 | ms/batch 11.17 | loss  4.42
INFO:root:| epoch   8 |   800/ 1890 batches | lr 0.02 | ms/batch 13.49 | loss  4.47
INFO:root:| epoch   8 |  1000/ 1890 batches | lr 0.02 | ms/batch 11.01 | loss  4.46
INFO:root:| epoch   8 |  1200/ 1890 batches | lr 0.02 | ms/batch 13.52 | loss  4.43
INFO:root:| epoch   8 |  1400/ 1890 batches | lr 0.02 | ms/batch 11.07 | loss  4.42
INFO:root:| epoch   8 |  1600/ 1890 batches | lr 0.02 | ms/batch 13.63 | loss  4.47
INFO:root:| epoch   8 |  1800/ 1890 batches | lr 0.02 | ms/batch 10.97 | loss  4.47
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   8 | time: 22.54s | valid loss  4.64 | valid ppl   104.00
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   9 |   200/ 1890 batches | lr 0.02 | ms/batch 10.92 | loss  4.44
INFO:root:| epoch   9 |   400/ 1890 batches | lr 0.02 | ms/batch 11.05 | loss  4.43
INFO:root:| epoch   9 |   600/ 1890 batches | lr 0.02 | ms/batch 13.40 | loss  4.39
INFO:root:| epoch   9 |   800/ 1890 batches | lr 0.02 | ms/batch 11.92 | loss  4.44
INFO:root:| epoch   9 |  1000/ 1890 batches | lr 0.02 | ms/batch 12.84 | loss  4.44
INFO:root:| epoch   9 |  1200/ 1890 batches | lr 0.02 | ms/batch 11.45 | loss  4.41
INFO:root:| epoch   9 |  1400/ 1890 batches | lr 0.02 | ms/batch 13.50 | loss  4.40
INFO:root:| epoch   9 |  1600/ 1890 batches | lr 0.02 | ms/batch 11.99 | loss  4.45
INFO:root:| epoch   9 |  1800/ 1890 batches | lr 0.02 | ms/batch 10.94 | loss  4.45
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   9 | time: 22.80s | valid loss  4.63 | valid ppl   102.72
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  10 |   200/ 1890 batches | lr 0.02 | ms/batch 11.39 | loss  4.41
INFO:root:| epoch  10 |   400/ 1890 batches | lr 0.02 | ms/batch 13.53 | loss  4.40
INFO:root:| epoch  10 |   600/ 1890 batches | lr 0.02 | ms/batch 11.62 | loss  4.37
INFO:root:| epoch  10 |   800/ 1890 batches | lr 0.02 | ms/batch 13.20 | loss  4.41
INFO:root:| epoch  10 |  1000/ 1890 batches | lr 0.02 | ms/batch 10.85 | loss  4.41
INFO:root:| epoch  10 |  1200/ 1890 batches | lr 0.02 | ms/batch 13.33 | loss  4.38
INFO:root:| epoch  10 |  1400/ 1890 batches | lr 0.02 | ms/batch 11.00 | loss  4.37
INFO:root:| epoch  10 |  1600/ 1890 batches | lr 0.02 | ms/batch 10.90 | loss  4.43
INFO:root:| epoch  10 |  1800/ 1890 batches | lr 0.02 | ms/batch 10.66 | loss  4.42
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  10 | time: 22.50s | valid loss  4.62 | valid ppl   101.47
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:=========================================================================================
INFO:root:| End of training | test loss  4.81 | test ppl   122.13
INFO:root:=========================================================================================
INFO:root:----------- new value of n = 5, k = 3 -----------
INFO:root:Loading data
INFO:root:Vocab size 4005
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:| epoch   1 |   200/ 2070 batches | lr 0.02 | ms/batch 13.56 | loss  8.26
INFO:root:| epoch   1 |   400/ 2070 batches | lr 0.02 | ms/batch 11.39 | loss  8.08
INFO:root:| epoch   1 |   600/ 2070 batches | lr 0.02 | ms/batch 13.16 | loss  7.91
INFO:root:| epoch   1 |   800/ 2070 batches | lr 0.02 | ms/batch 11.14 | loss  7.71
INFO:root:| epoch   1 |  1000/ 2070 batches | lr 0.02 | ms/batch 13.54 | loss  7.49
INFO:root:| epoch   1 |  1200/ 2070 batches | lr 0.02 | ms/batch 11.13 | loss  7.18
INFO:root:| epoch   1 |  1400/ 2070 batches | lr 0.02 | ms/batch 11.47 | loss  6.84
INFO:root:| epoch   1 |  1600/ 2070 batches | lr 0.02 | ms/batch 12.71 | loss  6.47
INFO:root:| epoch   1 |  1800/ 2070 batches | lr 0.02 | ms/batch 11.32 | loss  6.07
INFO:root:| epoch   1 |  2000/ 2070 batches | lr 0.02 | ms/batch 13.03 | loss  5.82
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   1 | time: 25.54s | valid loss  5.81 | valid ppl   335.14
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   2 |   200/ 2070 batches | lr 0.02 | ms/batch 14.12 | loss  5.53
INFO:root:| epoch   2 |   400/ 2070 batches | lr 0.02 | ms/batch 11.12 | loss  5.48
INFO:root:| epoch   2 |   600/ 2070 batches | lr 0.02 | ms/batch 14.80 | loss  5.31
INFO:root:| epoch   2 |   800/ 2070 batches | lr 0.02 | ms/batch 11.37 | loss  5.23
INFO:root:| epoch   2 |  1000/ 2070 batches | lr 0.02 | ms/batch 13.52 | loss  5.23
INFO:root:| epoch   2 |  1200/ 2070 batches | lr 0.02 | ms/batch 11.10 | loss  5.11
INFO:root:| epoch   2 |  1400/ 2070 batches | lr 0.02 | ms/batch 13.64 | loss  5.14
INFO:root:| epoch   2 |  1600/ 2070 batches | lr 0.02 | ms/batch 11.05 | loss  5.14
INFO:root:| epoch   2 |  1800/ 2070 batches | lr 0.02 | ms/batch 13.53 | loss  5.07
INFO:root:| epoch   2 |  2000/ 2070 batches | lr 0.02 | ms/batch 10.98 | loss  5.11
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   2 | time: 26.14s | valid loss  5.30 | valid ppl   199.53
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   3 |   200/ 2070 batches | lr 0.02 | ms/batch 13.35 | loss  5.02
INFO:root:| epoch   3 |   400/ 2070 batches | lr 0.02 | ms/batch 10.95 | loss  5.13
INFO:root:| epoch   3 |   600/ 2070 batches | lr 0.02 | ms/batch 10.85 | loss  5.04
INFO:root:| epoch   3 |   800/ 2070 batches | lr 0.02 | ms/batch 11.70 | loss  5.03
INFO:root:| epoch   3 |  1000/ 2070 batches | lr 0.02 | ms/batch 13.03 | loss  5.08
INFO:root:| epoch   3 |  1200/ 2070 batches | lr 0.02 | ms/batch 11.73 | loss  5.00
INFO:root:| epoch   3 |  1400/ 2070 batches | lr 0.02 | ms/batch 12.83 | loss  5.03
INFO:root:| epoch   3 |  1600/ 2070 batches | lr 0.02 | ms/batch 11.43 | loss  5.04
INFO:root:| epoch   3 |  1800/ 2070 batches | lr 0.02 | ms/batch 13.12 | loss  4.99
INFO:root:| epoch   3 |  2000/ 2070 batches | lr 0.02 | ms/batch 11.00 | loss  5.02
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   3 | time: 25.05s | valid loss  5.24 | valid ppl   188.01
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   4 |   200/ 2070 batches | lr 0.02 | ms/batch 11.08 | loss  4.95
INFO:root:| epoch   4 |   400/ 2070 batches | lr 0.02 | ms/batch 11.93 | loss  5.07
INFO:root:| epoch   4 |   600/ 2070 batches | lr 0.02 | ms/batch 13.77 | loss  4.98
INFO:root:| epoch   4 |   800/ 2070 batches | lr 0.02 | ms/batch 12.92 | loss  4.97
INFO:root:| epoch   4 |  1000/ 2070 batches | lr 0.02 | ms/batch 13.06 | loss  5.02
INFO:root:| epoch   4 |  1200/ 2070 batches | lr 0.02 | ms/batch 12.31 | loss  4.94
INFO:root:| epoch   4 |  1400/ 2070 batches | lr 0.02 | ms/batch 14.04 | loss  4.98
INFO:root:| epoch   4 |  1600/ 2070 batches | lr 0.02 | ms/batch 17.40 | loss  4.99
INFO:root:| epoch   4 |  1800/ 2070 batches | lr 0.02 | ms/batch 11.16 | loss  4.94
INFO:root:| epoch   4 |  2000/ 2070 batches | lr 0.02 | ms/batch 13.11 | loss  4.98
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   4 | time: 27.33s | valid loss  5.20 | valid ppl   181.95
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   5 |   200/ 2070 batches | lr 0.02 | ms/batch 11.27 | loss  4.90
INFO:root:| epoch   5 |   400/ 2070 batches | lr 0.02 | ms/batch 13.51 | loss  5.02
INFO:root:| epoch   5 |   600/ 2070 batches | lr 0.02 | ms/batch 11.10 | loss  4.94
INFO:root:| epoch   5 |   800/ 2070 batches | lr 0.02 | ms/batch 13.49 | loss  4.92
INFO:root:| epoch   5 |  1000/ 2070 batches | lr 0.02 | ms/batch 10.87 | loss  4.98
INFO:root:| epoch   5 |  1200/ 2070 batches | lr 0.02 | ms/batch 10.58 | loss  4.90
INFO:root:| epoch   5 |  1400/ 2070 batches | lr 0.02 | ms/batch 10.81 | loss  4.93
INFO:root:| epoch   5 |  1600/ 2070 batches | lr 0.02 | ms/batch 12.89 | loss  4.94
INFO:root:| epoch   5 |  1800/ 2070 batches | lr 0.02 | ms/batch 11.79 | loss  4.89
INFO:root:| epoch   5 |  2000/ 2070 batches | lr 0.02 | ms/batch 12.73 | loss  4.93
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   5 | time: 25.01s | valid loss  5.17 | valid ppl   176.44
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   6 |   200/ 2070 batches | lr 0.02 | ms/batch 11.03 | loss  4.86
INFO:root:| epoch   6 |   400/ 2070 batches | lr 0.02 | ms/batch 13.56 | loss  4.97
INFO:root:| epoch   6 |   600/ 2070 batches | lr 0.02 | ms/batch 10.90 | loss  4.89
INFO:root:| epoch   6 |   800/ 2070 batches | lr 0.02 | ms/batch 13.50 | loss  4.88
INFO:root:| epoch   6 |  1000/ 2070 batches | lr 0.02 | ms/batch 10.93 | loss  4.93
INFO:root:| epoch   6 |  1200/ 2070 batches | lr 0.02 | ms/batch 13.55 | loss  4.85
INFO:root:| epoch   6 |  1400/ 2070 batches | lr 0.02 | ms/batch 10.92 | loss  4.88
INFO:root:| epoch   6 |  1600/ 2070 batches | lr 0.02 | ms/batch 13.55 | loss  4.89
INFO:root:| epoch   6 |  1800/ 2070 batches | lr 0.02 | ms/batch 11.63 | loss  4.84
INFO:root:| epoch   6 |  2000/ 2070 batches | lr 0.02 | ms/batch 13.62 | loss  4.88
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   6 | time: 25.71s | valid loss  5.14 | valid ppl   170.88
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   7 |   200/ 2070 batches | lr 0.02 | ms/batch 12.81 | loss  4.81
INFO:root:| epoch   7 |   400/ 2070 batches | lr 0.02 | ms/batch 12.45 | loss  4.92
INFO:root:| epoch   7 |   600/ 2070 batches | lr 0.02 | ms/batch 10.99 | loss  4.85
INFO:root:| epoch   7 |   800/ 2070 batches | lr 0.02 | ms/batch 13.42 | loss  4.82
INFO:root:| epoch   7 |  1000/ 2070 batches | lr 0.02 | ms/batch 11.31 | loss  4.87
INFO:root:| epoch   7 |  1200/ 2070 batches | lr 0.02 | ms/batch 13.23 | loss  4.80
INFO:root:| epoch   7 |  1400/ 2070 batches | lr 0.02 | ms/batch 11.15 | loss  4.83
INFO:root:| epoch   7 |  1600/ 2070 batches | lr 0.02 | ms/batch 12.89 | loss  4.83
INFO:root:| epoch   7 |  1800/ 2070 batches | lr 0.02 | ms/batch 11.41 | loss  4.79
INFO:root:| epoch   7 |  2000/ 2070 batches | lr 0.02 | ms/batch 10.95 | loss  4.82
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   7 | time: 25.18s | valid loss  5.11 | valid ppl   165.23
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   8 |   200/ 2070 batches | lr 0.02 | ms/batch 11.49 | loss  4.76
INFO:root:| epoch   8 |   400/ 2070 batches | lr 0.02 | ms/batch 12.48 | loss  4.87
INFO:root:| epoch   8 |   600/ 2070 batches | lr 0.02 | ms/batch 12.35 | loss  4.79
INFO:root:| epoch   8 |   800/ 2070 batches | lr 0.02 | ms/batch 12.18 | loss  4.76
INFO:root:| epoch   8 |  1000/ 2070 batches | lr 0.02 | ms/batch 12.37 | loss  4.82
INFO:root:| epoch   8 |  1200/ 2070 batches | lr 0.02 | ms/batch 12.07 | loss  4.74
INFO:root:| epoch   8 |  1400/ 2070 batches | lr 0.02 | ms/batch 12.41 | loss  4.77
INFO:root:| epoch   8 |  1600/ 2070 batches | lr 0.02 | ms/batch 11.54 | loss  4.78
INFO:root:| epoch   8 |  1800/ 2070 batches | lr 0.02 | ms/batch 11.01 | loss  4.73
INFO:root:| epoch   8 |  2000/ 2070 batches | lr 0.02 | ms/batch 11.02 | loss  4.77
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   8 | time: 25.18s | valid loss  5.07 | valid ppl   159.61
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   9 |   200/ 2070 batches | lr 0.02 | ms/batch 12.56 | loss  4.70
INFO:root:| epoch   9 |   400/ 2070 batches | lr 0.02 | ms/batch 12.52 | loss  4.81
INFO:root:| epoch   9 |   600/ 2070 batches | lr 0.02 | ms/batch 12.83 | loss  4.74
INFO:root:| epoch   9 |   800/ 2070 batches | lr 0.02 | ms/batch 12.74 | loss  4.70
INFO:root:| epoch   9 |  1000/ 2070 batches | lr 0.02 | ms/batch 15.37 | loss  4.76
INFO:root:| epoch   9 |  1200/ 2070 batches | lr 0.02 | ms/batch 14.33 | loss  4.69
INFO:root:| epoch   9 |  1400/ 2070 batches | lr 0.02 | ms/batch 11.15 | loss  4.72
INFO:root:| epoch   9 |  1600/ 2070 batches | lr 0.02 | ms/batch 13.60 | loss  4.72
INFO:root:| epoch   9 |  1800/ 2070 batches | lr 0.02 | ms/batch 10.94 | loss  4.68
INFO:root:| epoch   9 |  2000/ 2070 batches | lr 0.02 | ms/batch 13.52 | loss  4.71
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   9 | time: 26.97s | valid loss  5.04 | valid ppl   154.35
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  10 |   200/ 2070 batches | lr 0.02 | ms/batch 11.65 | loss  4.65
INFO:root:| epoch  10 |   400/ 2070 batches | lr 0.02 | ms/batch 12.94 | loss  4.75
INFO:root:| epoch  10 |   600/ 2070 batches | lr 0.02 | ms/batch 11.03 | loss  4.69
INFO:root:| epoch  10 |   800/ 2070 batches | lr 0.02 | ms/batch 11.04 | loss  4.65
INFO:root:| epoch  10 |  1000/ 2070 batches | lr 0.02 | ms/batch 11.15 | loss  4.71
INFO:root:| epoch  10 |  1200/ 2070 batches | lr 0.02 | ms/batch 12.30 | loss  4.63
INFO:root:| epoch  10 |  1400/ 2070 batches | lr 0.02 | ms/batch 14.31 | loss  4.66
INFO:root:| epoch  10 |  1600/ 2070 batches | lr 0.02 | ms/batch 14.42 | loss  4.67
INFO:root:| epoch  10 |  1800/ 2070 batches | lr 0.02 | ms/batch 11.96 | loss  4.63
INFO:root:| epoch  10 |  2000/ 2070 batches | lr 0.02 | ms/batch 13.45 | loss  4.66
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  10 | time: 25.92s | valid loss  5.01 | valid ppl   149.73
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:=========================================================================================
INFO:root:| End of training | test loss  5.19 | test ppl   179.62
INFO:root:=========================================================================================
INFO:root:----------- new value of n = 5, k = 4 -----------
INFO:root:Loading data
INFO:root:Vocab size 5005
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:| epoch   1 |   200/ 2250 batches | lr 0.02 | ms/batch 13.60 | loss  8.49
INFO:root:| epoch   1 |   400/ 2250 batches | lr 0.02 | ms/batch 12.51 | loss  8.30
INFO:root:| epoch   1 |   600/ 2250 batches | lr 0.02 | ms/batch 18.74 | loss  8.14
INFO:root:| epoch   1 |   800/ 2250 batches | lr 0.02 | ms/batch 16.34 | loss  7.95
INFO:root:| epoch   1 |  1000/ 2250 batches | lr 0.02 | ms/batch 14.94 | loss  7.71
INFO:root:| epoch   1 |  1200/ 2250 batches | lr 0.02 | ms/batch 13.31 | loss  7.43
INFO:root:| epoch   1 |  1400/ 2250 batches | lr 0.02 | ms/batch 13.08 | loss  7.08
INFO:root:| epoch   1 |  1600/ 2250 batches | lr 0.02 | ms/batch 13.55 | loss  6.71
INFO:root:| epoch   1 |  1800/ 2250 batches | lr 0.02 | ms/batch 12.77 | loss  6.39
INFO:root:| epoch   1 |  2000/ 2250 batches | lr 0.02 | ms/batch 13.82 | loss  6.19
INFO:root:| epoch   1 |  2200/ 2250 batches | lr 0.02 | ms/batch 12.90 | loss  6.03
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   1 | time: 32.08s | valid loss  6.10 | valid ppl   444.56
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   2 |   200/ 2250 batches | lr 0.02 | ms/batch 14.76 | loss  5.90
INFO:root:| epoch   2 |   400/ 2250 batches | lr 0.02 | ms/batch 12.39 | loss  5.76
INFO:root:| epoch   2 |   600/ 2250 batches | lr 0.02 | ms/batch 14.00 | loss  5.67
INFO:root:| epoch   2 |   800/ 2250 batches | lr 0.02 | ms/batch 11.94 | loss  5.62
INFO:root:| epoch   2 |  1000/ 2250 batches | lr 0.02 | ms/batch 11.92 | loss  5.56
INFO:root:| epoch   2 |  1200/ 2250 batches | lr 0.02 | ms/batch 11.78 | loss  5.54
INFO:root:| epoch   2 |  1400/ 2250 batches | lr 0.02 | ms/batch 14.35 | loss  5.52
INFO:root:| epoch   2 |  1600/ 2250 batches | lr 0.02 | ms/batch 12.16 | loss  5.49
INFO:root:| epoch   2 |  1800/ 2250 batches | lr 0.02 | ms/batch 13.96 | loss  5.48
INFO:root:| epoch   2 |  2000/ 2250 batches | lr 0.02 | ms/batch 12.59 | loss  5.48
INFO:root:| epoch   2 |  2200/ 2250 batches | lr 0.02 | ms/batch 13.37 | loss  5.45
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   2 | time: 29.60s | valid loss  5.64 | valid ppl   281.93
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   3 |   200/ 2250 batches | lr 0.02 | ms/batch 12.61 | loss  5.45
INFO:root:| epoch   3 |   400/ 2250 batches | lr 0.02 | ms/batch 11.86 | loss  5.41
INFO:root:| epoch   3 |   600/ 2250 batches | lr 0.02 | ms/batch 14.94 | loss  5.40
INFO:root:| epoch   3 |   800/ 2250 batches | lr 0.02 | ms/batch 12.54 | loss  5.41
INFO:root:| epoch   3 |  1000/ 2250 batches | lr 0.02 | ms/batch 14.39 | loss  5.39
INFO:root:| epoch   3 |  1200/ 2250 batches | lr 0.02 | ms/batch 11.77 | loss  5.39
INFO:root:| epoch   3 |  1400/ 2250 batches | lr 0.02 | ms/batch 14.48 | loss  5.38
INFO:root:| epoch   3 |  1600/ 2250 batches | lr 0.02 | ms/batch 12.20 | loss  5.37
INFO:root:| epoch   3 |  1800/ 2250 batches | lr 0.02 | ms/batch 11.94 | loss  5.36
INFO:root:| epoch   3 |  2000/ 2250 batches | lr 0.02 | ms/batch 11.77 | loss  5.36
INFO:root:| epoch   3 |  2200/ 2250 batches | lr 0.02 | ms/batch 14.34 | loss  5.34
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   3 | time: 29.52s | valid loss  5.56 | valid ppl   258.80
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   4 |   200/ 2250 batches | lr 0.02 | ms/batch 12.81 | loss  5.35
INFO:root:| epoch   4 |   400/ 2250 batches | lr 0.02 | ms/batch 13.46 | loss  5.31
INFO:root:| epoch   4 |   600/ 2250 batches | lr 0.02 | ms/batch 13.18 | loss  5.31
INFO:root:| epoch   4 |   800/ 2250 batches | lr 0.02 | ms/batch 13.26 | loss  5.32
INFO:root:| epoch   4 |  1000/ 2250 batches | lr 0.02 | ms/batch 12.29 | loss  5.30
INFO:root:| epoch   4 |  1200/ 2250 batches | lr 0.02 | ms/batch 11.83 | loss  5.30
INFO:root:| epoch   4 |  1400/ 2250 batches | lr 0.02 | ms/batch 13.02 | loss  5.30
INFO:root:| epoch   4 |  1600/ 2250 batches | lr 0.02 | ms/batch 13.14 | loss  5.28
INFO:root:| epoch   4 |  1800/ 2250 batches | lr 0.02 | ms/batch 13.68 | loss  5.27
INFO:root:| epoch   4 |  2000/ 2250 batches | lr 0.02 | ms/batch 12.54 | loss  5.28
INFO:root:| epoch   4 |  2200/ 2250 batches | lr 0.02 | ms/batch 14.30 | loss  5.25
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   4 | time: 29.72s | valid loss  5.49 | valid ppl   242.95
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   5 |   200/ 2250 batches | lr 0.02 | ms/batch 12.86 | loss  5.26
INFO:root:| epoch   5 |   400/ 2250 batches | lr 0.02 | ms/batch 13.98 | loss  5.22
INFO:root:| epoch   5 |   600/ 2250 batches | lr 0.02 | ms/batch 11.94 | loss  5.22
INFO:root:| epoch   5 |   800/ 2250 batches | lr 0.02 | ms/batch 14.42 | loss  5.23
INFO:root:| epoch   5 |  1000/ 2250 batches | lr 0.02 | ms/batch 13.35 | loss  5.21
INFO:root:| epoch   5 |  1200/ 2250 batches | lr 0.02 | ms/batch 16.27 | loss  5.22
INFO:root:| epoch   5 |  1400/ 2250 batches | lr 0.02 | ms/batch 14.64 | loss  5.21
INFO:root:| epoch   5 |  1600/ 2250 batches | lr 0.02 | ms/batch 12.53 | loss  5.19
INFO:root:| epoch   5 |  1800/ 2250 batches | lr 0.02 | ms/batch 14.30 | loss  5.18
INFO:root:| epoch   5 |  2000/ 2250 batches | lr 0.02 | ms/batch 11.68 | loss  5.19
INFO:root:| epoch   5 |  2200/ 2250 batches | lr 0.02 | ms/batch 14.14 | loss  5.16
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   5 | time: 31.03s | valid loss  5.43 | valid ppl   227.13
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   6 |   200/ 2250 batches | lr 0.02 | ms/batch 12.62 | loss  5.17
INFO:root:| epoch   6 |   400/ 2250 batches | lr 0.02 | ms/batch 14.11 | loss  5.13
INFO:root:| epoch   6 |   600/ 2250 batches | lr 0.02 | ms/batch 12.57 | loss  5.12
INFO:root:| epoch   6 |   800/ 2250 batches | lr 0.02 | ms/batch 13.45 | loss  5.14
INFO:root:| epoch   6 |  1000/ 2250 batches | lr 0.02 | ms/batch 11.89 | loss  5.11
INFO:root:| epoch   6 |  1200/ 2250 batches | lr 0.02 | ms/batch 11.72 | loss  5.12
INFO:root:| epoch   6 |  1400/ 2250 batches | lr 0.02 | ms/batch 11.70 | loss  5.11
INFO:root:| epoch   6 |  1600/ 2250 batches | lr 0.02 | ms/batch 14.52 | loss  5.10
INFO:root:| epoch   6 |  1800/ 2250 batches | lr 0.02 | ms/batch 12.57 | loss  5.09
INFO:root:| epoch   6 |  2000/ 2250 batches | lr 0.02 | ms/batch 13.83 | loss  5.09
INFO:root:| epoch   6 |  2200/ 2250 batches | lr 0.02 | ms/batch 12.51 | loss  5.05
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   6 | time: 29.62s | valid loss  5.35 | valid ppl   211.27
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   7 |   200/ 2250 batches | lr 0.02 | ms/batch 12.19 | loss  5.07
INFO:root:| epoch   7 |   400/ 2250 batches | lr 0.02 | ms/batch 11.90 | loss  5.02
INFO:root:| epoch   7 |   600/ 2250 batches | lr 0.02 | ms/batch 13.81 | loss  5.01
INFO:root:| epoch   7 |   800/ 2250 batches | lr 0.02 | ms/batch 12.39 | loss  5.04
INFO:root:| epoch   7 |  1000/ 2250 batches | lr 0.02 | ms/batch 14.79 | loss  5.01
INFO:root:| epoch   7 |  1200/ 2250 batches | lr 0.02 | ms/batch 12.22 | loss  5.02
INFO:root:| epoch   7 |  1400/ 2250 batches | lr 0.02 | ms/batch 15.61 | loss  5.01
INFO:root:| epoch   7 |  1600/ 2250 batches | lr 0.02 | ms/batch 11.81 | loss  5.00
INFO:root:| epoch   7 |  1800/ 2250 batches | lr 0.02 | ms/batch 11.90 | loss  4.98
INFO:root:| epoch   7 |  2000/ 2250 batches | lr 0.02 | ms/batch 11.76 | loss  4.99
INFO:root:| epoch   7 |  2200/ 2250 batches | lr 0.02 | ms/batch 11.70 | loss  4.95
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   7 | time: 29.11s | valid loss  5.28 | valid ppl   196.85
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   8 |   200/ 2250 batches | lr 0.02 | ms/batch 13.89 | loss  4.97
INFO:root:| epoch   8 |   400/ 2250 batches | lr 0.02 | ms/batch 13.35 | loss  4.92
INFO:root:| epoch   8 |   600/ 2250 batches | lr 0.02 | ms/batch 13.55 | loss  4.91
INFO:root:| epoch   8 |   800/ 2250 batches | lr 0.02 | ms/batch 13.70 | loss  4.94
INFO:root:| epoch   8 |  1000/ 2250 batches | lr 0.02 | ms/batch 12.40 | loss  4.91
INFO:root:| epoch   8 |  1200/ 2250 batches | lr 0.02 | ms/batch 11.90 | loss  4.93
INFO:root:| epoch   8 |  1400/ 2250 batches | lr 0.02 | ms/batch 11.72 | loss  4.92
INFO:root:| epoch   8 |  1600/ 2250 batches | lr 0.02 | ms/batch 13.00 | loss  4.91
INFO:root:| epoch   8 |  1800/ 2250 batches | lr 0.02 | ms/batch 17.48 | loss  4.90
INFO:root:| epoch   8 |  2000/ 2250 batches | lr 0.02 | ms/batch 15.06 | loss  4.90
INFO:root:| epoch   8 |  2200/ 2250 batches | lr 0.02 | ms/batch 17.36 | loss  4.86
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   8 | time: 32.00s | valid loss  5.22 | valid ppl   185.29
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   9 |   200/ 2250 batches | lr 0.02 | ms/batch 12.79 | loss  4.89
INFO:root:| epoch   9 |   400/ 2250 batches | lr 0.02 | ms/batch 14.62 | loss  4.84
INFO:root:| epoch   9 |   600/ 2250 batches | lr 0.02 | ms/batch 47.86 | loss  4.83
INFO:root:| epoch   9 |   800/ 2250 batches | lr 0.02 | ms/batch 44.74 | loss  4.86
INFO:root:| epoch   9 |  1000/ 2250 batches | lr 0.02 | ms/batch 55.24 | loss  4.83
INFO:root:| epoch   9 |  1200/ 2250 batches | lr 0.02 | ms/batch 38.62 | loss  4.86
INFO:root:| epoch   9 |  1400/ 2250 batches | lr 0.02 | ms/batch 23.25 | loss  4.85
INFO:root:| epoch   9 |  1600/ 2250 batches | lr 0.02 | ms/batch 27.35 | loss  4.84
INFO:root:| epoch   9 |  1800/ 2250 batches | lr 0.02 | ms/batch 22.91 | loss  4.83
INFO:root:| epoch   9 |  2000/ 2250 batches | lr 0.02 | ms/batch 25.10 | loss  4.83
INFO:root:| epoch   9 |  2200/ 2250 batches | lr 0.02 | ms/batch 17.73 | loss  4.80
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   9 | time: 67.37s | valid loss  5.17 | valid ppl   176.74
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  10 |   200/ 2250 batches | lr 0.02 | ms/batch 22.41 | loss  4.82
INFO:root:| epoch  10 |   400/ 2250 batches | lr 0.02 | ms/batch 27.69 | loss  4.78
INFO:root:| epoch  10 |   600/ 2250 batches | lr 0.02 | ms/batch 20.95 | loss  4.78
INFO:root:| epoch  10 |   800/ 2250 batches | lr 0.02 | ms/batch 18.48 | loss  4.81
INFO:root:| epoch  10 |  1000/ 2250 batches | lr 0.02 | ms/batch 16.51 | loss  4.77
INFO:root:| epoch  10 |  1200/ 2250 batches | lr 0.02 | ms/batch 21.56 | loss  4.81
INFO:root:| epoch  10 |  1400/ 2250 batches | lr 0.02 | ms/batch 24.68 | loss  4.79
INFO:root:| epoch  10 |  1600/ 2250 batches | lr 0.02 | ms/batch 21.36 | loss  4.79
INFO:root:| epoch  10 |  1800/ 2250 batches | lr 0.02 | ms/batch 33.87 | loss  4.78
INFO:root:| epoch  10 |  2000/ 2250 batches | lr 0.02 | ms/batch 30.04 | loss  4.78
INFO:root:| epoch  10 |  2200/ 2250 batches | lr 0.02 | ms/batch 22.13 | loss  4.75
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  10 | time: 60.45s | valid loss  5.14 | valid ppl   170.49
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:=========================================================================================
INFO:root:| End of training | test loss  5.31 | test ppl   202.84
INFO:root:=========================================================================================
INFO:root:----------- new value of n = 6, k = 1 -----------
INFO:root:Loading data
INFO:root:Vocab size 2005
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:| epoch   1 |   200/ 1710 batches | lr 0.02 | ms/batch 37.79 | loss  7.53
INFO:root:| epoch   1 |   400/ 1710 batches | lr 0.02 | ms/batch 23.99 | loss  7.26
INFO:root:| epoch   1 |   600/ 1710 batches | lr 0.02 | ms/batch 16.23 | loss  6.99
INFO:root:| epoch   1 |   800/ 1710 batches | lr 0.02 | ms/batch 18.02 | loss  6.64
INFO:root:| epoch   1 |  1000/ 1710 batches | lr 0.02 | ms/batch 21.85 | loss  6.21
INFO:root:| epoch   1 |  1200/ 1710 batches | lr 0.02 | ms/batch 17.12 | loss  5.69
INFO:root:| epoch   1 |  1400/ 1710 batches | lr 0.02 | ms/batch 18.37 | loss  5.20
INFO:root:| epoch   1 |  1600/ 1710 batches | lr 0.02 | ms/batch 23.37 | loss  4.85
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   1 | time: 37.69s | valid loss  4.89 | valid ppl   133.16
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   2 |   200/ 1710 batches | lr 0.02 | ms/batch 33.72 | loss  4.59
INFO:root:| epoch   2 |   400/ 1710 batches | lr 0.02 | ms/batch 19.08 | loss  4.41
INFO:root:| epoch   2 |   600/ 1710 batches | lr 0.02 | ms/batch 18.35 | loss  4.29
INFO:root:| epoch   2 |   800/ 1710 batches | lr 0.02 | ms/batch 14.27 | loss  4.16
INFO:root:| epoch   2 |  1000/ 1710 batches | lr 0.02 | ms/batch 16.04 | loss  4.11
INFO:root:| epoch   2 |  1200/ 1710 batches | lr 0.02 | ms/batch 22.22 | loss  4.10
INFO:root:| epoch   2 |  1400/ 1710 batches | lr 0.02 | ms/batch 22.22 | loss  4.08
INFO:root:| epoch   2 |  1600/ 1710 batches | lr 0.02 | ms/batch 13.66 | loss  4.03
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   2 | time: 34.72s | valid loss  4.31 | valid ppl    74.47
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   3 |   200/ 1710 batches | lr 0.02 | ms/batch 14.12 | loss  4.04
INFO:root:| epoch   3 |   400/ 1710 batches | lr 0.02 | ms/batch 14.53 | loss  4.03
INFO:root:| epoch   3 |   600/ 1710 batches | lr 0.02 | ms/batch 17.47 | loss  4.03
INFO:root:| epoch   3 |   800/ 1710 batches | lr 0.02 | ms/batch 14.91 | loss  3.98
INFO:root:| epoch   3 |  1000/ 1710 batches | lr 0.02 | ms/batch 18.50 | loss  3.99
INFO:root:| epoch   3 |  1200/ 1710 batches | lr 0.02 | ms/batch 16.92 | loss  4.02
INFO:root:| epoch   3 |  1400/ 1710 batches | lr 0.02 | ms/batch 15.97 | loss  4.01
INFO:root:| epoch   3 |  1600/ 1710 batches | lr 0.02 | ms/batch 17.85 | loss  3.98
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   3 | time: 28.29s | valid loss  4.26 | valid ppl    71.10
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   4 |   200/ 1710 batches | lr 0.02 | ms/batch 17.74 | loss  4.00
INFO:root:| epoch   4 |   400/ 1710 batches | lr 0.02 | ms/batch 17.34 | loss  4.00
INFO:root:| epoch   4 |   600/ 1710 batches | lr 0.02 | ms/batch 14.29 | loss  4.01
INFO:root:| epoch   4 |   800/ 1710 batches | lr 0.02 | ms/batch 28.27 | loss  3.96
INFO:root:| epoch   4 |  1000/ 1710 batches | lr 0.02 | ms/batch 31.11 | loss  3.97
INFO:root:| epoch   4 |  1200/ 1710 batches | lr 0.02 | ms/batch 16.01 | loss  4.00
INFO:root:| epoch   4 |  1400/ 1710 batches | lr 0.02 | ms/batch 16.98 | loss  4.00
INFO:root:| epoch   4 |  1600/ 1710 batches | lr 0.02 | ms/batch 21.35 | loss  3.96
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   4 | time: 34.52s | valid loss  4.26 | valid ppl    70.47
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   5 |   200/ 1710 batches | lr 0.02 | ms/batch 18.22 | loss  3.99
INFO:root:| epoch   5 |   400/ 1710 batches | lr 0.02 | ms/batch 18.37 | loss  3.99
INFO:root:| epoch   5 |   600/ 1710 batches | lr 0.02 | ms/batch 39.01 | loss  4.00
INFO:root:| epoch   5 |   800/ 1710 batches | lr 0.02 | ms/batch 27.64 | loss  3.95
INFO:root:| epoch   5 |  1000/ 1710 batches | lr 0.02 | ms/batch 18.00 | loss  3.96
INFO:root:| epoch   5 |  1200/ 1710 batches | lr 0.02 | ms/batch 16.01 | loss  3.99
INFO:root:| epoch   5 |  1400/ 1710 batches | lr 0.02 | ms/batch 18.88 | loss  3.99
INFO:root:| epoch   5 |  1600/ 1710 batches | lr 0.02 | ms/batch 18.77 | loss  3.95
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   5 | time: 36.99s | valid loss  4.25 | valid ppl    70.17
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   6 |   200/ 1710 batches | lr 0.02 | ms/batch 20.38 | loss  3.98
INFO:root:| epoch   6 |   400/ 1710 batches | lr 0.02 | ms/batch 19.67 | loss  3.98
INFO:root:| epoch   6 |   600/ 1710 batches | lr 0.02 | ms/batch 15.72 | loss  3.99
INFO:root:| epoch   6 |   800/ 1710 batches | lr 0.02 | ms/batch 16.77 | loss  3.94
INFO:root:| epoch   6 |  1000/ 1710 batches | lr 0.02 | ms/batch 17.60 | loss  3.95
INFO:root:| epoch   6 |  1200/ 1710 batches | lr 0.02 | ms/batch 15.15 | loss  3.98
INFO:root:| epoch   6 |  1400/ 1710 batches | lr 0.02 | ms/batch 17.14 | loss  3.98
INFO:root:| epoch   6 |  1600/ 1710 batches | lr 0.02 | ms/batch 13.81 | loss  3.94
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   6 | time: 29.09s | valid loss  4.25 | valid ppl    69.93
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   7 |   200/ 1710 batches | lr 0.02 | ms/batch 17.92 | loss  3.97
INFO:root:| epoch   7 |   400/ 1710 batches | lr 0.02 | ms/batch 14.41 | loss  3.97
INFO:root:| epoch   7 |   600/ 1710 batches | lr 0.02 | ms/batch 17.94 | loss  3.98
INFO:root:| epoch   7 |   800/ 1710 batches | lr 0.02 | ms/batch 17.27 | loss  3.93
INFO:root:| epoch   7 |  1000/ 1710 batches | lr 0.02 | ms/batch 14.00 | loss  3.94
INFO:root:| epoch   7 |  1200/ 1710 batches | lr 0.02 | ms/batch 22.92 | loss  3.97
INFO:root:| epoch   7 |  1400/ 1710 batches | lr 0.02 | ms/batch 21.41 | loss  3.97
INFO:root:| epoch   7 |  1600/ 1710 batches | lr 0.02 | ms/batch 17.44 | loss  3.93
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   7 | time: 31.51s | valid loss  4.24 | valid ppl    69.72
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   8 |   200/ 1710 batches | lr 0.02 | ms/batch 20.34 | loss  3.96
INFO:root:| epoch   8 |   400/ 1710 batches | lr 0.02 | ms/batch 18.73 | loss  3.96
INFO:root:| epoch   8 |   600/ 1710 batches | lr 0.02 | ms/batch 16.92 | loss  3.97
INFO:root:| epoch   8 |   800/ 1710 batches | lr 0.02 | ms/batch 15.14 | loss  3.92
INFO:root:| epoch   8 |  1000/ 1710 batches | lr 0.02 | ms/batch 17.99 | loss  3.93
INFO:root:| epoch   8 |  1200/ 1710 batches | lr 0.02 | ms/batch 16.09 | loss  3.96
INFO:root:| epoch   8 |  1400/ 1710 batches | lr 0.02 | ms/batch 15.40 | loss  3.96
INFO:root:| epoch   8 |  1600/ 1710 batches | lr 0.02 | ms/batch 18.04 | loss  3.92
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   8 | time: 29.53s | valid loss  4.24 | valid ppl    69.55
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   9 |   200/ 1710 batches | lr 0.02 | ms/batch 17.79 | loss  3.95
INFO:root:| epoch   9 |   400/ 1710 batches | lr 0.02 | ms/batch 16.54 | loss  3.95
INFO:root:| epoch   9 |   600/ 1710 batches | lr 0.02 | ms/batch 16.84 | loss  3.96
INFO:root:| epoch   9 |   800/ 1710 batches | lr 0.02 | ms/batch 39.19 | loss  3.91
INFO:root:| epoch   9 |  1000/ 1710 batches | lr 0.02 | ms/batch 31.39 | loss  3.92
INFO:root:| epoch   9 |  1200/ 1710 batches | lr 0.02 | ms/batch 22.59 | loss  3.95
INFO:root:| epoch   9 |  1400/ 1710 batches | lr 0.02 | ms/batch 15.48 | loss  3.95
INFO:root:| epoch   9 |  1600/ 1710 batches | lr 0.02 | ms/batch 20.44 | loss  3.92
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   9 | time: 38.30s | valid loss  4.24 | valid ppl    69.40
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  10 |   200/ 1710 batches | lr 0.02 | ms/batch 17.57 | loss  3.94
INFO:root:| epoch  10 |   400/ 1710 batches | lr 0.02 | ms/batch 20.07 | loss  3.95
INFO:root:| epoch  10 |   600/ 1710 batches | lr 0.02 | ms/batch 18.78 | loss  3.95
INFO:root:| epoch  10 |   800/ 1710 batches | lr 0.02 | ms/batch 21.32 | loss  3.90
INFO:root:| epoch  10 |  1000/ 1710 batches | lr 0.02 | ms/batch 21.90 | loss  3.91
INFO:root:| epoch  10 |  1200/ 1710 batches | lr 0.02 | ms/batch 19.21 | loss  3.94
INFO:root:| epoch  10 |  1400/ 1710 batches | lr 0.02 | ms/batch 19.85 | loss  3.94
INFO:root:| epoch  10 |  1600/ 1710 batches | lr 0.02 | ms/batch 18.06 | loss  3.91
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  10 | time: 33.63s | valid loss  4.24 | valid ppl    69.29
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:=========================================================================================
INFO:root:| End of training | test loss  4.39 | test ppl    80.64
INFO:root:=========================================================================================
INFO:root:----------- new value of n = 6, k = 2 -----------
INFO:root:Loading data
INFO:root:Vocab size 3005
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:| epoch   1 |   200/ 1890 batches | lr 0.02 | ms/batch 20.65 | loss  7.97
INFO:root:| epoch   1 |   400/ 1890 batches | lr 0.02 | ms/batch 21.96 | loss  7.73
INFO:root:| epoch   1 |   600/ 1890 batches | lr 0.02 | ms/batch 18.83 | loss  7.50
INFO:root:| epoch   1 |   800/ 1890 batches | lr 0.02 | ms/batch 21.10 | loss  7.24
INFO:root:| epoch   1 |  1000/ 1890 batches | lr 0.02 | ms/batch 19.35 | loss  6.90
INFO:root:| epoch   1 |  1200/ 1890 batches | lr 0.02 | ms/batch 21.97 | loss  6.43
INFO:root:| epoch   1 |  1400/ 1890 batches | lr 0.02 | ms/batch 21.80 | loss  5.95
INFO:root:| epoch   1 |  1600/ 1890 batches | lr 0.02 | ms/batch 34.75 | loss  5.60
INFO:root:| epoch   1 |  1800/ 1890 batches | lr 0.02 | ms/batch 25.79 | loss  5.35
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   1 | time: 44.75s | valid loss  5.24 | valid ppl   187.76
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   2 |   200/ 1890 batches | lr 0.02 | ms/batch 22.67 | loss  5.13
INFO:root:| epoch   2 |   400/ 1890 batches | lr 0.02 | ms/batch 12.24 | loss  4.94
INFO:root:| epoch   2 |   600/ 1890 batches | lr 0.02 | ms/batch 15.40 | loss  4.81
INFO:root:| epoch   2 |   800/ 1890 batches | lr 0.02 | ms/batch 19.62 | loss  4.77
INFO:root:| epoch   2 |  1000/ 1890 batches | lr 0.02 | ms/batch 23.07 | loss  4.73
INFO:root:| epoch   2 |  1200/ 1890 batches | lr 0.02 | ms/batch 31.19 | loss  4.63
INFO:root:| epoch   2 |  1400/ 1890 batches | lr 0.02 | ms/batch 21.87 | loss  4.62
INFO:root:| epoch   2 |  1600/ 1890 batches | lr 0.02 | ms/batch 32.35 | loss  4.68
INFO:root:| epoch   2 |  1800/ 1890 batches | lr 0.02 | ms/batch 23.20 | loss  4.65
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   2 | time: 42.17s | valid loss  4.75 | valid ppl   115.12
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   3 |   200/ 1890 batches | lr 0.02 | ms/batch 19.80 | loss  4.63
INFO:root:| epoch   3 |   400/ 1890 batches | lr 0.02 | ms/batch 21.42 | loss  4.58
INFO:root:| epoch   3 |   600/ 1890 batches | lr 0.02 | ms/batch 19.87 | loss  4.56
INFO:root:| epoch   3 |   800/ 1890 batches | lr 0.02 | ms/batch 19.00 | loss  4.61
INFO:root:| epoch   3 |  1000/ 1890 batches | lr 0.02 | ms/batch 20.04 | loss  4.60
INFO:root:| epoch   3 |  1200/ 1890 batches | lr 0.02 | ms/batch 16.54 | loss  4.53
INFO:root:| epoch   3 |  1400/ 1890 batches | lr 0.02 | ms/batch 25.60 | loss  4.53
INFO:root:| epoch   3 |  1600/ 1890 batches | lr 0.02 | ms/batch 21.95 | loss  4.61
INFO:root:| epoch   3 |  1800/ 1890 batches | lr 0.02 | ms/batch 26.44 | loss  4.58
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   3 | time: 40.48s | valid loss  4.70 | valid ppl   110.27
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   4 |   200/ 1890 batches | lr 0.02 | ms/batch 20.32 | loss  4.58
INFO:root:| epoch   4 |   400/ 1890 batches | lr 0.02 | ms/batch 19.92 | loss  4.54
INFO:root:| epoch   4 |   600/ 1890 batches | lr 0.02 | ms/batch 25.27 | loss  4.52
INFO:root:| epoch   4 |   800/ 1890 batches | lr 0.02 | ms/batch 24.88 | loss  4.57
INFO:root:| epoch   4 |  1000/ 1890 batches | lr 0.02 | ms/batch 23.32 | loss  4.57
INFO:root:| epoch   4 |  1200/ 1890 batches | lr 0.02 | ms/batch 26.16 | loss  4.51
INFO:root:| epoch   4 |  1400/ 1890 batches | lr 0.02 | ms/batch 20.13 | loss  4.51
INFO:root:| epoch   4 |  1600/ 1890 batches | lr 0.02 | ms/batch 17.66 | loss  4.58
INFO:root:| epoch   4 |  1800/ 1890 batches | lr 0.02 | ms/batch 24.92 | loss  4.55
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   4 | time: 43.03s | valid loss  4.69 | valid ppl   108.43
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   5 |   200/ 1890 batches | lr 0.02 | ms/batch 20.08 | loss  4.55
INFO:root:| epoch   5 |   400/ 1890 batches | lr 0.02 | ms/batch 19.40 | loss  4.52
INFO:root:| epoch   5 |   600/ 1890 batches | lr 0.02 | ms/batch 19.13 | loss  4.50
INFO:root:| epoch   5 |   800/ 1890 batches | lr 0.02 | ms/batch 15.78 | loss  4.54
INFO:root:| epoch   5 |  1000/ 1890 batches | lr 0.02 | ms/batch 20.93 | loss  4.55
INFO:root:| epoch   5 |  1200/ 1890 batches | lr 0.02 | ms/batch 19.59 | loss  4.48
INFO:root:| epoch   5 |  1400/ 1890 batches | lr 0.02 | ms/batch 19.29 | loss  4.48
INFO:root:| epoch   5 |  1600/ 1890 batches | lr 0.02 | ms/batch 17.94 | loss  4.56
INFO:root:| epoch   5 |  1800/ 1890 batches | lr 0.02 | ms/batch 20.80 | loss  4.53
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   5 | time: 37.18s | valid loss  4.67 | valid ppl   106.89
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   6 |   200/ 1890 batches | lr 0.02 | ms/batch 19.61 | loss  4.53
INFO:root:| epoch   6 |   400/ 1890 batches | lr 0.02 | ms/batch 19.04 | loss  4.49
INFO:root:| epoch   6 |   600/ 1890 batches | lr 0.02 | ms/batch 19.48 | loss  4.47
INFO:root:| epoch   6 |   800/ 1890 batches | lr 0.02 | ms/batch 19.77 | loss  4.52
INFO:root:| epoch   6 |  1000/ 1890 batches | lr 0.02 | ms/batch 16.54 | loss  4.52
INFO:root:| epoch   6 |  1200/ 1890 batches | lr 0.02 | ms/batch 22.50 | loss  4.46
INFO:root:| epoch   6 |  1400/ 1890 batches | lr 0.02 | ms/batch 20.15 | loss  4.46
INFO:root:| epoch   6 |  1600/ 1890 batches | lr 0.02 | ms/batch 19.76 | loss  4.53
INFO:root:| epoch   6 |  1800/ 1890 batches | lr 0.02 | ms/batch 17.44 | loss  4.50
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   6 | time: 37.45s | valid loss  4.66 | valid ppl   105.44
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   7 |   200/ 1890 batches | lr 0.02 | ms/batch 20.71 | loss  4.51
INFO:root:| epoch   7 |   400/ 1890 batches | lr 0.02 | ms/batch 26.31 | loss  4.47
INFO:root:| epoch   7 |   600/ 1890 batches | lr 0.02 | ms/batch 19.85 | loss  4.45
INFO:root:| epoch   7 |   800/ 1890 batches | lr 0.02 | ms/batch 20.14 | loss  4.49
INFO:root:| epoch   7 |  1000/ 1890 batches | lr 0.02 | ms/batch 19.86 | loss  4.49
INFO:root:| epoch   7 |  1200/ 1890 batches | lr 0.02 | ms/batch 20.76 | loss  4.44
INFO:root:| epoch   7 |  1400/ 1890 batches | lr 0.02 | ms/batch 17.00 | loss  4.44
INFO:root:| epoch   7 |  1600/ 1890 batches | lr 0.02 | ms/batch 19.17 | loss  4.51
INFO:root:| epoch   7 |  1800/ 1890 batches | lr 0.02 | ms/batch 22.59 | loss  4.48
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   7 | time: 40.99s | valid loss  4.64 | valid ppl   104.05
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   8 |   200/ 1890 batches | lr 0.02 | ms/batch 19.77 | loss  4.48
INFO:root:| epoch   8 |   400/ 1890 batches | lr 0.02 | ms/batch 21.44 | loss  4.44
INFO:root:| epoch   8 |   600/ 1890 batches | lr 0.02 | ms/batch 34.33 | loss  4.42
INFO:root:| epoch   8 |   800/ 1890 batches | lr 0.02 | ms/batch 16.64 | loss  4.47
INFO:root:| epoch   8 |  1000/ 1890 batches | lr 0.02 | ms/batch 12.88 | loss  4.47
INFO:root:| epoch   8 |  1200/ 1890 batches | lr 0.02 | ms/batch 16.67 | loss  4.42
INFO:root:| epoch   8 |  1400/ 1890 batches | lr 0.02 | ms/batch 20.06 | loss  4.41
INFO:root:| epoch   8 |  1600/ 1890 batches | lr 0.02 | ms/batch 35.43 | loss  4.48
INFO:root:| epoch   8 |  1800/ 1890 batches | lr 0.02 | ms/batch 42.35 | loss  4.45
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   8 | time: 45.92s | valid loss  4.63 | valid ppl   102.70
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   9 |   200/ 1890 batches | lr 0.02 | ms/batch 21.27 | loss  4.45
INFO:root:| epoch   9 |   400/ 1890 batches | lr 0.02 | ms/batch 16.34 | loss  4.41
INFO:root:| epoch   9 |   600/ 1890 batches | lr 0.02 | ms/batch 16.61 | loss  4.40
INFO:root:| epoch   9 |   800/ 1890 batches | lr 0.02 | ms/batch 19.61 | loss  4.44
INFO:root:| epoch   9 |  1000/ 1890 batches | lr 0.02 | ms/batch 27.98 | loss  4.44
INFO:root:| epoch   9 |  1200/ 1890 batches | lr 0.02 | ms/batch 18.81 | loss  4.39
INFO:root:| epoch   9 |  1400/ 1890 batches | lr 0.02 | ms/batch 15.39 | loss  4.39
INFO:root:| epoch   9 |  1600/ 1890 batches | lr 0.02 | ms/batch 11.61 | loss  4.46
INFO:root:| epoch   9 |  1800/ 1890 batches | lr 0.02 | ms/batch 14.72 | loss  4.42
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   9 | time: 33.89s | valid loss  4.62 | valid ppl   101.39
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  10 |   200/ 1890 batches | lr 0.02 | ms/batch 14.01 | loss  4.43
INFO:root:| epoch  10 |   400/ 1890 batches | lr 0.02 | ms/batch 12.09 | loss  4.38
INFO:root:| epoch  10 |   600/ 1890 batches | lr 0.02 | ms/batch 14.52 | loss  4.37
INFO:root:| epoch  10 |   800/ 1890 batches | lr 0.02 | ms/batch 11.73 | loss  4.41
INFO:root:| epoch  10 |  1000/ 1890 batches | lr 0.02 | ms/batch 14.58 | loss  4.41
INFO:root:| epoch  10 |  1200/ 1890 batches | lr 0.02 | ms/batch 11.65 | loss  4.37
INFO:root:| epoch  10 |  1400/ 1890 batches | lr 0.02 | ms/batch 15.86 | loss  4.36
INFO:root:| epoch  10 |  1600/ 1890 batches | lr 0.02 | ms/batch 15.44 | loss  4.43
INFO:root:| epoch  10 |  1800/ 1890 batches | lr 0.02 | ms/batch 13.82 | loss  4.39
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  10 | time: 26.26s | valid loss  4.61 | valid ppl   100.12
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:=========================================================================================
INFO:root:| End of training | test loss  4.79 | test ppl   120.45
INFO:root:=========================================================================================
INFO:root:----------- new value of n = 6, k = 3 -----------
INFO:root:Loading data
INFO:root:Vocab size 4005
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:| epoch   1 |   200/ 2070 batches | lr 0.02 | ms/batch 12.04 | loss  8.28
INFO:root:| epoch   1 |   400/ 2070 batches | lr 0.02 | ms/batch 13.71 | loss  8.09
INFO:root:| epoch   1 |   600/ 2070 batches | lr 0.02 | ms/batch 13.09 | loss  7.92
INFO:root:| epoch   1 |   800/ 2070 batches | lr 0.02 | ms/batch 14.34 | loss  7.73
INFO:root:| epoch   1 |  1000/ 2070 batches | lr 0.02 | ms/batch 11.47 | loss  7.50
INFO:root:| epoch   1 |  1200/ 2070 batches | lr 0.02 | ms/batch 15.08 | loss  7.20
INFO:root:| epoch   1 |  1400/ 2070 batches | lr 0.02 | ms/batch 11.56 | loss  6.85
INFO:root:| epoch   1 |  1600/ 2070 batches | lr 0.02 | ms/batch 14.94 | loss  6.46
INFO:root:| epoch   1 |  1800/ 2070 batches | lr 0.02 | ms/batch 12.73 | loss  6.05
INFO:root:| epoch   1 |  2000/ 2070 batches | lr 0.02 | ms/batch 14.41 | loss  5.77
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   1 | time: 27.84s | valid loss  5.81 | valid ppl   334.06
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   2 |   200/ 2070 batches | lr 0.02 | ms/batch 14.83 | loss  5.53
INFO:root:| epoch   2 |   400/ 2070 batches | lr 0.02 | ms/batch 13.77 | loss  5.45
INFO:root:| epoch   2 |   600/ 2070 batches | lr 0.02 | ms/batch 12.45 | loss  5.25
INFO:root:| epoch   2 |   800/ 2070 batches | lr 0.02 | ms/batch 15.54 | loss  5.25
INFO:root:| epoch   2 |  1000/ 2070 batches | lr 0.02 | ms/batch 12.86 | loss  5.19
INFO:root:| epoch   2 |  1200/ 2070 batches | lr 0.02 | ms/batch 15.12 | loss  5.13
INFO:root:| epoch   2 |  1400/ 2070 batches | lr 0.02 | ms/batch 12.92 | loss  5.15
INFO:root:| epoch   2 |  1600/ 2070 batches | lr 0.02 | ms/batch 15.91 | loss  5.12
INFO:root:| epoch   2 |  1800/ 2070 batches | lr 0.02 | ms/batch 14.17 | loss  5.10
INFO:root:| epoch   2 |  2000/ 2070 batches | lr 0.02 | ms/batch 13.36 | loss  5.10
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   2 | time: 29.54s | valid loss  5.33 | valid ppl   206.67
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   3 |   200/ 2070 batches | lr 0.02 | ms/batch 14.55 | loss  5.07
INFO:root:| epoch   3 |   400/ 2070 batches | lr 0.02 | ms/batch 13.79 | loss  5.13
INFO:root:| epoch   3 |   600/ 2070 batches | lr 0.02 | ms/batch 14.14 | loss  5.01
INFO:root:| epoch   3 |   800/ 2070 batches | lr 0.02 | ms/batch 14.90 | loss  5.07
INFO:root:| epoch   3 |  1000/ 2070 batches | lr 0.02 | ms/batch 12.51 | loss  5.05
INFO:root:| epoch   3 |  1200/ 2070 batches | lr 0.02 | ms/batch 18.47 | loss  5.02
INFO:root:| epoch   3 |  1400/ 2070 batches | lr 0.02 | ms/batch 12.71 | loss  5.05
INFO:root:| epoch   3 |  1600/ 2070 batches | lr 0.02 | ms/batch 16.49 | loss  5.03
INFO:root:| epoch   3 |  1800/ 2070 batches | lr 0.02 | ms/batch 12.61 | loss  5.02
INFO:root:| epoch   3 |  2000/ 2070 batches | lr 0.02 | ms/batch 12.17 | loss  5.01
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   3 | time: 30.15s | valid loss  5.27 | valid ppl   194.59
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   4 |   200/ 2070 batches | lr 0.02 | ms/batch 13.30 | loss  4.99
INFO:root:| epoch   4 |   400/ 2070 batches | lr 0.02 | ms/batch 14.98 | loss  5.06
INFO:root:| epoch   4 |   600/ 2070 batches | lr 0.02 | ms/batch 12.58 | loss  4.95
INFO:root:| epoch   4 |   800/ 2070 batches | lr 0.02 | ms/batch 14.17 | loss  5.01
INFO:root:| epoch   4 |  1000/ 2070 batches | lr 0.02 | ms/batch 14.97 | loss  4.99
INFO:root:| epoch   4 |  1200/ 2070 batches | lr 0.02 | ms/batch 12.72 | loss  4.96
INFO:root:| epoch   4 |  1400/ 2070 batches | lr 0.02 | ms/batch 15.20 | loss  4.99
INFO:root:| epoch   4 |  1600/ 2070 batches | lr 0.02 | ms/batch 14.90 | loss  4.97
INFO:root:| epoch   4 |  1800/ 2070 batches | lr 0.02 | ms/batch 13.34 | loss  4.97
INFO:root:| epoch   4 |  2000/ 2070 batches | lr 0.02 | ms/batch 15.70 | loss  4.96
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   4 | time: 29.56s | valid loss  5.24 | valid ppl   188.36
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   5 |   200/ 2070 batches | lr 0.02 | ms/batch 14.14 | loss  4.94
INFO:root:| epoch   5 |   400/ 2070 batches | lr 0.02 | ms/batch 15.66 | loss  5.01
INFO:root:| epoch   5 |   600/ 2070 batches | lr 0.02 | ms/batch 13.75 | loss  4.91
INFO:root:| epoch   5 |   800/ 2070 batches | lr 0.02 | ms/batch 13.87 | loss  4.96
INFO:root:| epoch   5 |  1000/ 2070 batches | lr 0.02 | ms/batch 15.20 | loss  4.94
INFO:root:| epoch   5 |  1200/ 2070 batches | lr 0.02 | ms/batch 12.54 | loss  4.92
INFO:root:| epoch   5 |  1400/ 2070 batches | lr 0.02 | ms/batch 14.99 | loss  4.94
INFO:root:| epoch   5 |  1600/ 2070 batches | lr 0.02 | ms/batch 12.40 | loss  4.92
INFO:root:| epoch   5 |  1800/ 2070 batches | lr 0.02 | ms/batch 15.47 | loss  4.92
INFO:root:| epoch   5 |  2000/ 2070 batches | lr 0.02 | ms/batch 12.47 | loss  4.92
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   5 | time: 29.27s | valid loss  5.21 | valid ppl   182.71
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   6 |   200/ 2070 batches | lr 0.02 | ms/batch 15.37 | loss  4.90
INFO:root:| epoch   6 |   400/ 2070 batches | lr 0.02 | ms/batch 12.73 | loss  4.96
INFO:root:| epoch   6 |   600/ 2070 batches | lr 0.02 | ms/batch 14.95 | loss  4.86
INFO:root:| epoch   6 |   800/ 2070 batches | lr 0.02 | ms/batch 12.87 | loss  4.90
INFO:root:| epoch   6 |  1000/ 2070 batches | lr 0.02 | ms/batch 13.05 | loss  4.89
INFO:root:| epoch   6 |  1200/ 2070 batches | lr 0.02 | ms/batch 14.38 | loss  4.87
INFO:root:| epoch   6 |  1400/ 2070 batches | lr 0.02 | ms/batch 14.24 | loss  4.89
INFO:root:| epoch   6 |  1600/ 2070 batches | lr 0.02 | ms/batch 13.55 | loss  4.87
INFO:root:| epoch   6 |  1800/ 2070 batches | lr 0.02 | ms/batch 15.87 | loss  4.87
INFO:root:| epoch   6 |  2000/ 2070 batches | lr 0.02 | ms/batch 12.99 | loss  4.86
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   6 | time: 29.50s | valid loss  5.18 | valid ppl   176.97
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   7 |   200/ 2070 batches | lr 0.02 | ms/batch 13.66 | loss  4.85
INFO:root:| epoch   7 |   400/ 2070 batches | lr 0.02 | ms/batch 14.40 | loss  4.91
INFO:root:| epoch   7 |   600/ 2070 batches | lr 0.02 | ms/batch 13.53 | loss  4.81
INFO:root:| epoch   7 |   800/ 2070 batches | lr 0.02 | ms/batch 12.42 | loss  4.85
INFO:root:| epoch   7 |  1000/ 2070 batches | lr 0.02 | ms/batch 13.71 | loss  4.84
INFO:root:| epoch   7 |  1200/ 2070 batches | lr 0.02 | ms/batch 14.16 | loss  4.81
INFO:root:| epoch   7 |  1400/ 2070 batches | lr 0.02 | ms/batch 14.92 | loss  4.84
INFO:root:| epoch   7 |  1600/ 2070 batches | lr 0.02 | ms/batch 12.34 | loss  4.81
INFO:root:| epoch   7 |  1800/ 2070 batches | lr 0.02 | ms/batch 12.97 | loss  4.82
INFO:root:| epoch   7 |  2000/ 2070 batches | lr 0.02 | ms/batch 15.10 | loss  4.81
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   7 | time: 28.61s | valid loss  5.14 | valid ppl   171.11
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   8 |   200/ 2070 batches | lr 0.02 | ms/batch 13.36 | loss  4.79
INFO:root:| epoch   8 |   400/ 2070 batches | lr 0.02 | ms/batch 15.05 | loss  4.85
INFO:root:| epoch   8 |   600/ 2070 batches | lr 0.02 | ms/batch 13.27 | loss  4.76
INFO:root:| epoch   8 |   800/ 2070 batches | lr 0.02 | ms/batch 15.74 | loss  4.79
INFO:root:| epoch   8 |  1000/ 2070 batches | lr 0.02 | ms/batch 12.18 | loss  4.78
INFO:root:| epoch   8 |  1200/ 2070 batches | lr 0.02 | ms/batch 19.36 | loss  4.75
INFO:root:| epoch   8 |  1400/ 2070 batches | lr 0.02 | ms/batch 30.98 | loss  4.78
INFO:root:| epoch   8 |  1600/ 2070 batches | lr 0.02 | ms/batch 25.40 | loss  4.75
INFO:root:| epoch   8 |  1800/ 2070 batches | lr 0.02 | ms/batch 20.88 | loss  4.76
INFO:root:| epoch   8 |  2000/ 2070 batches | lr 0.02 | ms/batch 20.29 | loss  4.75
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   8 | time: 39.60s | valid loss  5.11 | valid ppl   165.30
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   9 |   200/ 2070 batches | lr 0.02 | ms/batch 22.67 | loss  4.73
INFO:root:| epoch   9 |   400/ 2070 batches | lr 0.02 | ms/batch 20.20 | loss  4.79
INFO:root:| epoch   9 |   600/ 2070 batches | lr 0.02 | ms/batch 20.16 | loss  4.71
INFO:root:| epoch   9 |   800/ 2070 batches | lr 0.02 | ms/batch 19.48 | loss  4.73
INFO:root:| epoch   9 |  1000/ 2070 batches | lr 0.02 | ms/batch 21.70 | loss  4.72
INFO:root:| epoch   9 |  1200/ 2070 batches | lr 0.02 | ms/batch 19.65 | loss  4.69
INFO:root:| epoch   9 |  1400/ 2070 batches | lr 0.02 | ms/batch 20.16 | loss  4.72
INFO:root:| epoch   9 |  1600/ 2070 batches | lr 0.02 | ms/batch 23.01 | loss  4.70
INFO:root:| epoch   9 |  1800/ 2070 batches | lr 0.02 | ms/batch 22.54 | loss  4.70
INFO:root:| epoch   9 |  2000/ 2070 batches | lr 0.02 | ms/batch 21.11 | loss  4.70
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   9 | time: 44.00s | valid loss  5.07 | valid ppl   159.87
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  10 |   200/ 2070 batches | lr 0.02 | ms/batch 22.07 | loss  4.68
INFO:root:| epoch  10 |   400/ 2070 batches | lr 0.02 | ms/batch 21.99 | loss  4.74
INFO:root:| epoch  10 |   600/ 2070 batches | lr 0.02 | ms/batch 21.30 | loss  4.66
INFO:root:| epoch  10 |   800/ 2070 batches | lr 0.02 | ms/batch 23.03 | loss  4.67
INFO:root:| epoch  10 |  1000/ 2070 batches | lr 0.02 | ms/batch 21.39 | loss  4.67
INFO:root:| epoch  10 |  1200/ 2070 batches | lr 0.02 | ms/batch 20.37 | loss  4.64
INFO:root:| epoch  10 |  1400/ 2070 batches | lr 0.02 | ms/batch 36.26 | loss  4.67
INFO:root:| epoch  10 |  1600/ 2070 batches | lr 0.02 | ms/batch 27.18 | loss  4.64
INFO:root:| epoch  10 |  1800/ 2070 batches | lr 0.02 | ms/batch 12.95 | loss  4.66
INFO:root:| epoch  10 |  2000/ 2070 batches | lr 0.02 | ms/batch 12.49 | loss  4.65
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  10 | time: 45.27s | valid loss  5.04 | valid ppl   155.08
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:=========================================================================================
INFO:root:| End of training | test loss  5.22 | test ppl   185.45
INFO:root:=========================================================================================
INFO:root:----------- new value of n = 6, k = 4 -----------
INFO:root:Loading data
INFO:root:Vocab size 5005
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:| epoch   1 |   200/ 2250 batches | lr 0.02 | ms/batch 12.99 | loss  8.48
INFO:root:| epoch   1 |   400/ 2250 batches | lr 0.02 | ms/batch 18.10 | loss  8.28
INFO:root:| epoch   1 |   600/ 2250 batches | lr 0.02 | ms/batch 20.13 | loss  8.10
INFO:root:| epoch   1 |   800/ 2250 batches | lr 0.02 | ms/batch 17.55 | loss  7.88
INFO:root:| epoch   1 |  1000/ 2250 batches | lr 0.02 | ms/batch 18.43 | loss  7.61
INFO:root:| epoch   1 |  1200/ 2250 batches | lr 0.02 | ms/batch 15.72 | loss  7.27
INFO:root:| epoch   1 |  1400/ 2250 batches | lr 0.02 | ms/batch 12.50 | loss  6.87
INFO:root:| epoch   1 |  1600/ 2250 batches | lr 0.02 | ms/batch 15.13 | loss  6.51
INFO:root:| epoch   1 |  1800/ 2250 batches | lr 0.02 | ms/batch 21.06 | loss  6.26
INFO:root:| epoch   1 |  2000/ 2250 batches | lr 0.02 | ms/batch 13.94 | loss  6.09
INFO:root:| epoch   1 |  2200/ 2250 batches | lr 0.02 | ms/batch 22.91 | loss  5.96
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   1 | time: 40.73s | valid loss  6.07 | valid ppl   432.78
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   2 |   200/ 2250 batches | lr 0.02 | ms/batch 26.99 | loss  5.85
INFO:root:| epoch   2 |   400/ 2250 batches | lr 0.02 | ms/batch 21.49 | loss  5.71
INFO:root:| epoch   2 |   600/ 2250 batches | lr 0.02 | ms/batch 20.12 | loss  5.64
INFO:root:| epoch   2 |   800/ 2250 batches | lr 0.02 | ms/batch 21.03 | loss  5.60
INFO:root:| epoch   2 |  1000/ 2250 batches | lr 0.02 | ms/batch 22.23 | loss  5.57
INFO:root:| epoch   2 |  1200/ 2250 batches | lr 0.02 | ms/batch 21.22 | loss  5.55
INFO:root:| epoch   2 |  1400/ 2250 batches | lr 0.02 | ms/batch 21.17 | loss  5.53
INFO:root:| epoch   2 |  1600/ 2250 batches | lr 0.02 | ms/batch 23.21 | loss  5.51
INFO:root:| epoch   2 |  1800/ 2250 batches | lr 0.02 | ms/batch 17.49 | loss  5.50
INFO:root:| epoch   2 |  2000/ 2250 batches | lr 0.02 | ms/batch 20.63 | loss  5.47
INFO:root:| epoch   2 |  2200/ 2250 batches | lr 0.02 | ms/batch 23.38 | loss  5.46
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   2 | time: 49.27s | valid loss  5.69 | valid ppl   295.93
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   3 |   200/ 2250 batches | lr 0.02 | ms/batch 22.70 | loss  5.48
INFO:root:| epoch   3 |   400/ 2250 batches | lr 0.02 | ms/batch 21.93 | loss  5.43
INFO:root:| epoch   3 |   600/ 2250 batches | lr 0.02 | ms/batch 20.04 | loss  5.41
INFO:root:| epoch   3 |   800/ 2250 batches | lr 0.02 | ms/batch 23.33 | loss  5.41
INFO:root:| epoch   3 |  1000/ 2250 batches | lr 0.02 | ms/batch 19.42 | loss  5.39
INFO:root:| epoch   3 |  1200/ 2250 batches | lr 0.02 | ms/batch 23.96 | loss  5.39
INFO:root:| epoch   3 |  1400/ 2250 batches | lr 0.02 | ms/batch 21.60 | loss  5.38
INFO:root:| epoch   3 |  1600/ 2250 batches | lr 0.02 | ms/batch 21.74 | loss  5.37
INFO:root:| epoch   3 |  1800/ 2250 batches | lr 0.02 | ms/batch 19.59 | loss  5.36
INFO:root:| epoch   3 |  2000/ 2250 batches | lr 0.02 | ms/batch 20.76 | loss  5.34
INFO:root:| epoch   3 |  2200/ 2250 batches | lr 0.02 | ms/batch 22.58 | loss  5.34
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   3 | time: 49.27s | valid loss  5.59 | valid ppl   268.60
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   4 |   200/ 2250 batches | lr 0.02 | ms/batch 21.36 | loss  5.36
INFO:root:| epoch   4 |   400/ 2250 batches | lr 0.02 | ms/batch 20.85 | loss  5.31
INFO:root:| epoch   4 |   600/ 2250 batches | lr 0.02 | ms/batch 18.33 | loss  5.30
INFO:root:| epoch   4 |   800/ 2250 batches | lr 0.02 | ms/batch 22.01 | loss  5.30
INFO:root:| epoch   4 |  1000/ 2250 batches | lr 0.02 | ms/batch 21.69 | loss  5.29
INFO:root:| epoch   4 |  1200/ 2250 batches | lr 0.02 | ms/batch 19.55 | loss  5.30
INFO:root:| epoch   4 |  1400/ 2250 batches | lr 0.02 | ms/batch 21.35 | loss  5.28
INFO:root:| epoch   4 |  1600/ 2250 batches | lr 0.02 | ms/batch 21.51 | loss  5.28
INFO:root:| epoch   4 |  1800/ 2250 batches | lr 0.02 | ms/batch 27.08 | loss  5.27
INFO:root:| epoch   4 |  2000/ 2250 batches | lr 0.02 | ms/batch 18.48 | loss  5.25
INFO:root:| epoch   4 |  2200/ 2250 batches | lr 0.02 | ms/batch 25.12 | loss  5.25
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   4 | time: 49.38s | valid loss  5.53 | valid ppl   251.31
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   5 |   200/ 2250 batches | lr 0.02 | ms/batch 19.61 | loss  5.27
INFO:root:| epoch   5 |   400/ 2250 batches | lr 0.02 | ms/batch 22.93 | loss  5.22
INFO:root:| epoch   5 |   600/ 2250 batches | lr 0.02 | ms/batch 31.01 | loss  5.21
INFO:root:| epoch   5 |   800/ 2250 batches | lr 0.02 | ms/batch 15.06 | loss  5.21
INFO:root:| epoch   5 |  1000/ 2250 batches | lr 0.02 | ms/batch 15.53 | loss  5.20
INFO:root:| epoch   5 |  1200/ 2250 batches | lr 0.02 | ms/batch 13.08 | loss  5.20
INFO:root:| epoch   5 |  1400/ 2250 batches | lr 0.02 | ms/batch 16.11 | loss  5.19
INFO:root:| epoch   5 |  1600/ 2250 batches | lr 0.02 | ms/batch 20.83 | loss  5.19
INFO:root:| epoch   5 |  1800/ 2250 batches | lr 0.02 | ms/batch 20.00 | loss  5.17
INFO:root:| epoch   5 |  2000/ 2250 batches | lr 0.02 | ms/batch 23.10 | loss  5.15
INFO:root:| epoch   5 |  2200/ 2250 batches | lr 0.02 | ms/batch 23.81 | loss  5.14
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   5 | time: 46.12s | valid loss  5.46 | valid ppl   234.19
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   6 |   200/ 2250 batches | lr 0.02 | ms/batch 22.92 | loss  5.17
INFO:root:| epoch   6 |   400/ 2250 batches | lr 0.02 | ms/batch 22.19 | loss  5.12
INFO:root:| epoch   6 |   600/ 2250 batches | lr 0.02 | ms/batch 23.49 | loss  5.10
INFO:root:| epoch   6 |   800/ 2250 batches | lr 0.02 | ms/batch 23.26 | loss  5.11
INFO:root:| epoch   6 |  1000/ 2250 batches | lr 0.02 | ms/batch 23.64 | loss  5.09
INFO:root:| epoch   6 |  1200/ 2250 batches | lr 0.02 | ms/batch 22.47 | loss  5.10
INFO:root:| epoch   6 |  1400/ 2250 batches | lr 0.02 | ms/batch 20.89 | loss  5.08
INFO:root:| epoch   6 |  1600/ 2250 batches | lr 0.02 | ms/batch 19.97 | loss  5.08
INFO:root:| epoch   6 |  1800/ 2250 batches | lr 0.02 | ms/batch 19.15 | loss  5.07
INFO:root:| epoch   6 |  2000/ 2250 batches | lr 0.02 | ms/batch 22.24 | loss  5.04
INFO:root:| epoch   6 |  2200/ 2250 batches | lr 0.02 | ms/batch 21.62 | loss  5.04
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   6 | time: 49.82s | valid loss  5.38 | valid ppl   217.20
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   7 |   200/ 2250 batches | lr 0.02 | ms/batch 24.67 | loss  5.06
INFO:root:| epoch   7 |   400/ 2250 batches | lr 0.02 | ms/batch 22.30 | loss  5.01
INFO:root:| epoch   7 |   600/ 2250 batches | lr 0.02 | ms/batch 22.18 | loss  4.99
INFO:root:| epoch   7 |   800/ 2250 batches | lr 0.02 | ms/batch 25.63 | loss  5.00
INFO:root:| epoch   7 |  1000/ 2250 batches | lr 0.02 | ms/batch 20.41 | loss  4.98
INFO:root:| epoch   7 |  1200/ 2250 batches | lr 0.02 | ms/batch 21.13 | loss  5.00
INFO:root:| epoch   7 |  1400/ 2250 batches | lr 0.02 | ms/batch 21.65 | loss  4.98
INFO:root:| epoch   7 |  1600/ 2250 batches | lr 0.02 | ms/batch 25.11 | loss  4.98
INFO:root:| epoch   7 |  1800/ 2250 batches | lr 0.02 | ms/batch 20.50 | loss  4.97
INFO:root:| epoch   7 |  2000/ 2250 batches | lr 0.02 | ms/batch 26.56 | loss  4.93
INFO:root:| epoch   7 |  2200/ 2250 batches | lr 0.02 | ms/batch 27.20 | loss  4.93
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   7 | time: 54.24s | valid loss  5.31 | valid ppl   202.20
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   8 |   200/ 2250 batches | lr 0.02 | ms/batch 21.47 | loss  4.96
INFO:root:| epoch   8 |   400/ 2250 batches | lr 0.02 | ms/batch 18.37 | loss  4.90
INFO:root:| epoch   8 |   600/ 2250 batches | lr 0.02 | ms/batch 22.65 | loss  4.89
INFO:root:| epoch   8 |   800/ 2250 batches | lr 0.02 | ms/batch 21.90 | loss  4.90
INFO:root:| epoch   8 |  1000/ 2250 batches | lr 0.02 | ms/batch 22.57 | loss  4.89
INFO:root:| epoch   8 |  1200/ 2250 batches | lr 0.02 | ms/batch 19.73 | loss  4.91
INFO:root:| epoch   8 |  1400/ 2250 batches | lr 0.02 | ms/batch 19.22 | loss  4.89
INFO:root:| epoch   8 |  1600/ 2250 batches | lr 0.02 | ms/batch 23.02 | loss  4.89
INFO:root:| epoch   8 |  1800/ 2250 batches | lr 0.02 | ms/batch 24.33 | loss  4.88
INFO:root:| epoch   8 |  2000/ 2250 batches | lr 0.02 | ms/batch 23.05 | loss  4.85
INFO:root:| epoch   8 |  2200/ 2250 batches | lr 0.02 | ms/batch 22.10 | loss  4.85
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   8 | time: 49.16s | valid loss  5.25 | valid ppl   190.61
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   9 |   200/ 2250 batches | lr 0.02 | ms/batch 22.78 | loss  4.88
INFO:root:| epoch   9 |   400/ 2250 batches | lr 0.02 | ms/batch 22.20 | loss  4.82
INFO:root:| epoch   9 |   600/ 2250 batches | lr 0.02 | ms/batch 35.82 | loss  4.82
INFO:root:| epoch   9 |   800/ 2250 batches | lr 0.02 | ms/batch 26.77 | loss  4.83
INFO:root:| epoch   9 |  1000/ 2250 batches | lr 0.02 | ms/batch 23.27 | loss  4.82
INFO:root:| epoch   9 |  1200/ 2250 batches | lr 0.02 | ms/batch 21.29 | loss  4.84
INFO:root:| epoch   9 |  1400/ 2250 batches | lr 0.02 | ms/batch 21.78 | loss  4.82
INFO:root:| epoch   9 |  1600/ 2250 batches | lr 0.02 | ms/batch 17.88 | loss  4.83
INFO:root:| epoch   9 |  1800/ 2250 batches | lr 0.02 | ms/batch 19.97 | loss  4.82
INFO:root:| epoch   9 |  2000/ 2250 batches | lr 0.02 | ms/batch 24.86 | loss  4.79
INFO:root:| epoch   9 |  2200/ 2250 batches | lr 0.02 | ms/batch 23.87 | loss  4.79
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   9 | time: 53.54s | valid loss  5.21 | valid ppl   182.23
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch  10 |   200/ 2250 batches | lr 0.02 | ms/batch 22.19 | loss  4.82
INFO:root:| epoch  10 |   400/ 2250 batches | lr 0.02 | ms/batch 20.53 | loss  4.77
INFO:root:| epoch  10 |   600/ 2250 batches | lr 0.02 | ms/batch 23.94 | loss  4.76
INFO:root:| epoch  10 |   800/ 2250 batches | lr 0.02 | ms/batch 20.80 | loss  4.78
INFO:root:| epoch  10 |  1000/ 2250 batches | lr 0.02 | ms/batch 20.74 | loss  4.77
INFO:root:| epoch  10 |  1200/ 2250 batches | lr 0.02 | ms/batch 17.89 | loss  4.79
INFO:root:| epoch  10 |  1400/ 2250 batches | lr 0.02 | ms/batch 14.51 | loss  4.77
INFO:root:| epoch  10 |  1600/ 2250 batches | lr 0.02 | ms/batch 15.50 | loss  4.78
INFO:root:| epoch  10 |  1800/ 2250 batches | lr 0.02 | ms/batch 21.78 | loss  4.77
INFO:root:| epoch  10 |  2000/ 2250 batches | lr 0.02 | ms/batch 20.35 | loss  4.74
INFO:root:| epoch  10 |  2200/ 2250 batches | lr 0.02 | ms/batch 21.42 | loss  4.74
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch  10 | time: 45.33s | valid loss  5.17 | valid ppl   176.14
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:=========================================================================================
INFO:root:| End of training | test loss  5.34 | test ppl   209.26
INFO:root:=========================================================================================
INFO:root:Namespace(cuda=False, train=False, test=True)
INFO:root:Namespace(cuda=False, train=False, test=True)
INFO:root:Namespace(cuda=False, train=False, test=True)
INFO:root:Namespace(cuda=False, train=False, test=True)
INFO:root:Namespace(cuda=False, train=False, test=True)
INFO:root:Namespace(cuda=False, train=False, test=True)
INFO:root:Namespace(cuda=False, train=True, test=False)
INFO:root:----------- new value of n = 1, k = 1 -----------
INFO:root:Loading data
INFO:root:Vocab size 2006
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:| epoch   1 |   200/ 1710 batches | lr 20.00 | ms/batch  7.16 | loss  4.51
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:Exiting from training early
INFO:root:Namespace(cuda=False, train=True, test=False)
INFO:root:----------- new value of n = 1, k = 1 -----------
INFO:root:Loading data
INFO:root:Vocab size 40006
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:| epoch   1 |   200/34200 batches | lr 20.00 | ms/batch 41.91 | loss  6.09
INFO:root:| epoch   1 |   400/34200 batches | lr 20.00 | ms/batch 42.38 | loss  4.41
INFO:root:| epoch   1 |   600/34200 batches | lr 20.00 | ms/batch 41.05 | loss  4.34
INFO:root:| epoch   1 |   800/34200 batches | lr 20.00 | ms/batch 79.47 | loss  4.26
INFO:root:| epoch   1 |  1000/34200 batches | lr 20.00 | ms/batch 71.09 | loss  4.31
INFO:root:| epoch   1 |  1200/34200 batches | lr 20.00 | ms/batch 60.37 | loss  4.30
INFO:root:| epoch   1 |  1400/34200 batches | lr 20.00 | ms/batch 61.21 | loss  4.21
INFO:root:| epoch   1 |  1600/34200 batches | lr 20.00 | ms/batch 58.41 | loss  4.25
INFO:root:| epoch   1 |  1800/34200 batches | lr 20.00 | ms/batch 58.15 | loss  4.28
INFO:root:| epoch   1 |  2000/34200 batches | lr 20.00 | ms/batch 57.92 | loss  4.26
INFO:root:| epoch   1 |  2200/34200 batches | lr 20.00 | ms/batch 54.99 | loss  4.28
INFO:root:| epoch   1 |  2400/34200 batches | lr 20.00 | ms/batch 58.03 | loss  4.35
INFO:root:| epoch   1 |  2600/34200 batches | lr 20.00 | ms/batch 59.07 | loss  4.23
INFO:root:| epoch   1 |  2800/34200 batches | lr 20.00 | ms/batch 66.68 | loss  4.34
INFO:root:| epoch   1 |  3000/34200 batches | lr 20.00 | ms/batch 58.83 | loss  4.27
INFO:root:| epoch   1 |  3200/34200 batches | lr 20.00 | ms/batch 63.81 | loss  4.29
INFO:root:| epoch   1 |  3400/34200 batches | lr 20.00 | ms/batch 61.84 | loss  4.29
INFO:root:| epoch   1 |  3600/34200 batches | lr 20.00 | ms/batch 59.34 | loss  4.29
INFO:root:| epoch   1 |  3800/34200 batches | lr 20.00 | ms/batch 60.81 | loss  4.35
INFO:root:| epoch   1 |  4000/34200 batches | lr 20.00 | ms/batch 65.25 | loss  4.31
INFO:root:| epoch   1 |  4200/34200 batches | lr 20.00 | ms/batch 64.23 | loss  4.24
INFO:root:| epoch   1 |  4400/34200 batches | lr 20.00 | ms/batch 67.65 | loss  4.32
INFO:root:| epoch   1 |  4600/34200 batches | lr 20.00 | ms/batch 75.74 | loss  4.36
INFO:root:| epoch   1 |  4800/34200 batches | lr 20.00 | ms/batch 83.56 | loss  4.31
INFO:root:| epoch   1 |  5000/34200 batches | lr 20.00 | ms/batch 81.60 | loss  4.27
INFO:root:| epoch   1 |  5200/34200 batches | lr 20.00 | ms/batch 133.50 | loss  4.33
INFO:root:| epoch   1 |  5400/34200 batches | lr 20.00 | ms/batch 76.90 | loss  4.27
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:Exiting from training early
INFO:root:Namespace(cuda=False, train=True, test=False)
INFO:root:----------- new value of n = 1, k = 1 -----------
INFO:root:Loading data
INFO:root:Vocab size 40006
INFO:root:Batchying..
INFO:root:Building the model
INFO:root:| epoch   1 |  5000/34200 batches | lr 20.00 | ms/batch 79.96 | loss  4.37
INFO:root:| epoch   1 | 10000/34200 batches | lr 20.00 | ms/batch 97.63 | loss  4.30
INFO:root:| epoch   1 | 15000/34200 batches | lr 20.00 | ms/batch 81.66 | loss  4.31
INFO:root:| epoch   1 | 20000/34200 batches | lr 20.00 | ms/batch 78.56 | loss  4.33
INFO:root:| epoch   1 | 25000/34200 batches | lr 20.00 | ms/batch 72.13 | loss  4.32
INFO:root:| epoch   1 | 30000/34200 batches | lr 20.00 | ms/batch 71.11 | loss  4.30
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| end of epoch   1 | time: 2712.22s | valid loss  4.56 | valid ppl    95.75
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:| epoch   2 |  5000/34200 batches | lr 20.00 | ms/batch 68.98 | loss  4.18
INFO:root:| epoch   2 | 10000/34200 batches | lr 20.00 | ms/batch 73.01 | loss  4.09
INFO:root:| epoch   2 | 15000/34200 batches | lr 20.00 | ms/batch 60.27 | loss  4.09
INFO:root:-----------------------------------------------------------------------------------------
INFO:root:Exiting from training early
